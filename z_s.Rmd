---
title: "zonal_stat"
author: "Lallu Nikerthil Prathapan"
date: "2/27/2024"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Packages install
```{r}
install.packages("D:/EAGLE/Master_Thesis_Hannes/1/R/packages/exactextractr_0.10.0.tar.gz", repos = NULL, type = "source")
```


```{r}
# List of packages to install
packages_to_install <- c("cowplot")

# Install the packages
install.packages(packages_to_install)
```
#Packages library

```{r}
library(sf)
library(vctrs)
library(ggplot2)
library(raster)
library(exactextractr)
library(terra)
library(dplyr)
library(gridExtra)
library(tidyr)
library(units)
library(viridis)
library(hrbrthemes)
library(corrplot)
library(cowplot)
```


#Zonal statistics for each of the global EO population datasets
#loading data with until calculated shape area

# loading the data for with calculated shape area 

```{r}
build_stat_path2<-("D:/EAGLE/Master_Thesis_Hannes/1/R/Lallu_thesis/all_pop_output/build_stat_inc_ms/build_stat_inc_ms_c.shp")
camps<-st_read(build_stat_path2)
head(camps)

```


#Loading the data of camps

```{r}
url <- "data_camps/idp_camps_224.shp"
sf_data <- st_read(url) 
```
# 1. GHSL DATA
```{r}
ghsl_raster_path<-"D:/EAGLE/Master_Thesis_Hannes/1/ghsl_pop_2020_mollweid_100m/merged_ghsl.tif"
# Read the raster file into R
ghsl_raster <- raster(ghsl_raster_path)

```

```{r}
# Display information about the raster
print(ghsl_raster)
```
```{r}
# Plot the raster
plot(ghsl_raster)
```

#!!!!!!The extract function!!!!!!!!!!!!!!!

```{r}
# function

# weighted sum per polygon (using the size of the pixel covered by the polygon "coverage_fraction")

extract_sum  <-  function(raster, polygon, field){

  polygon $id_tmp <- as.data.frame(polygon)[,field]

  v.exact <- exactextractr::exact_extract(raster, polygon, include_cols = 'id_tmp', max_cells_in_memory=3e+10)

  x <- do.call("rbind",v.exact)

  x[,"gpw"] <- x[, "value"] * x$coverage_fraction

  x_sum <- x %>%

    dplyr::group_by(id_tmp)%>%

    dplyr::summarise_at("gpw", sum, na.rm = TRUE)

polygon <- polygon %>%

    left_join(x_sum, by = "id_tmp")

  rm(x,v.exact,x_sum)

  return(polygon)

}
```


```{r}
# Data
sf_data <- st_read(url) 
polygon_camps <-sf_data

```


```{r}
raster_population <- rast('D:/EAGLE/Master_Thesis_Hannes/1/ghsl_pop_2020_mollweid_100m/merged_ghsl.tif')
```

```{r}
# Call function

polygon_camps <- extract_sum(raster_population, polygon_camps,"Name")

```


#Difference in the population
```{r}


# Subtract N_INDVID from ras_name
camps$ghsl_difference <- polygon_camps$N_INDVID - camps$ghsl

# View the resulting data frame with the new "difference" column
print(camps)

```
#Writing the output of the ghsl extract

```{r}

library(sf)

# Convert the data frame to an sf object
sf_polygon_camps <- st_as_sf(camps)

# Remove Z (3D) coordinates
sf_polygon_camps <- st_zm(sf_polygon_camps, drop = TRUE)

# Export the sf object to a shapefile
st_write(sf_polygon_camps,
 "ghsl_output/polygon_camps_ghsl.shp")

```
#%%%%%%GHSL END%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#

GHSL some plot visualisation


#**plot GHSLEstimated and Iom survey population
```{r}
# Scatter plot with site_status
ghsl_surv<-ggplot(camps, aes(y = ghsl, x = N_INDVI, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(y =as.numeric(N_INDVI) , x = as.numeric(ghsl)),size = 0.6, alpha = 0.8,show.legend = TRUE)+
  
  labs(title = "Comparison between estimated and survey iom populations",
       y = "Estimated GHSL population",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(ghsl_surv)
```

```{r}
# Scatter plot with site_status
ghsl_surv<-ggplot(camps, aes(y = ghsl, x = N_INDVI, color = Sit_Stt, label = Name)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(y =as.numeric(N_INDVI) , x = as.numeric(ghsl)),size = 0.6, alpha = 0.8,show.legend = TRUE)+
  geom_text(aes(y = as.numeric(N_INDVI), x = as.numeric(ghsl)), size = 1, vjust = -0.5, hjust = -0.5)+
  labs(title = "Comparison between estimated and survey iom populations",
       y = "Estimated GHSL population",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(ghsl_surv)
```





Analysis:
For the Iom surveyed population less than 5000, it can be seen that there is a very high overestimation og the GHSL population for Formal camps.


??Most of the formal camps are subjected to overestimation in the GHSL data.What can be the reason for this??


#saving the calc vs survey plot ghsl

```{r}
# Save the plot to a file
ggsave("plots/ghsl_surv_scat.png", plot =ghsl_surv, width = 8, height = 6, dpi = 400)
```



# splitting the population estimates for <10000 and > 10000
```{r}
library(ggplot2)

# Scatter plot with site_status for N_INDVI greater than 10,000
ghsl_surv_greater <- ggplot(subset(camps, as.numeric(N_INDVI) > 10000), aes(y = ghsl, x = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_INDVI), x = as.numeric(ghsl)), size = 0.6, alpha = 0.4, show.legend = TRUE) +
  labs(title = "Comparison between estimated and survey iom populations",
       y = "Estimated population",
       x = "Iom surveyed population (N_INDVI > 10,000)") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(0, 40000, by = 5000))  # Adjust y-axis intervals

# Scatter plot with site_status for N_INDVI less than or equal to 10,000
ghsl_surv_lesser <- ggplot(subset(camps, as.numeric(N_INDVI) <= 10000), aes(y = ghsl, x = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_INDVI), x = as.numeric(ghsl)), size = 0.6, alpha = 0.4, show.legend = TRUE) +
  labs(title = "Comparison between estimated and survey iom populations",
       y = "Estimated population",
       x = "Iom surveyed population (N_INDVI <= 10,000)") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(0, 10000, by = 1000))  # Adjust y-axis intervals

# Print the plots
print(ghsl_surv_greater)
print(ghsl_surv_lesser)
```
Analysis : most of the formal camps have population greated than 10,000 and for informal camps the popualtion is mostly under 5000.


Considering the camps having the survey population less than or equal to 10,000. it can be seen that varies sites having the population estimate higher than tht of the survey population. 

#save plot

```{r}
# Save the plot to a file
ggsave("Plots/ghsl_g10000.png", plot =ghsl_surv_greater, width = 8, height = 6, dpi = 400)

ggsave("Plots/ghsl_l10000.png", plot =ghsl_surv_lesser, width = 8, height = 6, dpi = 400)
```

# to see the sitesname for less than and greateer than 10000

```{r}
 #Scatter plot with site_status for N_INDVI greater than 10,000
ghsl_surv_greater <- ggplot(subset(camps, as.numeric(N_INDVI) > 10000), aes(y = ghsl, x = N_INDVI, color = Sit_Stt,label = Name)) +
  geom_jitter(aes(y = as.numeric(N_INDVI), x = as.numeric(ghsl)), size = 0.6, alpha = 0.4, show.legend = TRUE) +
  labs(title = "Comparison between estimated and survey iom populations",
       y = "Estimated population",
       x = "Iom surveyed population (N_INDVI > 10,000)") +
  theme_minimal() +geom_text(aes(y = as.numeric(N_INDVI), x = as.numeric(ghsl)), size = 1, vjust = -0.5, hjust = -0.5)+
  scale_y_continuous(breaks = seq(0, 40000, by = 5000))  # Adjust y-axis intervals

# Scatter plot with site_status for N_INDVI less than or equal to 10,000
ghsl_surv_lesser <- ggplot(subset(camps, as.numeric(N_INDVI) <= 10000), aes(y = ghsl, x = N_INDVI, color = Sit_Stt,label=Name)) +
  geom_jitter(aes(y = as.numeric(N_INDVI), x = as.numeric(ghsl)), size = 0.6, alpha = 0.4, show.legend = TRUE) +
  labs(title = "Comparison between estimated and survey iom populations",
       y = "Estimated population",
       x = "Iom surveyed population (N_INDVI <= 10,000)") +
  theme_minimal() +geom_text(aes(y = as.numeric(N_INDVI), x = as.numeric(ghsl)), size = 1, vjust = -0.5, hjust = -0.5)+
  scale_y_continuous(breaks = seq(0, 10000, by = 1000))  # Adjust y-axis intervals

# Print the plots
print(ghsl_surv_greater)
print(ghsl_surv_lesser)
```


#splitting the population less than 500

```{r}
ghsl_surv_ls500 <- ggplot(subset(camps, as.numeric(N_INDVI) < 500), aes(y = ghsl, x = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_INDVI), x = as.numeric(ghsl)), size = 0.6, alpha = 0.4, show.legend = TRUE) +
  labs(title = "Comparison between estimated and survey IOM populations",
       y = "Estimated population",
       x = "IOM surveyed population (N_INDVI < 500)") +
  theme_minimal() 
  # scale_y_continuous(breaks = seq(0, 550, by = 100))+scale_x_continuous(breaks = seq(0, 550, by = 100))  # Adjust y-axis intervals

#print plots'
print(ghsl_surv_ls500)

```
#save plot
```{r}
# Save the plot to a file
ggsave("Plots/ghsl_ls500.png", plot =ghsl_surv_ls500, width = 8, height = 6, dpi = 400)
```



Now again I made plots to see if the population of the survey sites below 500 shows any relationship.


```{r}
ghsl_surv_ls500 <- ggplot(subset(camps, as.numeric(N_INDVI) < 300), aes(y = as.numeric(ghsl), x = as.numeric(N_INDVI), color = Sit_Stt, label = Name)) +
  geom_jitter(aes(y = as.numeric(N_INDVI), x = as.numeric(ghsl)), size = 0.6, alpha = 0.4, show.legend = TRUE) +
  geom_text(aes(y = as.numeric(N_INDVI), x = as.numeric(ghsl)), size = 1, vjust = -0.5, hjust = -0.5) +  # Add geom_text for site names
  labs(title = "Comparison between estimated and survey IOM populations",
       y = "Estimated population",
       x = "IOM surveyed population (N_INDVI < 500)") +
  theme_minimal() 
  # scale_y_continuous(breaks = seq(0, 550, by = 100)) +
  # scale_x_continuous(breaks = seq(0, , by = 100))  # Adjust y-axis intervals

#print plots'
print(ghsl_surv_ls500)
```


# Plot shelter type to see how it behave
```{r}
# Define custom colors for Shelter_type
custom_colors <- c("#FF5733", "#33FF57", "#3366FF", "#FF33A8", "#FFFF33", "#33FFFF",  "#808080", "#A52A2A")
# filt_data_shltyls <- subset(camps, as.numeric(N_INDVI)<500)
# Set the alpha value for all points
alpha_value <- 0.2
# Scatter plot with different colors based on Shelter_type
ggplot(camps, aes(x = as.numeric(ghsl), y = as.numeric(N_INDVI), color = Shlt_ty)) +
  geom_point(alpha = alpha_value) +
  labs(title = "Comparison between ghsl and N_INDVI",
       x = "Estimated ghsl population",
       y = "Surveyed Population") +
  scale_color_manual(values = custom_colors) +  # Set custom colors
   # scale_y_continuous(breaks = seq(0, 2500, by = 500)) +
   # # scale_x_continuous(breaks = seq(0,2500 , by = 500))  # Adjust y-axis intervals
  theme_minimal()
```
#seeing the name of the shelter for the shelter type.
```{r}
# Define custom colors for Shelter_type
custom_colors <- c("#FF5733", "#33FF57", "#3366FF", "#FF33A8", "#FFFF33", "#33FFFF",  "#808080", "#A52A2A")
filt_data_shltyls <- subset(camps, as.numeric(N_INDVI)<2500)
# Set the alpha value for all points
alpha_value <- 0.2
# Scatter plot with different colors based on Shelter_type
ggplot(camps, aes(x = as.numeric(ghsl), y = as.numeric(N_INDVI), color = Shlt_ty,label=Name)) +
  geom_point(alpha = alpha_value) +
  labs(title = "Comparison between ghsl and N_INDVI",
       x = "Estimated ghsl population",
       y = "Surveyed Population") +
  scale_color_manual(values = custom_colors) +
  geom_text(aes(y = as.numeric(N_INDVI), x = as.numeric(ghsl)), size = 1, vjust = -0.5, hjust = -0.5)+
  # Set custom colors
    # scale_y_continuous(breaks = seq(0, 10000, by = 1000)) +
  theme_minimal()
```

#The plots with Number of Households and survey population +ghsl population


```{r}
# Scatter plot comparing N_INDIVID and N_HH
plot1 <- ggplot(camps, aes(x = as.numeric(N_INDVI), y = as.numeric(N_HH), color = Sit_Stt)) +
  geom_point() +
  labs(title = "Comparison between IOM survey population and Survey Houshold numbers",
       x = "Iom Survey population",
       y = "Households") +
  theme(plot.title = element_text(size = 3, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3, hjust = 0.5),
        axis.title.y = element_text(size = 3, hjust = 0.5),
        axis.text.x = element_text(size = 2),
        axis.text.y = element_text(size = 2)) +
  theme_minimal()

# Scatter plot comparing N_HH and ghsl
plot3 <- ggplot(camps, aes(x = as.numeric(N_HH), y = as.numeric(ghsl), color = Sit_Stt)) +
  geom_point() +
  labs(title = "Comparison between Household survey and Estimated GHSL Population",
       x = "Households",
       y = "Estimated GHSL Population") +
  coord_flip() +
  theme(plot.title = element_text(size = 3, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3, hjust = 0.5),
        axis.title.y = element_text(size = 3, hjust = 0.5),
        axis.text.x = element_text(size = 2),
        axis.text.y = element_text(size = 2)) +
  theme_minimal()

# Arrange the plots in a grid
hh_ghsl<-grid.arrange(plot1, plot3, ncol = 1)
```
#save

```{r}
# Save the plot to a file
ggsave("Plots/ghs_hh_ind.png", plot =hh_ghsl, width = 8, height = 6, dpi = 400)
```


#Number of households and GHSL population only

```{r}
# Scatter plot comparing N_HH and ghsl
hh_ghsl_c <- ggplot(camps, aes(x = as.numeric(N_HH), y = as.numeric(ghsl), color = Sit_Stt)) +
  geom_point() +
  labs(title = "Comparison between Household survey and Estimated GHSL Population",
       x = "Households",
       y = "Estimated GHSL Population") +
  coord_flip() +
  theme(plot.title = element_text(size = 3, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3, hjust = 0.5),
        axis.title.y = element_text(size = 3, hjust = 0.5),
        axis.text.x = element_text(size = 2),
        axis.text.y = element_text(size = 2)) +
  theme_minimal()
print(hh_ghsl_c)
```
```{r}
# Save the plot to a file
ggsave("Plots/ghs_hh.png", plot =hh_ghsl_c, width = 8, height = 6, dpi = 400)
```


#Find about the difference in  statistics which will help in understanding the change in population of the camps from that of the estimated population 
```{r}
ghs_dff_stats<-summary(as.numeric(camps$ghsl_df))
print(ghs_dff_stats)

```

#Analysis:

Seeing that the mean in the difference in population between the ghsl and the surveyed population is overestimation by 2954.9, which is a pritty big overestimation 

What could be the reason for this????
#Boxplot the ghsl error
```{r}
# Create a boxplot for N_INDVI
ghsl_error_box <- ggplot(camps) + 
  geom_boxplot(aes( x=Sit_Stt,y =ghsl_df, fill = "ghsl_df"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "GHSL error", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x=Sit_Stt,y =ghsl_df, fill = "ghsl_df"), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "GHSL-survery difference error summary", x = "Site Status", y = "GHSL-Survey difference") +
  geom_violin(aes(x = Sit_Stt, y = ghsl_df, fill = "ghsl_df"), alpha = 0.3) +
  # 
  theme(plot.title = element_text(size = 9,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)
  #median pointed code if needed
  #  stat_summary(
  #   aes(x = Sit_Stt, y = as.numeric(N_INDVI), fill = "N_INDVI"),
  #   fun = median,
  #   geom = "point",
  #   shape = 23,
  #   size = 2,
  #   color = "black",
  #   position = position_dodge(width = 0.5)
  # )
  
  
 # !!!!if needed to display then have to run the median code below first 
  # geom_text(
  #   data = median_values,
  #   aes(x = Sit_Stt, y = median_ghsl, label = sprintf("%.1f", median_ghsl)),
  #   vjust = -1,
  #   size = 1,
  #   color = "black",
  #   hjust = 0.5
  # ) 
#   # Calculate median values for each Sit_Stt group
# median_values <- camps %>%
#   group_by(Sit_Stt) %>%
#   summarize(median_N_INDVI = median(as.numeric(N_INDVI)))
#   

# stat_summary(
  #   aes(x = Sit_Stt, y = as.numeric(N_INDVI)),
  #   fun = median,
  #   geom = "crossbar",
  #   width = 0.4,
  #   col = "red",
  #   show.legend = FALSE
  # )

print(ghsl_error_box)
```


```{r}
library(ggplot2)

# Assuming ghsl_df is a data frame with a single column named ghsl
# Create a boxplot for ghsl_df
boxplot <- ggplot(camps, aes(x=Sit_Stt,y = ghsl_df)) +
  geom_boxplot() +geom_jitter(aes(x=Sit_Stt, y =ghsl_df), size = 0.2, alpha = 0.9,show.legend = FALSE) +coord_flip()
  labs(title = "Boxplot of GHSL Data",
       y = "GHSL Value")

# Print the boxplot
print(boxplot)
```



#2.World POP(unconstrained)

#nga_PPP_2020 is actually unconstrained dataset

```{r}
World_pop <- rast('D:/EAGLE/Master_Thesis_Hannes/1/world_pop/nga_ppp_2020.tif')
print(World_pop)
```


```{r}

# Call function

polygon_camps <- extract_sum(World_pop,polygon_camps,"Name")

```
#Difference in the survery_population and world_pop
```{r}
# Assuming you have a column named "N_INDVID" in the polygon_camps data frame
# Adjust the column name if needed

# Subtract N_INDVID from ras_name
polygon_camps$world_pop_difference <- polygon_camps$N_INDVID - polygon_camps$wp_c

# View the resulting data frame with the new "difference" column
print(polygon_camps)

```



#Writing the output of the worldpop unconstrained extract

```{r}
# Convert the data frame to an sf object
sf_polygon_camps2 <- st_as_sf(polygon_camps)

# Remove Z (3D) coordinates
sf_polygon_camps2 <- st_zm(sf_polygon_camps2, drop = TRUE)

# Export the sf object to a shapefile
st_write(sf_polygon_camps2,
 "world_pop_output/wp_c.shp")

```

#World pop unconstrained plots
```{r}
# Define the ggplot object
ggplot(polygon_camps, aes(fill = wp_c)) +
  geom_sf() +  # Plot the polygons
  scale_fill_viridis_c() +  # Choose a color scale (you can change to your preference)
  labs(title = "Zonal Statistics of GHSL Values for Camps") +
  theme_minimal()

```


#**plot worldpop unconstrained Estimated and Iom survey population
```{r}
# Scatter plot with site_status
ggplot(camps, aes(x = wp_uncon, y = N_INDVI, color = Sit_Stt)) +

  geom_jitter(aes(x = (as.numeric(N_INDVI)),y = as.numeric(wp_uncon), fill ="Sit_Stt"), size = 0.6, alpha = 0.8,show.legend = FALSE)
  labs(title = "Comparison between estimated and survey iom populations",
       x = "Estimated population",
       y = "Iom surveyed population") +
  theme_minimal()
```


#3.World POP(constrained)
#Actually this is constrained datset -nga_ppp_2020_constrained
```{r}
World_pop_unconstr <- rast('D:/EAGLE/Master_Thesis_Hannes/1/world_pop_build/nga_ppp_2020_constrained.tif')
print(World_pop_unconstr)

```

```{r}
# Call function

polygon_camps <- extract_sum(World_pop_unconstr,polygon_camps,"Name")

```

#Difference in the survery_population and world_pop unconstrained
```{r}


# Subtract N_INDVID from ras_name
polygon_camps$wp_uc_diff <- polygon_camps$N_INDVID - polygon_camps$wp_uc

# View the resulting data frame with the new "difference" column
print(polygon_camps)
```



#Writing the output of the worldpop unconstrained extract

```{r}
# Convert the data frame to an sf object
poly_camp3<- st_as_sf(polygon_camps)

# Remove Z (3D) coordinates
poly_camp3 <- st_zm(poly_camp3, drop = TRUE)

# Export the sf object to a shapefile
st_write(poly_camp3,
 "world_pop_uncons_output/polygon_wpun.shp")



```
#World pop unconstrained plots

```{r}
# Define the ggplot object
ggplot(polygon_camps, aes(fill = wp_uc)) +
  geom_sf() +  # Plot the polygons
  scale_fill_viridis_c() +  # Choose a color scale (you can change to your preference)
  labs(title = "Zonal Statistics of worldpop constrained Values for Camps") +
  theme_minimal()
```
#**plot worldpop constrained Estimated and Iom survey population
```{r}
# Scatter plot with site_status
ggplot(camps, aes(x = wp_con, y = N_INDVI, color = Sit_Stt)) +

  geom_jitter(aes(x = (as.numeric(N_INDVI)),y = as.numeric(wp_con), fill ="Sit_Stt"), size = 0.6, alpha = 0.8,show.legend = FALSE)
  labs(title = "Comparison between estimated and survey iom populations",
       x = "Estimated population",
       y = "Iom surveyed population") +
  theme_minimal()
```

#4. GPW_V4

```{r}

gpw <- rast('D:/EAGLE/Master_Thesis_Hannes/1/gpw/gpw-v4-population-count-rev11_2020_30_sec_tif/gpw_v4_population_count_rev11_2020_30_sec.tif')
print(gpw)
```


```{r}
# Call function

polygon_camps <- extract_sum(gpw,polygon_camps,"Name")
```

#Difference in the survery_population and gpw_population
```{r}
# Assuming you have a column named "N_INDVID" in the polygon_camps data frame
# Adjust the column name if needed

# Subtract N_INDVID from ras_name
polygon_camps$gpw_diff <- polygon_camps$N_INDVID - polygon_camps$gpw

# View the resulting data frame with the new "difference" column
print(polygon_camps)
```


#Writing the output of the gpw

```{r}
# Convert the data frame to an sf object
poly_camp4<- st_as_sf(polygon_camps)

# Remove Z (3D) coordinates
poly_camp4 <- st_zm(poly_camp4, drop = TRUE)

# Export the sf object to a shapefile
st_write(poly_camp4,
 "gpw/polygon_gpw1.shp")



```
#Gpw plots

```{r}
# Define the ggplot object
ggplot(polygon_camps, aes(fill = gpw)) +
  geom_sf() +  # Plot the polygons
  scale_fill_viridis_c() +  # Choose a color scale (you can change to your preference)
  labs(title = "Zonal Statistics of worldpop constrained Values for Camps") +
  theme_minimal()
```
#**plot GPW Estimated and Iom survey population
```{r}
# Scatter plot with site_status
ggplot(camps, aes(x = gpw, y = N_INDVI, color = Sit_Stt)) +

  geom_jitter(aes(x = (as.numeric(N_INDVI)),y = as.numeric(gpw), fill ="Sit_Stt"), size = 0.6, alpha = 0.8,show.legend = FALSE)
  labs(title = "Comparison between estimated and survey iom populations",
       x = "Estimated population",
       y = "Iom surveyed population") +
  theme_minimal()
```
#Writing out the whole GHSL, Worldpop(cns),worldpop(uncons),gpw
```{r}
 #Convert the data frame to an sf object
camp_poly_pop<- st_as_sf(polygon_camps)

# Remove Z (3D) coordinates
camp_poly_pop <- st_zm(camp_poly_pop, drop = TRUE)

# Export the sf object to a shapefile
st_write(camp_poly_pop,
 "all_pop_output/camp_poly_pop.shp")


```




##**%%%Combining the scatterplots for all the eo datsets in one plot%%%%%
```{r}
library(gridExtra)

# Scatter plot with site_status for gpw
scatter_gpw <- ggplot(camps, aes(x = gpw, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(gpw), fill = Sit_Stt), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(title = "Comparison between estimated and survey iom populations",
       x = "Estimated population (GPW)",
       y = NULL) +  # No y-axis label
  theme_minimal()
# Scatter plot with site_status for wp_con
scatter_wp_con <- ggplot(camps, aes(x = wp_con, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_con), fill = Sit_Stt), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(title = NULL,  # No title
       x = "Estimated population (WP_CON)",
       y = NULL) +  # No y-axis label
  theme_minimal()

# Scatter plot with site_status for wp_uncon
scatter_wp_uncon <- ggplot(camps, aes(x = wp_uncon, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_uncon), fill = Sit_Stt), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(title = NULL,  # No title
       x = "Estimated population (WP_UNCON)",
       y = NULL) +  # No y-axis label
  theme_minimal()

# Scatter plot with site_status for ghsl
scatter_ghsl <- ggplot(camps, aes(x = ghsl, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(ghsl), fill = Sit_Stt), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(title = NULL,  # No title
       x = "Estimated population (GHSL)",
       y = NULL) +  # Only this plot has y-axis label
  theme_minimal()

# Combine all scatter plots into one
combined_plot <- grid.arrange(scatter_gpw, scatter_wp_con, scatter_wp_uncon, scatter_ghsl, nrow = 2, ncol = 2)

# Print the combined plot
print(combined_plot)
```

```{r}
library(cowplot)

# General y-axis label
y_label <- "Iom surveyed population"

# Scatter plot with site_status for gpw
scatter_gpw <- ggplot(camps, aes(x = gpw, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(gpw), fill = Sit_Stt), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(title = "Comparison between estimated and survey iom populations",
       x = "Estimated population (GPW)",
       y = NULL) +  # No y-axis label
  theme_minimal()+
  theme(plot.title = element_text(size = 9,color="Blue",hjust=0.7),
        axis.title.x = element_text(size = 6,hjust = 0.5),axis.text.x = element_text(size=5),
        )

# Scatter plot with site_status for wp_con
scatter_wp_con <- ggplot(camps, aes(x = wp_con, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_con), fill = Sit_Stt), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(title = NULL,  # No title
       x = "Estimated population (WP_CON)",
       y = NULL) +  # No y-axis label
  theme_minimal()+
  theme(axis.title.x = element_text(size = 6,hjust = 0.5),axis.text.x = element_text(size=5),
        )
# Scatter plot with site_status for wp_uncon
scatter_wp_uncon <- ggplot(camps, aes(x = wp_uncon, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_uncon), fill = Sit_Stt), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(title = NULL,  # No title
       x = "Estimated population (WP_UNCON)",
       y = NULL) +  # No y-axis label
  theme_minimal()+
   theme(axis.title.x = element_text(size = 6,hjust = 0.5),axis.text.x = element_text(size=5),
        )

# Scatter plot with site_status for ghsl
scatter_ghsl <- ggplot(camps, aes(x = ghsl, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(ghsl), fill = Sit_Stt), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(title = NULL,  # No title
       x = "Estimated population (GHSL)",
       y = NULL) +  # No y-axis label
  theme_minimal()+
   theme(axis.title.x = element_text(size = 6,hjust = 0.5),axis.text.x = element_text(size=5),
        )

# Combine all scatter plots into one using cowplot
combined_plot <- plot_grid(scatter_gpw, scatter_wp_con, scatter_wp_uncon, scatter_ghsl, nrow = 2, ncol = 2, align = "h", labels = "AUTO")

# Add y-axis label outside the grid
combined_plot <- combined_plot + draw_label(y_label, x = 0, angle = 90, vjust =0.5, hjust = 0.5,size =7)

# Print the combined plot
print(combined_plot)
```


```{r}
library(cowplot)

# General y-axis label
y_label <- "Iom surveyed population"

# General fill label
fill_label <- "Site Status"

# Scatter plot with site_status for gpw
scatter_gpw <- ggplot(camps, aes(x = gpw, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(gpw), fill = Sit_Stt), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(
       x = "Estimated population (GPW)",
       y = NULL) +  # No y-axis label
  theme_minimal()+
  theme(plot.title = element_text(size = 9, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3.5, hjust = 0.5),axis.text.y = element_text(size = 3.5),
        axis.text.x = element_text(size =3.5))

# Scatter plot with site_status for wp_con
scatter_wp_con <- ggplot(camps, aes(x = wp_con, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_con), fill = Sit_Stt), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(title = NULL,  # No title
       x = "Estimated population (WP_CON)",
       y = NULL) +  # No y-axis label
  theme_minimal()+
  theme(axis.title.x = element_text(size = 3.5, hjust = 0.5),axis.text.y = element_text(size = 3.5),
        axis.text.x = element_text(size = 3.5))

# Scatter plot with site_status for wp_uncon
scatter_wp_uncon <- ggplot(camps, aes(x = wp_uncon, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_uncon), fill = Sit_Stt), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(title = NULL,  # No title
       x = "Estimated population (WP_UNCON)",
       y = NULL) +  # No y-axis label
  theme_minimal()+
  theme(axis.title.x = element_text(size = 3.5, hjust = 0.5),axis.text.y = element_text(size = 3.5),
        axis.text.x = element_text(size = 3.5))

# Scatter plot with site_status for ghsl
scatter_ghsl <- ggplot(camps, aes(x = ghsl, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(ghsl), fill = Sit_Stt), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(title = NULL,  # No title
       x = "Estimated population (GHSL)",
       y = NULL) +  # No y-axis label
  theme_minimal()+
  theme(axis.title.x = element_text(size = 3.5, hjust = 0.5),axis.text.y = element_text(size = 3.5),
        axis.text.x = element_text(size = 3.5))

# Combine all scatter plots into one using cowplot
combined_plot <- plot_grid(scatter_gpw, scatter_wp_con, scatter_wp_uncon, scatter_ghsl, nrow = 2, ncol = 2, align = "h",  rel_widths = c(0.5,0.5), rel_heights = c(0.5,0.5),labels = "AUTO",label_size = 5,label_colour = "red")

# Add y-axis label outside the grid
combined_plot <- combined_plot + draw_label(y_label, x = 0, angle = 90, vjust = 0.75, hjust = 0.5, size = 5)

# Add fill label outside the grid
# combined_plot <- combined_plot + draw_label(fill_label, x = 1, y = 1, angle = 90, size = 5, hjust =5, vjust =0.1)

# # Add title outside the grid
# combined_plot <- combined_plot + draw_label("Comparison of Estimated and Surveyed Populations", x = 0.5, y = 1, size = 5, hjust = 0.2,vjust=0.5)

# Print the combined plot
print(combined_plot)
```

#saving the all scatterplots

```{r}
# Save the plot to a file
ggsave("Plots/sctr.png", plot = combined_plot, width = 8, height = 6, dpi = 400)
```

```{r}
library(cowplot)

# General y-axis label
y_label <- "Iom surveyed population"

# Define common limits for x-axis and y-axis
common_limits <- list(
  x = c(min(camps$gpw, camps$wp_con, camps$wp_uncon, camps$ghsl), max(camps$gpw, camps$wp_con, camps$wp_uncon, camps$ghsl)),
  y = c(min(camps$N_INDVI), max(camps$N_INDVI))
)

# Scatter plot with site_status for gpw
scatter_gpw <- ggplot(camps, aes(x = gpw, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(gpw), fill = Sit_Stt), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(title = "Comparison between estimated and survey iom populations",
       x = "Estimated population (GPW)",
       y = NULL) +  # No y-axis label
  theme_minimal() +
  theme(
    plot.title = element_text(size = 9, color = "Blue", hjust = 0.7),
    axis.title.x = element_text(size = 6, hjust = 0.5),
    axis.text.x = element_text(size = 5)
  ) +
  coord_cartesian(xlim = common_limits$x, ylim = common_limits$y)

# Scatter plot with site_status for wp_con
scatter_wp_con <- ggplot(camps, aes(x = wp_con, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_con), fill = Sit_Stt), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(title = NULL,  # No title
       x = "Estimated population (WP_CON)",
       y = NULL) +  # No y-axis label
  theme_minimal() +
  theme(
    axis.title.x = element_text(size = 6, hjust = 0.5),
    axis.text.x = element_text(size = 5)
  ) +
  coord_cartesian(xlim = common_limits$x, ylim = common_limits$y)

# Scatter plot with site_status for wp_uncon
scatter_wp_uncon <- ggplot(camps, aes(x = wp_uncon, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_uncon), fill = Sit_Stt), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(title = NULL,  # No title
       x = "Estimated population (WP_UNCON)",
       y = NULL) +  # No y-axis label
  theme_minimal() +
  theme(
    axis.title.x = element_text(size = 6, hjust = 0.5),
    axis.text.x = element_text(size = 5)
  ) +
  coord_cartesian(xlim = common_limits$x, ylim = common_limits$y)

# Scatter plot with site_status for ghsl
scatter_ghsl <- ggplot(camps, aes(x = ghsl, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(ghsl), fill = Sit_Stt), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(title = NULL,  # No title
       x = "Estimated population (GHSL)",
       y = NULL) +  # No y-axis label
  theme_minimal() +
  theme(
    axis.title.x = element_text(size = 6, hjust = 0.5),
    axis.text.x = element_text(size = 5)
  ) +
  coord_cartesian(xlim = common_limits$x, ylim = common_limits$y)

# Combine all scatter plots into one using cowplot
combined_plot <- plot_grid(scatter_gpw, scatter_wp_con, scatter_wp_uncon, scatter_ghsl, nrow = 2, ncol = 2, align = "h", labels = "AUTO")

# Add y-axis label outside the grid
combined_plot <- combined_plot + draw_label(y_label, x = 0, angle = 90, vjust = 0.5, hjust = 0.5, size = 7)
# Print the combined plot
print(combined_plot)
```


#load the data with all the population output to an new variable
```{r}
output_path<-("D:/EAGLE/Master_Thesis_Hannes/1/R/Lallu_thesis/all_pop_output/camp_poly_pop.shp")

output_poly<-st_read(output_path) 
head(output_poly)
```

#!!!5 loading the data from all the building stats

#****after forgetting ms data again loaded as all_build_stat_ms.shp

```{r}
build_stat_path<-("D:/EAGLE/Master_Thesis_Hannes/1/R/Lallu_thesis/all_pop_output/build_stat_inc_ms/all_build_stat_ms.shp")
build_stats_inc<-st_read(build_stat_path)
head(build_stats_inc)
```


#calculating the shape_area of the camp from the geometries of camp_polygons

```{r}

#Calculate the shape area for each camp polygon
build_stats_inc$cl_Shp_a <-st_area(build_stats_inc$geometry)

# Print or view the results
print(build_stats_inc[,c("Name", "cl_Shp_a","Site_Ar")])

# Remove 'units' from the columns
build_stats_inc$cl_Shp_a <- as.numeric(build_stats_inc$cl_Shp_a)
build_stats_inc$Site_Ar <- as.numeric(build_stats_inc$Site_Ar)

# Calculate the difference between 'Calculated_Shape_Area' and 'Site_Ar'
build_stats_inc$Ar_diff <- build_stats_inc$Site_Ar-build_stats_inc$cl_Shp_a

print(build_stats_inc[, c("Name", "cl_Shp_a","Site_Ar","Ar_diff")])
```





# write out the output with the polygon shapearea for surety

```{r}


# Export the sf object to a shapefile
st_write(build_stats_inc,
 "all_pop_output/build_stat_inc_ms/build_stat_inc_ms_c.shp")
```

#plot site area of the camps from survey and site area calculated from the digitized

```{r}
# Create a scatter plot
ggplot(build_stats_inc, aes(x = Site_Ar, y = cl_Shp_a)) +
  geom_point(aes(color = "cl_Shp_a"), size = 3) +
  geom_point(aes(color = "Site Area"), size = 1) +
  scale_color_manual(values = c("cl_Shp_a" = "blue", "Site Area" = "red")) +
  labs(title = "Survey_Site Area vs. Calculated Shape Area",
       x = "Survey_Site Area",
       y = "Calculated Shape Area")
```

#plot to check the problem of high population and less area

```{r}
# Create a scatter plot
ggplot(build_stats_inc, aes(x = N_INDVI, y = cl_Shp_a)) +
  geom_point() +
  labs(title = "N_INDVID vs. Calculated Shape Area",
       x = "N_INDVID",
       y = "Calculated Shape Area")
```

```{r}
# Filter camps with high N_INDVID and small cal_Shape_area
check_hipop_lessarea <- camps %>%
  filter(as.numeric(N_INDVI)<10000)
#,Site_Ar<1000
# Print or view the selected camps
print(check_hipop_lessarea[, c("Name", "N_INDVI", "cl_Shp_a","Site_Ar","Site_nm")])
```


# the camp values(BO_S294 has the high population of 224 with less area of 342 sq m)
#  Name N_INDVI cal_Shp_area
<!-- 1  AD_S018    75.0   25822.0515 -->
<!-- 2  BO_S294   224.0     342.7668 -->
<!-- 3  AD_S003  1234.0  104062.6921 -->
<!-- 4  BO_S012  3375.0   17558.3622 -->
<!-- 5  BO_S015  1259.0   39288.4634 -->
<!-- 6  BO_S113  5708.0  256595.9877 -->
<!-- 7  BO_S114   739.0   10824.5435 -->
<!-- 8  BO_S160  2500.0  143393.6697 -->
<!-- 9  BO_S162  1260.0   40156.3581 -->
<!-- 10 BO_S203  9223.0  575925.1669 -->

#another filtering of population >50 and area <1000square gave 3 filters
1 BO_S294     224  342.7668  334.61 POLYGON ((13.19264 11.85126...
2 BO_S265     207 1015.6604  999.93 POLYGON ((13.13323 11.78958...
3 BO_S105     110  985.3237  934.06 POLYGON ((13.13257 11.79066...


# loading the data for with calculated shape area 

```{r}
build_stat_path2<-("D:/EAGLE/Master_Thesis_Hannes/1/R/Lallu_thesis/all_pop_output/build_stat_inc_ms/build_stat_inc_ms_c.shp")
camps<-st_read(build_stat_path2)
head(camps)
```

#!!Attributes removing code
#!! Run only if needed
```{r}
# attributes_to_remove <- c("cl_Shp_r","Area_Dff");
# 
# # Remove specified attributes
# data1<- data1%>%select(-one_of(attributes_to_remove))

```


#Population density 

```{r}
# Calculate population density

camps$Site_Ar <- as.numeric(camps$Site_Ar)
camps$N_INDVI <- as.numeric(camps$N_INDVI)
camps$st_pp_d <- (camps$N_INDVI) / (camps$Site_Ar)

# Print the result
# Print or view the selected camps
print(camps[, c("Name", "N_INDVI", "Site_Ar","st_pp_d")])

```

#******plots for the eo datasets****************


#BOX+VIOLIN plot for the IOM survey population for different Site Type informal camps



```{r}
# Load the required library
library(ggplot2)
```


```{r}
# Create a boxplot for N_INDVI
plot_camp_pop <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = N_INDVI, fill = "N_INDVI"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Site Population", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = N_INDVI, fill = "N_INDVI",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site population from IOM survey for different Site Status", x = "Site Status", y = "Site Population") +
  geom_violin(aes(x = Sit_Stt, y = N_INDVI, fill = "N_INDVI"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 9,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)
  #median pointed code if needed
  #  stat_summary(
  #   aes(x = Sit_Stt, y = as.numeric(N_INDVI), fill = "N_INDVI"),
  #   fun = median,
  #   geom = "point",
  #   shape = 23,
  #   size = 2,
  #   color = "black",
  #   position = position_dodge(width = 0.5)
  # )
  
  
 # !!!!if needed to display then have to run the median code below first 
  # geom_text(
  #   data = median_values,
  #   aes(x = Sit_Stt, y = median_ghsl, label = sprintf("%.1f", median_ghsl)),
  #   vjust = -1,
  #   size = 1,
  #   color = "black",
  #   hjust = 0.5
  # ) 
#   # Calculate median values for each Sit_Stt group
# median_values <- camps %>%
#   group_by(Sit_Stt) %>%
#   summarize(median_N_INDVI = median(as.numeric(N_INDVI)))
#   

# stat_summary(
  #   aes(x = Sit_Stt, y = as.numeric(N_INDVI)),
  #   fun = median,
  #   geom = "crossbar",
  #   width = 0.4,
  #   col = "red",
  #   show.legend = FALSE
  # )

print(plot_camp_pop)
```
#Analysis :
1.It is totally evident that the population in the informal survey sites are lesser than that of the formal survey sites
2.One of the outliers for the formal camps ranges greater than 4000 for the site population



#saving the N_INDVI plot 
```{r}
# Save the plot to a file
ggsave("plots/N_INDVI.png", plot = plot_camp_pop, width = 8, height = 6, dpi = 400)
```

#BOX+VIOLIN plot for the calculated ghsl population for classified as formal and informal camps


```{r}
# Create a boxplot for ghsl
ghsl_plot <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = as.numeric(ghsl), fill = "ghsl"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Calculated GHSL Population", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = as.numeric(ghsl), fill ="ghsl",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site population calculated from GHS POP  for different Site Status", x = "Site Status", y = "Calculated GHSL Population") +
  geom_violin(aes(x = Sit_Stt, y = as.numeric(ghsl), fill = "ghsl"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 9,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)

print(ghsl_plot)
  
```
#saving the ghsl plot 
```{r}
# Save the plot to a file
ggsave("plots/ghsl_box.png", plot = ghsl_plot, width = 8, height = 6, dpi = 400)
```


#BOX+VIOLIN plot for the calculated Worldpop(Unconstrained) population for classified as formal and informal camps


```{r}
# Create a boxplot for wp_unconstrained
wp_u_plot <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = as.numeric(wp_uc), fill = "wp_uc"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Calculated worldpop Population(unconstrained)", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = as.numeric(wp_uc), fill ="wp_uc",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site population calculated from Worlpop(Unconstrained) for different Site Status", x = "Site Status", y = "Calculated worldpop Population(unconstrained)") +
  geom_violin(aes(x = Sit_Stt, y = as.numeric(wp_uc), fill = "wp_uc"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 9,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)

print(wp_u_plot)
```

#saving the wp_uc plot 
```{r}
# Save the plot to a file
ggsave("plots/box_wp_uc.png", plot = wp_u_plot, width = 8, height = 6, dpi = 400)
```

#BOX+VIOLIN plot for the calculated Worldpop(constrained) population for classified as formal and informal camps

```{r}
# Create a boxplot for wp_constrained
wp_c_plot <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = as.numeric(wp_c), fill = "wp_c"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Calculated worldpop Population(Constrained)", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = as.numeric(wp_c), fill ="wp_c",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site population calculated from Worlpop(Constrained) for different Site Status", x = "Site Status", y = "Calculated worldpop Population(Constrained)") +
  geom_violin(aes(x = Sit_Stt, y = as.numeric(wp_c), fill = "wp_c"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 9,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)

print(wp_c_plot)
```
#saving the wp_c plot 
```{r}
# Save the plot to a file
ggsave("plots/box_wp_c.png", plot = wp_c_plot, width = 8, height = 6, dpi = 400)
```

#BOX+VIOLIN plot for the calculated GPW population for different site status

```{r}
# Create a boxplot forgpw
gpw_plot <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = as.numeric(gpw), fill = "gpw"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Calculated GPW population", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = as.numeric(gpw), fill ="gpw",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site population calculated from GPW data for different Site Status", x = "Site Status", y = "Calculated GPW population") +
  geom_violin(aes(x = Sit_Stt, y = as.numeric(gpw), fill = "gpw"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 9,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)

print(gpw_plot)
```


#saving the gpw plot 
```{r}
# Save the plot to a file
ggsave("plots/box_gpw.png", plot =gpw_plot, width = 8, height = 6, dpi = 400)
```


#**BUILDING DATA PLOTS*************

#BOX+VIOLIN plot for number of households in Survey data  for different site status

```{r}
N_HHplot <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = as.numeric(N_HH), fill = "N_HH"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Survey Household number", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = as.numeric(N_HH), fill ="N_HH",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site IOM surveyed household numbers", x = "Site Status", y = "Surveyed household number") +
  geom_violin(aes(x = Sit_Stt, y = as.numeric(N_HH), fill = "N_HH"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 7,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)

print(N_HHplot)
```

#saving the google building count plot 
```{r}
# Save the plot to a file
ggsave("plots/N_HHplot.png", plot =N_HHplot, width = 8, height = 6, dpi = 400)
```



#BOX+VIOLIN plot for calculated buildings in Google building footprint data for different site status


```{r}
goog_plot <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = as.numeric(g_b_c), fill = "g_b_c"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Calculated Building count form GOOGLE data", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = as.numeric(g_b_c), fill ="g_b_c",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site building count calculated from Google building data for different Site Status", x = "Site Status", y = "Calculated Google building count") +
  geom_violin(aes(x = Sit_Stt, y = as.numeric(g_b_c), fill = "g_b_c"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 7,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)

print(goog_plot)
```

#saving the google building count plot 
```{r}
# Save the plot to a file
ggsave("plots/box_goog.png", plot =goog_plot, width = 8, height = 6, dpi = 400)
```

#BOX+VIOLIN plot for calculated buildings in OSM building footprint data for different site status

```{r}
osm_plot <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = as.numeric(osm_b_c), fill = "osm_b_c"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Calculated Building count form Open Street Map data", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = as.numeric(osm_b_c), fill ="osm_b_c",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site building count calculated from Open Street map building data for different Site Status", x = "Site Status", y = "Calculated Open Street Map building count") +
  geom_violin(aes(x = Sit_Stt, y = as.numeric(osm_b_c), fill = "osm_b_c"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 7,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)

print(osm_plot)
```
#saving the OSM building count plot 
```{r}
# Save the plot to a file
ggsave("plots/box_osm.png", plot =osm_plot, width = 8, height = 6, dpi = 400)
```

#BOX+VIOLIN plot for calculated buildings in Microsoft building footprint data for different site status

```{r}
msplot <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = as.numeric(ms_b_c), fill = "ms_b_c"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Calculated Building count form Microsoft data", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = as.numeric(ms_b_c), fill ="ms_b_c",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site building count calculated from Microsoft building data for different Site Status", x = "Site Status", y = "Calculated Microsoft building count") +
  geom_violin(aes(x = Sit_Stt, y = as.numeric(ms_b_c), fill = "ms_b_c"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 7,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)

print(msplot)
```

#saving the Microsoft building count plot 
```{r}
# Save the plot to a file
ggsave("plots/box_ms.png", plot =msplot, width = 8, height = 6, dpi = 400)
```


#BOX+VIOLIN plot for calculated buildings in vida MS_gOOGLE data for different site status

```{r}
vida_plot <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = as.numeric(vida_b_c), fill = "vida_b_c"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Calculated Building count form Vida Google-Microsoft data", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = as.numeric(vida_b_c), fill ="vida_b_c",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site building count calculated from Vida Google-Microsoft building data for different Site Status", x = "Site Status", y = "Calculated Microsoft building count") +
  geom_violin(aes(x = Sit_Stt, y = as.numeric(vida_b_c), fill = "vida_b_c"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 7,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)

print(vida_plot)
```


#saving the vida building count plot 
```{r}
# Save the plot to a file
ggsave("plots/box_vida.png", plot =vida_plot, width = 8, height = 6, dpi = 400)
```


#correlation of the population variables

```{r}
# Convert numeric variables from character to numeric
# Convert numeric variables from character to numeric
camps$N_INDVI <- as.numeric(camps$N_INDVI)
camps$ghsl <- as.numeric(camps$ghsl)
camps$wp_c <- as.numeric(camps$wp_c)
camps$wp_uc <- as.numeric(camps$wp_uc)
camps$gpw <- as.numeric(camps$gpw)

# Check the data types again
str(camps[, c("N_INDVI", "ghsl", "wp_c", "wp_uc", "gpw")])

# Check for missing values
summary(camps[, c("N_INDVI", "ghsl", "wp_c", "wp_uc", "gpw")])

# Calculate correlation coefficients
corr_ghsl <- cor(camps$N_INDVI,camps$ghsl)
corr_wp_c<-cor(camps$N_INDVI,camps$wp_c)
corr_wp_uc<-cor(camps$N_INDVI,camps$wp_uc)
corr_gpw<-cor(camps$N_INDVI,camps$gpw)

# View correlation coefficients
print(corr_ghsl)
print(corr_wp_uc)
print(corr_wp_c)
print(corr_gpw)
```
#trying corrplot

```{r}
# Specify the variables to keep
variables_to_keep <- c("N_INDVI", "ghsl", "wp_c", "wp_uc", "gpw")

# Remove the geometry column and keep the specified variables
camps_numeric <- camps[, names(camps) %in% c(variables_to_keep, "geometry")]

# Remove the geometry column and keep the specified variables
camps_numeric <- camps[, !names(camps) %in% c("geometry")]

# Calculate the correlation matrix
cor_matrix <- cor(camps_numeric)

# Plot the correlation matrix
corrplot(cor_matrix, method = "circle", type = "upper", tl.cex = 0.7)
```
#trying some summary stats

```{r}
camps$N_INDVI <- as.numeric(camps$N_INDVI)
camps$ghsl <- as.numeric(camps$ghsl)
camps$wp_c <- as.numeric(camps$wp_c)
camps$wp_uc <- as.numeric(camps$wp_uc)
camps$gpw <- as.numeric(camps$gpw)

# Remove geometry column
camps <- camps %>% select(-geometry)

summary(camps[, c("N_INDVI", "ghsl", "wp_c", "wp_uc", "gpw")])

# Visualizations
# Boxplot for each numeric variable
boxplot <- camps %>%
  gather(variable, value, N_INDVI:gpw) %>%
  ggplot(aes(x = variable, y = value)) +
  geom_boxplot() +
  labs(title = "Boxplot of Numeric Variables", y = "Value") +
  theme_minimal()

# Bar plot for each numeric variable
barplot <- camps %>%
  gather(variable, value, N_INDVI:gpw) %>%
  ggplot(aes(x = as.factor(value))) +  # Convert value to factor
  geom_bar(stat = "count") +
  facet_wrap(~variable, scales = "free") +
  labs(title = "Bar Plot of Numeric Variables", x = "Value", y = "Count") +
  theme_minimal()

# Combine plots
library(gridExtra)
combined_plot <- grid.arrange(boxplot, barplot, ncol = 2)

# Print combined plot
print(combined_plot)
```
#comparison plot between estimated and surveyed data

```{r}
library(gridExtra)

# Scatter plot comparing estimated population (ghsl) with surveyed population (N_INDVI)
scatterplot_ghsl_vs_N_INDVI <- ggplot(camps, aes(x = ghsl, y = N_INDVI)) +
  geom_point() +
  labs(title = "Estimated Population (GHSL) vs. Surveyed Population (N_INDVI)",
       x = "Estimated Population (GHSL)",
       y = "Surveyed Population (N_INDVI)") +
  theme_minimal()

# Scatter plot comparing estimated population (gpw) with surveyed population (N_INDVI)
scatterplot_gpw_vs_N_INDVI <- ggplot(camps, aes(x = gpw, y = N_INDVI)) +
  geom_point() +
  labs(title = "Estimated Population (GPW) vs. Surveyed Population (N_INDVI)",
       x = "Estimated Population (GPW)",
       y = "Surveyed Population (N_INDVI)") +
  theme_minimal()

# Scatter plot comparing estimated population (wp_c) with surveyed population (N_INDVI)
scatterplot_wp_c_vs_N_INDVI <- ggplot(camps, aes(x = wp_c, y = N_INDVI)) +
  geom_point() +
  labs(title = "Estimated Population (WP_C) vs. Surveyed Population (N_INDVI)",
       x = "Estimated Population (WP_C)",
       y = "Surveyed Population (N_INDVI)") +
  theme_minimal()

# Scatter plot comparing estimated population (wp_uc) with surveyed population (N_INDVI)
scatterplot_wp_uc_vs_N_INDVI <- ggplot(camps, aes(x = wp_uc, y = N_INDVI)) +
  geom_point() +
  labs(title = "Estimated Population (WP_UC) vs. Surveyed Population (N_INDVI)",
       x = "Estimated Population (WP_UC)",
       y = "Surveyed Population (N_INDVI)") +
  theme_minimal()

# Arrange the plots in a grid
plot_grid(scatterplot_ghsl_vs_N_INDVI, scatterplot_gpw_vs_N_INDVI,
          scatterplot_wp_c_vs_N_INDVI, scatterplot_wp_uc_vs_N_INDVI,
          nrow = 2, ncol = 2)
```

#calc vs survey(all data scatterplots)
```{r}
ghsl_plot <- ggplot(camps) + 
 
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(alpha = 0.6) +
  theme_ipsum()+
  # geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(ghsl), fill ="ghsl",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
   geom_point(color="#69b3a2", alpha=0.8) +
  coord_flip() +
  labs(title = "GHSL population", x = "Survey Population", y = "Calculate GHSL Population") +
  # geom_violin(aes(x =as.numeric(N_INDVI) , y = as.numeric(ghsl), fill ="ghsl"), alpha = 0.3) +
  # 
  theme(plot.title = element_text(size = 7,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)


# WP_C vs. N_INDVI violin plot
wp_c_plot <- ggplot(camps) + 
  scale_fill_viridis_d(alpha = 0.6) +
  theme_ipsum() +
  # geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_c), fill = "wp_c", color = Sit_Stt), size = 0.2, alpha = 0.9, show.legend = FALSE) +
  coord_flip() +
  labs(title = " Worldpop constrained Population", x = "Survey Population", y = "Calculated WP_C Population") +
  # geom_violin(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_c), fill = "wp_c"), alpha = 0.3) +
  theme(
    plot.title = element_text(size = 7, color = "blue", hjust = 0.5),
    axis.title.x = element_text(size = 6, hjust = 0.5),
    axis.title.y = element_text(size = 6, hjust = 0.5),
    axis.text.x = element_text(size = 5),
    axis.text.y = element_text(size = 5)
  ) +
  guides(fill = FALSE)

# WP_UC vs. N_INDVI violin plot
wp_uc_plot <- ggplot(camps) + 
  scale_fill_viridis_d(alpha = 0.6) +
  theme_ipsum() +
  # geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_uc), fill = "wp_uc", color = Sit_Stt), size = 0.2, alpha = 0.9, show.legend = FALSE) +
  coord_flip() +
  labs(title = "World Pop_UnConstrained Population", x = "Survey Population", y = "Calculated WP_UC Population") +
  # geom_violin(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_uc), fill = "wp_uc"), alpha = 0.3) +
  theme(
    plot.title = element_text(size = 7, color = "blue", hjust = 0.5),
    axis.title.x = element_text(size = 6, hjust = 0.5),
    axis.title.y = element_text(size = 6, hjust = 0.5),
    axis.text.x = element_text(size = 5),
    axis.text.y = element_text(size = 5)
  ) +
  guides(fill = FALSE)

# GPW vs. N_INDVI violin plot
gpw_plot <- ggplot(camps) + 
  scale_fill_viridis_d(alpha = 0.6) +
  theme_ipsum() +
  # geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(gpw), fill = "gpw", color = Sit_Stt), size = 0.2, alpha = 0.9, show.legend = FALSE) +
  coord_flip() +
  labs(title = "GPW population", x = "Survey Population", y = "Calculated GPW Population") +
  # geom_violin(aes(x = as.numeric(N_INDVI), y = as.numeric(gpw), fill = "gpw"), alpha = 0.3) +
  theme(
    plot.title = element_text(size = 7, color = "blue", hjust = 0.5),
    axis.title.x = element_text(size = 6, hjust = 0.5),
    axis.title.y = element_text(size = 6, hjust = 0.5),
    axis.text.x = element_text(size = 5),
    axis.text.y = element_text(size = 5)
  ) +
  guides(fill = FALSE)

# Arrange the plots in a grid
plot_grid(ghsl_plot,nrow = 2, ncol = 2)

```
#saving ghsl
```{r}
# Save the plot to a file
ggsave("plots/sc_all_cal_survey.png", plot =ghsl_plot, width = 8, height = 6, dpi = 400)
```



```{r}


# WP_C vs. N_INDVI violin plot
wp_c_plot <- ggplot(camps) + 
  scale_fill_viridis_d(alpha = 0.6) +
  theme_ipsum() +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_c), fill = "wp_c", color = Sit_Stt), size = 0.2, alpha = 0.9, show.legend = FALSE) +
  coord_flip() +
  labs(title = "Calculated Worldpop constrained Population and Surveyed Population", x = "Survey Population", y = "Calculated WP_C Population") +
  geom_violin(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_c), fill = "wp_c"), alpha = 0.3) +
  theme(
    plot.title = element_text(size = 7, color = "blue", hjust = 0.5),
    axis.title.x = element_text(size = 6, hjust = 0.5),
    axis.title.y = element_text(size = 6, hjust = 0.5),
    axis.text.x = element_text(size = 5),
    axis.text.y = element_text(size = 5)
  ) +
  guides(fill = FALSE)

print(wp_c_plot)

# WP_UC vs. N_INDVI violin plot
wp_uc_plot <- ggplot(camps) + 
  scale_fill_viridis_d(alpha = 0.6) +
  theme_ipsum() +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_uc), fill = "wp_uc", color = Sit_Stt), size = 0.2, alpha = 0.9, show.legend = FALSE) +
  coord_flip() +
  labs(title = "Calculated World Pop_UnConstrained Population and Surveyed Population", x = "Survey Population", y = "Calculated WP_UC Population") +
  geom_violin(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_uc), fill = "wp_uc"), alpha = 0.3) +
  theme(
    plot.title = element_text(size = 7, color = "blue", hjust = 0.5),
    axis.title.x = element_text(size = 6, hjust = 0.5),
    axis.title.y = element_text(size = 6, hjust = 0.5),
    axis.text.x = element_text(size = 5),
    axis.text.y = element_text(size = 5)
  ) +
  guides(fill = FALSE)

print(wp_uc_plot)

print(wp_uc_plot,wp_c_plot)

```


#saving
```{r}
# Save the plot to a file
ggsave("plots/violin_wp_c.png", plot =wp_c_plot, width = 8, height = 6, dpi = 400)
ggsave("plots/violin_wp_uc.png", plot =wp_uc_plot, width = 8, height = 6, dpi = 400)
```



```{r}
# GPW vs. N_INDVI violin plot
gpw_plot <- ggplot(camps) + 
  scale_fill_viridis_d(alpha = 0.6) +
  theme_ipsum() +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(gpw), fill = "gpw", color = Sit_Stt), size = 0.2, alpha = 0.9, show.legend = FALSE) +
  coord_flip() +
  labs(title = "Calculated GPW Population and Surveyed Population", x = "Survey Population", y = "Calculated GPW Population") +
  geom_violin(aes(x = as.numeric(N_INDVI), y = as.numeric(gpw), fill = "gpw"), alpha = 0.3) +
  theme(
    plot.title = element_text(size = 7, color = "blue", hjust = 0.5),
    axis.title.x = element_text(size = 6, hjust = 0.5),
    axis.title.y = element_text(size = 6, hjust = 0.5),
    axis.text.x = element_text(size = 5),
    axis.text.y = element_text(size = 5)
  ) +
  guides(fill = FALSE)

print(gpw_plot)
```
```{r}
# Save the plot to a file
ggsave("plots/violin_gpw.png", plot =gpw_plot, width = 8, height = 6, dpi = 400)
```

```{r}
camps$N_HH <- as.numeric(camps$N_HH)
camps$vida_b_c <- as.numeric(camps$vida_b_c)
camps$ms_b_c <- as.numeric(camps$ms_b_c)
camps$osm_b_c  <- as.numeric(camps$osm_b_c )
camps$g_b_c <- as.numeric(camps$g_b_c)
summary(camps[, c("N_HH", "vida_b_c", "ms_b_c", "osm_b_c", "g_b_c")])
```

