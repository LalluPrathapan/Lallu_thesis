---
title: "zonal_stat"
author: "Lallu Nikerthil Prathapan"
date: "2/27/2024"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Packages install
```{r}
install.packages("D:/EAGLE/Master_Thesis_Hannes/1/R/packages/exactextractr_0.10.0.tar.gz", repos = NULL, type = "source")
```


```{r}
# List of packages to install
packages_to_install <- c("cowplot")

# Install the packages
install.packages(packages_to_install)
```
#Packages library

```{r}
library(sf)
library(vctrs)
library(ggplot2)
library(raster)
library(exactextractr)
library(terra)
library(dplyr)
library(gridExtra)
library(tidyr)
library(units)
library(viridis)
library(hrbrthemes)
library(corrplot)
library(cowplot)
library(reshape2)
library(leaflet)
library(orca)
```

#______________________________________________


```{r}
build_stat_path2<-("D:/EAGLE/Master_Thesis_Hannes/1/R/Lallu_thesis/all_pop_output/camps_EO/camps_eo1/camps_eo1.shp")
camps<-st_read(build_stat_path2)
head(camps)
```

#removing the camp with less area and high population("BO_S294")

```{r}
# Assuming your dataset is named 'data'
# Subset the data to exclude the row with name "BO_S294"
camps<- subset(camps, Name != "BO_S294")
head(data)
```


#displaying the camps dataset 

```{r}
#under leaflet package
map <- leaflet() %>%
  addProviderTiles("OpenStreetMap.Mapnik")  # Choose your desired basemap

# Add the camps spatial object to the map as polygons
map <- addPolygons(map, data = camps,
                   fillColor = "blue",  # Adjust fill color as needed
                   color = "black",     # Adjust border color as needed
                   weight = 1)          # Adjust border width as needed

# Display the map
map
```
# Displaying each polygons of the camp


```{r}
length_camps <- nrow(camps)
# Iterate over each polygon
for (i in 1:length_camps) {
  # Plot each polygon with a larger heading
  plot(camps[i,"Name"], main = camps$Name[i], cex.main = 1)
  
  # Add text for 'cl_Shp_a' with a smaller size
 # Add text for 'cl_Shp_a' and 'N_INDVI' with a smaller size
text(camps[i, ], labels = paste("cl Shp_ar:", camps$cl_Shp_a[i], "\nSurveyed pop:", camps$N_INDVI[i]), cex = 0.4)
}
```

#plotting camps in grid

```{r}
# Define the number of rows and columns in the grid
num_rows <- 3
num_cols <- 3

# Determine the total number of plots needed
total_plots <- num_rows * num_cols

# Determine the number of camps to pad
num_to_pad <- total_plots - (nrow(camps) %% total_plots)

# Pad the camps data with NA values
camps_padded <- rbind(camps, rep(NA, num_to_pad))

# Split the padded camps data into subsets for plotting
camp_plots <- split(camps_padded, ceiling(seq_along(camps_padded) / total_plots))

# Create a function to plot each subset of camps data
plot_camp_subset <- function(camp_data) {
  ggplot() +
    geom_sf(data = camp_data, color = "blue", fill = "transparent") +
    ggtitle(unique(camp_data$Name)) +
    theme(plot.title = element_text(size = 10)) +
    labs(caption = paste("Calculated Shape_area:", unique(camp_data$cl_Shp_a), "\nSurveyed population:", unique(camp_data$N_INDVI))) +
    theme(plot.caption = element_text(size = 8, hjust = 0))
}

# Set up the plotting area for multiple plots
pdf("camp_plots.pdf")
for (i in 1:length(camp_plots)) {
  print(plot_camp_subset(camp_plots[[i]]))
}
dev.off()
```



#save the all the polygons plots as png

```{r}

length_camps <- nrow(camps)

# Set the output directory for saving plots
output_dir <- "camp_plots"

# Create the output directory if it doesn't exist
if (!dir.exists(output_dir)) {
  dir.create(output_dir)
}

# Iterate over each camp
for (i in 1:length_camps) {
  # Open a new PNG file for saving the plot
  png_file <- file.path(output_dir, paste0("camp_", i, ".png"))
  png(png_file, width = 1000, height = 800)
  
  # Plot the current camp
  plot(camps[i,"Name" ], main = camps$Name[i], cex.main = 1)
  
  # Add text for 'cl_Shp_a' and 'N_INDVI' with a smaller size
  text(camps[i, ], labels = paste("Calculated Shape_area:", camps$cl_Shp_a[i], "\nSurveyed population:", camps$N_INDVI[i]), cex = 0.5)
  
  # Save the plot
  dev.off()
}


```



# Study area properties
#finding the settlement boundary area stats

```{r}
#survey study area stats
sur_ar<-summary(as.numeric(camps$Site_Ar))
print(sur_ar)

#calculated shape area
dig_ar<-summary(as.numeric(camps$cl_Shp_a))
print(dig_ar)

```





#visualising the above summary stats
```{r}
library(ggplot2)

# Summary statistics
survey_stats <- c(Min = 934.1, Q1 = 6990.4, Median = 30423.1 , Mean = 120320.3, Q3 = 111391.7, Max =1606318.8 )
calculated_stats <- c(Min = 913.1 , Q1 =  8130.3, Median = 32858.4 , Mean = 128595.3, Q3 =  139927.7, Max = 1654478.8 )

# Combine statistics into a data frame
stats_data <- data.frame(
  Statistic = rep(c("Min", "Q1", "Median", "Mean", "Q3", "Max"), 2),
  Value = c(survey_stats, calculated_stats),
  Type = rep(c("Survey", "Calculated"), each = 6)
)

# Create a box plot
p <- ggplot(stats_data, aes(x = Type, y = Value, fill = Type)) +
  geom_boxplot() +
  labs(title = "Comparison of Study Area Statistics",
       y = "Value",
       x = "Type") +
  theme_minimal()

# Add annotations for mean, median, min, and max values
r<-p + geom_text(data = subset(stats_data, Statistic %in% c("Mean", "Median", "Min", "Max")),
              aes(label = Value), 
              position = position_dodge(width = 0.5), 
              vjust = -0.5, 
              size = 1.5)
print(r)

```
```{r}
# Save the plot to a file
ggsave("Plots/area_box_plot.png", plot = r, width = 8, height = 6, dpi = 400)
```


#subsetting the camps higher than 10000 square meter area

```{r}
# Subset the data
subset_data <- camps[as.numeric(camps$cl_Shp_a) > 10000, ]

# View the subsetted data
print(subset_data)

#print summary of the calculated area of this subsetted data

st_sub_camps<-summary(as.numeric(subset_data$cl_Shp_a))
print(st_sub_camps)

#Simple feature collection with 147 features 
```

#subsetting the camps higher than 10000 square meter area

```{r}
# Subset the data
subset_data_2 <- camps[as.numeric(camps$cl_Shp_a) < 10000, ]

# View the subsetted data
print(subset_data_2)

#print summary of the calculated area of this subsetted data

st_sub_camps_2<-summary(as.numeric(subset_data$cl_Shp_a))
print(st_sub_camps_2)

#Simple feature collection with 64 features and 
```


# Individual population statistics

```{r}
surv_sta<-summary(as.numeric(camps$N_INDVI))
print(surv_sta)
```

#box plot of the population column

```{r}
# Summary statistics
surv_sta <- c(Min = 26.0, Q1 = 332.5, Median = 1246.5, Mean =  4285.2, Q3 = 4664.8, Max = 43074.0  )

# Create a box plot
b<-boxplot(surv_sta,
        main = "Box Plot of N_INDVI",
        ylab = "Value",
        col = "lightblue",
        border = "blue",
        ylim = c(0, max(surv_sta) * 1.1))  # Adjust ylim for better visualization

# Add text labels for mean, median, and maximum
text(x = 1, y = surv_sta[c("Mean", "Median", "Max")], 
     labels = surv_sta[c("Mean", "Median", "Max")], 
     pos = 4, col = "red", cex = 0.5)  # Adjust the value of cex for text size
```
```{r}
# Save the plot to a file
ggsave("Plots/area_box_pop_plot.png", plot = b, width = 8, height = 6, dpi = 400)
```
# Calculate the variance of N_INDVI
```{r}


# Calculate the variance of N_INDVI
variance_N_INDVI <- var(camps$N_INDVI)

# Print the variance
print(variance_N_INDVI)

```
#Analysis about the data N_INDVI




# bar plot formal camps with area greater than 10000

```{r}
library(ggplot2)

# Filter the dataset for formal camps with cl_Shp_a > 10000
formal_large <- subset(camps, Sit_Stt == "Formal" & cl_Shp_a > 10000)

# Filter the dataset for formal camps with cl_Shp_a < 10000
formal_small <- subset(camps, Sit_Stt == "Formal" & cl_Shp_a < 10000)

# Filter the dataset for informal camps with cl_Shp_a > 10000
informal_large <- subset(camps, Sit_Stt == "Informal" & cl_Shp_a > 10000)

# Filter the dataset for informal camps with cl_Shp_a < 10000
informal_small <- subset(camps, Sit_Stt == "Informal" & cl_Shp_a < 10000)

# Create bar plots for formal camps with cl_Shp_a > 10000 and < 10000
bar_plot_formal <- ggplot() +
  geom_bar(data = formal_large, aes(x = "Formal (area > 10000)"), fill = "blue", alpha = 0.5) +
  labs(title = "Count of Formal Camps (area > 10000)",
       x = "Camp Type",
       y = "Count") +
  theme_minimal()

bar_plot_formal_small <- ggplot() +
  geom_bar(data = formal_small, aes(x = "Formal (area< 10000)"), fill = "blue", alpha = 0.5) +
  labs(title = "Count of Formal Camps (area < 10000)",
       x = "Camp Type",
       y = "Count") +
  theme_minimal()

# Create bar plots for informal camps with cl_Shp_a > 10000 and < 10000
bar_plot_informal <- ggplot() +
  geom_bar(data = informal_large, aes(x = "Informal (area > 10000)"), fill = "green", alpha = 0.5) +
  labs(title = "Count of Informal Camps (area > 10000)",
       x = "Camp Type",
       y = "Count") +
  theme_minimal()

bar_plot_informal_small <- ggplot() +
  geom_bar(data = informal_small, aes(x = "Informal (area < 10000)"), fill = "green", alpha = 0.5) +
  labs(title = "Count of Informal Camps (area < 10000)",
       x = "Camp Type",
       y = "Count") +
  theme_minimal()

library(ggplot2)

# Combine the datasets
combined_data <- rbind(
  mutate(formal_large, Type = "Formal (area > 10000)"),
  mutate(formal_small, Type = "Formal (area < 10000)"),
  mutate(informal_large, Type = "Informal (area > 10000)"),
  mutate(informal_small, Type = "Informal (area < 10000)")
)

# Create a bar plot
bar_plot_combined_in_f_gs_ls <- ggplot(combined_data, aes(x = Type, fill = Sit_Stt)) +
  geom_bar(alpha = 0.5) +
  labs(title = "Count of Camps by Type and Area",
       x = "Camp Type and Area",
       y = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) # Rotate x-axis labels if needed

# Print the combined bar plot
print(bar_plot_combined_in_f_gs_ls)




```
#save the bar plot

```{r}
ggsave("Plots/formal_informal_areagsls.png", plot =bar_plot_combined_in_f_gs_ls, width = 8, height = 6, dpi = 400)
```
#bar plot formal /informal population wise

```{r}
library(ggplot2)

# Filter the data for formal camps with N_INDVI > 10000 and N_INDVI < 10000
formal_large <- camps %>% filter(Sit_Stt == "Formal" & N_INDVI > 10000)
formal_small <- camps %>% filter(Sit_Stt == "Formal" & N_INDVI < 10000)

# Filter the data for informal camps with N_INDVI > 10000 and N_INDVI < 10000
informal_large <- camps %>% filter(Sit_Stt == "Informal" & N_INDVI > 10000)
informal_small <- camps %>% filter(Sit_Stt == "Informal" & N_INDVI < 10000)

# Combine the datasets
combined_data <- rbind(
  mutate(formal_large, Type = "Formal (N_INDVI > 10000)"),
  mutate(formal_small, Type = "Formal (N_INDVI < 10000)"),
  mutate(informal_large, Type = "Informal (N_INDVI > 10000)"),
  mutate(informal_small, Type = "Informal (N_INDVI < 10000)")
)

# Create a bar plot
bar_plot_combined_f_if_plg <- ggplot(combined_data, aes(x = Type, fill = Sit_Stt)) +
  geom_bar(alpha = 0.5) +
  labs(title = "Count of Camps by Type and N_INDVI",
       x = "Camp Type and N_INDVI",
       y = "Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) # Rotate x-axis labels if needed

# Print the combined bar plot
print(bar_plot_combined_f_if_plg)

```
#save the bar plot

```{r}
ggsave("Plots/bar_plot_combined_f_if_plg.png", plot =bar_plot_combined_f_if_plg, width = 8, height = 6, dpi = 400)
```
#______________________________________________
#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
#ZONAL STATISTICS for each of the global EO population datasets
#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
#____________________________________________

#1. GHSL DATA
#________________________________________________
```{r}
ghsl_raster_path<-"D:/EAGLE/Master_Thesis_Hannes/1/ghsl_pop_2020_mollweid_100m/merged_ghsl.tif"
# Read the raster file into R
ghsl_raster <- raster(ghsl_raster_path)

```

```{r}
# Display information about the raster
print(ghsl_raster)
```

```{r}
# Plot the raster
plot(ghsl_raster)
```

#!!!!!!The extract function!!!!!!!!!!!!!!!
#Dont run again
```{r}
# function

# weighted sum per polygon (using the size of the pixel covered by the polygon "coverage_fraction")

extract_sum  <-  function(raster, polygon, field){

  polygon $id_tmp <- as.data.frame(polygon)[,field]

  v.exact <- exactextractr::exact_extract(raster, polygon, include_cols = 'id_tmp', max_cells_in_memory=3e+10)

  x <- do.call("rbind",v.exact)

  x[,"gpw"] <- x[, "value"] * x$coverage_fraction

  x_sum <- x %>%

    dplyr::group_by(id_tmp)%>%

    dplyr::summarise_at("gpw", sum, na.rm = TRUE)

polygon <- polygon %>%

    left_join(x_sum, by = "id_tmp")

  rm(x,v.exact,x_sum)

  return(polygon)

}
```


```{r}
# Data
sf_data <- st_read(url) 
polygon_camps <-sf_data

```


```{r}
raster_population <- rast('D:/EAGLE/Master_Thesis_Hannes/1/ghsl_pop_2020_mollweid_100m/merged_ghsl.tif')
```

```{r}
# Call function

polygon_camps <- extract_sum(raster_population, polygon_camps,"Name")

```


#Difference in the population
```{r}


# Subtract N_INDVID from ras_name
camps$ghsl_difference <- polygon_camps$N_INDVID - camps$ghsl

# View the resulting data frame with the new "difference" column
print(camps)

```



#%%%%%%GHSL END%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#


#_____GHSL PLOTS_____


#1.(ESTI_SUR)plot GHSLEstimated and Iom survey population
```{r}
# Scatter plot with site_status
ghsl_surv<-ggplot(camps, aes(y = ghsl, x = N_INDVI, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(ghsl)),shape=3,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between estimated and survey iom populations",
       y = "Estimated GHSL population",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(ghsl_surv)
```
#Analysis:
!!!(not sure)It can be found that the informal with lowere population has more correlation than the formal camps with higher population



#correlation GHSL and N_INDVI

```{r}
# Convert numeric variables from character to numeric

camps$N_INDVI <- as.numeric(camps$N_INDVI)

camps$ghsl <- as.numeric(camps$ghsl)

# CalculateH correlation coefficients
corr_ghsl_pop<- cor(camps$N_INDVI,camps$ghsl)


# View correlation coefficients
print(corr_ghsl_pop)

#Result
# [1] 0.6700698

```

#Analysis
The correlation coefficient is 0.6701, indicating a moderate positive correlation between N_INDVI and ghsl.


#2.(Informal)Subset the informal camps and plot the estimate  vs calc

```{r}


# 1. Subset the informal camps
informal_camps <- camps %>% filter(Sit_Stt == "Informal")

# 2. Extract relevant columns
data_plot <- informal_camps %>%
  select(ghsl, N_INDVI)

# 3. Plot with ggplot2
inf_plot<-ggplot(data_plot, aes(y = ghsl, x = N_INDVI)) + geom_smooth(method = "lm", se = FALSE, color = "red") +  # Add a linear trend line
  geom_point() +
  labs(y = "GHSL Estimated Population", x = "Surveyed Population (N_INDVI)",
       title = "GHSL vs Surveyed Population for Informal Camps")
print(inf_plot)
corr_ghsl_inf<-cor(as.numeric(informal_camps$N_INDVI),as.numeric(informal_camps$ghsl))
print(corr_ghsl_inf)

#correlation result
#[1] 0.6390757
```

#3.(Formal)Subset the Formal camps and plot the estimate  vs calc
```{r}

# 1. Subset the informal camps
formal_camps <- camps %>% filter(Sit_Stt == "Formal")

# 2. Extract relevant columns
data_plot <- formal_camps %>%
  select(ghsl, N_INDVI)

# 3. Plot with ggplot2
for_plot<-ggplot(data_plot, aes(y = ghsl, x = N_INDVI)) +
  geom_point() + geom_smooth(method = "lm", se = FALSE, color = "red") +  # Add a linear trend line
  labs(y = "GHSL Estimated Population", x = "Surveyed Population (N_INDVI)",
       title = "GHSL vs Surveyed Population for formal Camps")
print(for_plot)
corr_ghsl_f<-cor(as.numeric(formal_camps$N_INDVI),as.numeric(formal_camps$ghsl))
print(corr_ghsl_f)

#correlation result
#[1] 0.6723599
```


#4.(informal_<5000)filtering the surveyed population less then 5000 for informal and plotting the calc vs estimated


```{r}
# 1. Subset the informal camps with surveyed population less than 5000
informal_camps_filtered <- camps %>%
  filter(Sit_Stt == "Informal" & N_INDVI < 5000)

# 2. Extract relevant columns
data_plot <- informal_camps_filtered %>%
  select(ghsl, N_INDVI)

# 3. Plot with ggplot2
info_fil<-ggplot(data_plot, aes(x = N_INDVI, y = ghsl)) +
  geom_point() + geom_smooth(method = "lm", se = FALSE, color = "red") +  # Add a linear trend line
  labs(x = "Surveyed Population (N_INDVI)", y = "GHSL Estimated Population",
       title = "Surveyed vs Estimated Population for Informal Camps") 
 

corr_ghsl_inf_ls5<-cor(as.numeric(informal_camps_filtered$N_INDVI),as.numeric(informal_camps_filtered$ghsl))
print(corr_ghsl_inf_ls5)

#correlation result
#[1] 0.3155069
```

# 5.(area_wise>10000)now considering the area wise plots for area only camps having area greater than 10000 square meter area

```{r}
# Scatter plot with site_status
ghsl_surv_a<-ggplot(subset_data, aes(y = ghsl, x = N_INDVI, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(ghsl)),size = 0.6, alpha = 0.8,show.legend = TRUE)+   geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +  # Add trend lines by site status
  labs(title = "Comparison between estimated and survey iom populations for area greater then 10000 sq mts",
       y = "Estimated GHSL population",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(ghsl_surv_a)
  
corr_ghsl_ath<-cor(as.numeric(subset_data$N_INDVI),as.numeric(subset_data$ghsl))
print(corr_ghsl_ath)

#correlation result
#[1][1] 0.6429026
  
```
# 6.(Area_wise<10000)now considering the area wise plots for area only camps having area less than 10000 square meter area

```{r}
# Scatter plot with site_status
ghsl_surv_als<-ggplot(subset_data_2, aes(y = ghsl, x = N_INDVI, color = Sit_Stt, label = Name)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(ghsl)),size = 0.6, alpha = 0.8,show.legend = TRUE)+  geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +  # Add trend lines by site status
  # geom_text(aes(x = as.numeric(N_INDVI), y = as.numeric(ghsl)), size = 1, vjust = -0.5, hjust = -0.5)+
  labs(title = "Comparison between estimated and survey iom populations for area less then 10000 sq mts",
       y = "Estimated GHSL population",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(ghsl_surv_als)
  
corr_ghsl_als<-cor(as.numeric(subset_data_2$N_INDVI),as.numeric(subset_data_2$ghsl))
print(corr_ghsl_als)

#correlation result
#[1][1] 0.02531606
```





#____NO NEED_______
#Ratio of survey population to estimated population

```{r}
# Calculate the ratio between ghsl and N_INDVI
camps <- camps %>%
  mutate(ghsl_N_INDVI_ratio = as.numeric(ghsl) / as.numeric(N_INDVI))
```


```{r}
# Assuming you have two vectors ghsl and N_INDVI containing the respective values
# Calculate the ratio of ghsl to N_INDVI
ratios <- as.numeric(camps$ghsl_N_INDVI_ratio)

# Find ratios close to 1 (within a tolerance)
tolerance <- 0.05  # Define a tolerance level
ratios_close_to_1 <- ratios[abs(ratios - 1) < tolerance]

# Find ratios greater than 1
ratios_greater_than_1 <- ratios[ratios > 1]

# Find ratios less than 1
ratios_less_than_1 <- ratios[ratios < 1]

# Print the results
print("Ratios close to 1:")
print(ratios_close_to_1)

print("Ratios greater than 1:")
print(ratios_greater_than_1)

print("Ratios less than 1:")
print(ratios_less_than_1)
```

Analysis of the ratio
Ratio close to 1: This suggests that the estimated population closely matches the calculated population, indicating a high level of accuracy in the estimation method.

Ratio greater than 1: If the estimated population is consistently higher than the calculated population, it could indicate that the estimation method tends to overestimate the population.

Ratio less than 1: Conversely, if the estimated population is consistently lower than the calculated population, it suggests that the estimation method tends to underestimate the population.

Variability in the ratio: Fluctuations or variability in the ratio across different regions or time periods may indicate inconsistencies or biases in the estimation method.


So in the ratio taken there are 

18 sites with ratios greater than 1, which implies for these 18 sites GHSL tends to overestimate the population
#?(have a check on the area [whether it si comparitably small camp for the data]and formal, informal relationship for this sites)

"Ratios greater than 1:"
[1]  1.500790  2.237274 23.769992
 [4]  4.782971  4.615672  2.163938
 [7]  1.012266  1.145288  3.547234
[10]  1.001431  2.421267  1.034403
[13]  1.141190  1.155286  2.332230
[16]  1.602557 14.624572 12.684516

and the rest 205 ratios which are less than 1, which implies there is a considerable understimation of the population by GHSL for all the other sites

And among them only 4 sites with ratios closer to 1 , which shows that GHSL estimate and survey population matches a bit for these camps. These are the camps that GHSL accurately estimated
#?check the area, Shelter status, as well as the rural-urban status of these sites

"Ratios close to 1:"

[1] 0.9845018 1.0122658 1.0014311
[4] 1.0344027

#Linear regression

```{r}
# 3. Linear regression
model <- lm(ghsl_N_INDVI_ratio ~ N_INDVI, data = camps)
summary(model)

# 4. Visualization of the regression line
lr <- ggplot(camps, aes(x = N_INDVI, y = ghsl_N_INDVI_ratio)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Linear Regression of ghsl to N_INDVI Ratio",
       x = "N_INDVI",
       y = "ghsl to N_INDVI Ratio")

# Print the plots and correlation coefficient
print(lr)

```
#________NO NEED__________________________
#_________________________
# splitting the population estimates for <10000 and > 10000

#7.(POPwise<10000&>10000) to see the sitesname for less than and greateer than 10000

```{r}
 #Scatter plot with site_status for N_INDVI greater than 10,000
campsgt10000 <- subset(camps, N_INDVI > 10000)
campls10000 <- subset(camps, N_INDVI < 10000)

ghsl_surv_greater <- ggplot(subset(camps, as.numeric(N_INDVI) > 10000), aes(y = ghsl, x = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(ghsl)), size = 0.6, alpha = 0.4, show.legend = TRUE) +  geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +  # Add trend lines by site status
  labs(title = "Comparison between estimated and survey iom populations",
       y = "Estimated GHSL population",
       x = "Iom surveyed population (N_INDVI > 10,000)") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(0, 40000, by = 5000))  # Adjust y-axis intervals

# Scatter plot with site_status for N_INDVI less than or equal to 10,000
ghsl_surv_lesser <- ggplot(subset(camps, as.numeric(N_INDVI) <= 10000), aes(y = ghsl, x = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(ghsl)), size = 0.6, alpha = 0.4, show.legend = TRUE) +  geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +  # Add trend lines by site status
  labs(title = "Comparison between estimated and survey iom populations",
       y = "Estimated population",
       x = "Iom surveyed population (N_INDVI <= 10,000)") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(0, 10000, by = 1000))  # Adjust y-axis intervals

# Print the plots
print(ghsl_surv_greater)
print(ghsl_surv_lesser)

#N_INDVI>10000(Survey pop >10000)
#Simple feature collection with 24 features and 37 fields
#N_INDVI<10000(Survey pop <10000)
#Simple feature collection with 199 features and 37 fields


#correlation for this

cor_ghsl_gt10000<-cor(campsgt10000 $N_INDVI,campsgt10000$ghsl )
print(cor_ghsl_gt10000)
cor_ghsl_ls10000<-cor(campls10000 $N_INDVI,campls10000$ghsl )
print(cor_ghsl_ls10000)
```
#Analysis : most of the formal camps have population greated than 10,000 and for informal camps the popualtion is mostly under 5000.


Considering the camps having the survey population less than or equal to 10,000. it can be seen that varies sites having the population estimate higher than tht of the survey population. 


#8.(POP<500)splitting the population less than 500

```{r}
ghsl_ls_500<-subset(camps, N_INDVI<500)
ghsl_surv_ls500 <- ggplot(subset(camps, as.numeric(N_INDVI) < 500), aes(y = ghsl, x = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(ghsl)), size = 0.6, alpha = 0.4, show.legend = TRUE) +  geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between estimated and survey IOM populations",
       y = "Estimated GHSL population",
       x = "IOM surveyed population (N_INDVI < 500)") +
  theme_minimal() 
  # scale_y_continuous(breaks = seq(0, 550, by = 100))+scale_x_continuous(breaks = seq(0, 550, by = 100))  # Adjust y-axis intervals

#print plots'
print(ghsl_surv_ls500)
#correlation
cor_ghsl_ls500<-cor(ghsl_ls_500 $N_INDVI,ghsl_ls_500$ghsl )
print(cor_ghsl_ls500)
```



#9.(SHELTER TYPE) Plot between calc vs surveyed pop arranged according to the shelter type


```{r}
# Plot shelter type to see how it behave

# Define custom colors for Shelter_type
custom_colors <- c("#FF5733", "#33FF57", "#3366FF", "#FF33A8", "#FFFF33", "#33FFFF",  "#808080", "#A52A2A")
# filt_data_shltyls <- subset(camps, as.numeric(N_INDVI)<500)
# Set the alpha value for all points
alpha_value <- 0.2
# Scatter plot with different colors based on Shelter_type
ghsl_shlt_typ<-ggplot(camps, aes(y = as.numeric(ghsl), x = as.numeric(N_INDVI), color = Shlt_ty)) +
  geom_point(alpha = alpha_value) +
  labs(title = "Comparison between ghsl and N_INDVI",
       y = "Estimated ghsl population",
       x = "Surveyed Population") +
  scale_color_manual(values = custom_colors) +  # Set custom colors
   # scale_y_continuous(breaks = seq(0, 2500, by = 500)) +
   # # scale_x_continuous(breaks = seq(0,2500 , by = 500))  # Adjust y-axis intervals
  theme_minimal()
print(ghsl_shlt_typ)
```

#10.(SETTLEMENT CLASS) Settlement class wise plot for calc vs estimated plot

```{r}
# Define custom colors for Shelter_type
custom_colors <- c( "#A52A2A","#33FFFF",  "#FF33A8")
# filt_data_shltyls <- subset(camps, as.numeric(N_INDVI)<500)
# Set the alpha value for all points
alpha_value <- 0.5
# Scatter plot with different colors based on Shelter_type
ghsl_st_cl<-ggplot(camps, aes(y = as.numeric(ghsl), x = as.numeric(N_INDVI), color = St_clss)) +
  geom_point(alpha = alpha_value) +
  labs(title = "Comparison between ghsl and N_INDVI",
       y = "Estimated ghsl population",
       x = "Surveyed Population") +
  scale_color_manual(values = custom_colors) +  # Set custom colors
   # scale_y_continuous(breaks = seq(0, 2500, by = 500)) +
   # # scale_x_continuous(breaks = seq(0,2500 , by = 500))  # Adjust y-axis intervals
  theme_minimal()
print(ghsl_st_cl)
```
# Analysis

There are only 2 planned settlement with high population


#11.(N_HHvsN_INDVI)The plots with Number of Households and survey population +ghsl population


```{r}
# Scatter plot comparing N_INDIVID and N_HH
plot1 <- ggplot(camps, aes(x = as.numeric(N_INDVI), y = as.numeric(N_HH), color = Sit_Stt)) +
  geom_point() +
  labs(title = "Comparison between IOM survey population and Survey Houshold numbers",
       x = "IOM Survey population",
       y = "Households") + geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  theme(plot.title = element_text(size = 3, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3, hjust = 0.5),
        axis.title.y = element_text(size = 3, hjust = 0.5),
        axis.text.x = element_text(size = 2),
        axis.text.y = element_text(size = 2)) +
  theme_minimal()

# Scatter plot comparing N_HH and ghsl
plot3 <- ggplot(camps, aes(y = as.numeric(N_HH), x = as.numeric(ghsl), color = Sit_Stt)) +
  geom_point() + geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between Household survey and Estimated GHSL Population",
       y = "Households",
       x = "Estimated GHSL Population") +
 
  theme(plot.title = element_text(size = 3, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3, hjust = 0.5),
        axis.title.y = element_text(size = 3, hjust = 0.5),
        axis.text.x = element_text(size = 2),
        axis.text.y = element_text(size = 2)) +
  theme_minimal()

# Arrange the plots in a grid
hh_ghsl<-grid.arrange(plot1, plot3, ncol = 1)
```

#12.Number of households and GHSL population only

```{r}
# Scatter plot comparing N_HH and ghsl
hh_ghsl_c <- ggplot(camps, aes(y = as.numeric(N_HH), x = as.numeric(ghsl), color = Sit_Stt)) +
  geom_point() + geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between Household survey and Estimated GHSL Population",
       y = "Households",
       x = "Estimated GHSL Population") +
 
  theme(plot.title = element_text(size = 3, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3, hjust = 0.5),
        axis.title.y = element_text(size = 3, hjust = 0.5),
        axis.text.x = element_text(size = 2),
        axis.text.y = element_text(size = 2)) +
  theme_minimal()
print(hh_ghsl_c)
```



#ALL GHSL PLOT SAVE

```{r}
# Save the plot to a file
#1.survey +estimated scatterplot
ggsave("Plots/ghsl_surv_scat.png", plot =ghsl_surv, width = 8, height = 6, dpi = 400)
#2.Informal camp subset survey+estimated
ggsave("Plots/inf_plot.png", plot =inf_plot, width = 8, height = 6, dpi = 400)
#3.Formal camp subset survey +estimated
ggsave("Plots/for_plot.png", plot =for_plot, width = 8, height = 6, dpi = 400)
#4.Informal camp filtered for population<5000
ggsave("Plots/info_fil.png", plot =info_fil, width = 8, height = 6, dpi = 400)
#5.Areawise subsetted(>10000 sqmts) calc vs estimated plot for formal and informal
ggsave("Plots/ghsl_surv_a.png", plot =ghsl_surv_a, width = 8, height = 6, dpi = 400)
#6.Areawise subsetted(<10000 sqmts) calc vs estimated plot for formal and informal
ggsave("Plots/ghsl_surv_als.png", plot =ghsl_surv_als, width = 8, height = 6, dpi = 400)
#7.Populationwise subsetted(>10000 ) calc vs estimated plot for formal and informal
ggsave("Plots/ghsl_pg.png", plot =ghsl_surv_greater, width = 8, height = 6, dpi = 400)
#7.Populationwise subsetted(<10000 ) calc vs estimated plot for formal and informal
ggsave("Plots/ghsl_pls.png", plot =ghsl_surv_lesser, width = 8, height = 6, dpi = 400)
#8.Populationwise subsetted(<500) calc vs estimated plot for formal and informal
ggsave("Plots/ghsl_ls500.png", plot =ghsl_surv_ls500, width = 8, height = 6, dpi = 400)
#9. Shelter type wise calc vs estimated plot 
ggsave("Plots/ghsl_shlt_typ.png", plot =ghsl_shlt_typ, width = 8, height = 6, dpi = 400)
#10.Settlement class wise calc vs estimated plot
ggsave("Plots/ghsl_st_cl.png", plot=ghsl_st_cl,width = 8, height = 6, dpi = 400)
#11. Houslhold survey number vs surveyed population and estimated population plot
ggsave("Plots/ghs_hh_ind.png", plot =hh_ghsl, width = 8, height = 6, dpi = 400)
#12. Household number vs estimated population
ggsave("Plots/hh_ghsl_c.png", plot =hh_ghsl_c, width = 8, height = 6, dpi = 400)
```

#_______GHS PLOT END_______



#A.Correlation between houshold and population(both survey and estimated GHSL)

```{r}
# Convert numeric variables from character to numeric
# Convert numeric variables from character to numeric
camps$N_INDVI <- as.numeric(camps$N_INDVI)
camps$N_HH <- as.numeric(camps$N_HH)
camps$ghsl <- as.numeric(camps$ghsl)


# Check the data types again
str(camps[, c("N_INDVI", "ghsl", "N_HH")])

# Check for missing values
summary(camps[, c("N_INDVI", "ghsl", "N_HH")])

# CalculateH correlation coefficients
corr_ghsl_HH<- cor(camps$N_HH,camps$ghsl)
corr_ind_HH<-cor(camps$N_INDVI,camps$N_HH)

# View correlation coefficients
print(corr_ghsl_HH)
print(corr_ind_HH)

#[1] 0.6947949
#[1] 0.9409748

```
#Analysis
There is a strong positive correlation between the survey population and the number of the survey households. 

Similarly a strong positive correlation exist between the ghsl population and number of households.

The surveryed population and household correlations are stronger.


#B.Find about the difference in  statistics which will help in understanding the change in population of the camps from that of the estimated population 
```{r}
ghs_dff_stats<-summary(as.numeric(camps$ghsl_df))
print(ghs_dff_stats)

```

#Analysis:

Seeing that the mean in the difference in population between the ghsl and the surveyed population is overestimation by 2954.9, which is a pretty big overestimation 

What could be the reason for this????



#C.absolute diff/percentage diff/RMSE/mean absolute/percentage error

```{r}
# Convert variables to numeric if necessary
camps$ghsl <- as.numeric(camps$ghsl)
camps$N_INDVI <- as.numeric(camps$N_INDVI)

# Calculate absolute difference
absolute_difference <- abs(camps$ghsl - camps$N_INDVI)

# Calculate percentage difference
percentage_difference <- abs((camps$ghsl - camps$N_INDVI) / camps$N_INDVI) * 100

# Calculate root mean square error (RMSE)
rmse <- sqrt(mean((camps$ghsl - camps$N_INDVI)^2))

# Calculate mean absolute percentage error (MAPE)
mape <- mean(percentage_difference, na.rm = TRUE)

# Calculate absolute error
absolute_error <- mean(abs(as.numeric(camps$ghsl) - as.numeric(camps$N_INDVI)))

# Print the result
print(absolute_error)

# Calculate percentage error
percentage_error <- mean(abs(as.numeric(camps$ghsl) - as.numeric(camps$N_INDVI)) / as.numeric(camps$N_INDVI)) * 100

# Print the result
print(percentage_error)

# Print results
cat("Absolute Difference:", mean(absolute_difference), "\n")
cat("Percentage Difference:", mean(percentage_difference), "%\n")
cat("RMSE:", rmse, "\n")
cat("MAPE:", mape, "%\n")
cat("Absolute error:",absolute_error,"\n")
cat("Percentage error:",percentage_error)

```




```{r}
library(ggplot2)

# Assuming ghsl_df is a data frame with a single column named ghsl
# Create a boxplot for ghsl_df
boxplot <- ggplot(camps, aes(x=Sit_Stt,y = ghsl_df)) +
  geom_boxplot() +geom_jitter(aes(x=Sit_Stt, y =ghsl_df), size = 0.2, alpha = 0.9,show.legend = FALSE) +coord_flip()
  labs(title = "Boxplot of GHSL Data",
       y = "GHSL Value")

# Print the boxplot
print(boxplot)
```

#_____________________________________
#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$

#2.World POP(unconstrained)
#__________________________________________
#nga_PPP_2020 is actually unconstrained dataset

```{r}
World_pop_uc <- rast('D:/EAGLE/Master_Thesis_Hannes/1/world_pop/nga_ppp_2020.tif')
print(World_pop)
```


```{r}

# Call function

camps <- extract_sum(World_pop_uc,camps,"Name")

```
#Difference in the survery_population and world_pop unconstrained
```{r}
# Assuming you have a column named "N_INDVID" in the polygon_camps data frame
# Adjust the column name if needed

# Subtract N_INDVID from ras_name
camps$wp_uc_df <- as.numeric(camps$N_INDVI) - as.numeric(camps$wp_uc)

# View the resulting data frame with the new "difference" column
print(camps)

```
#%%%%Calc Wp_uc END%%%%%%%%%%%%%%%%%%%%%
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


#___WORLDPOP_PLOT(UC)_______________


#1.(ESTI_SUR)worldpop unconstrained Estimated and Iom survey population
```{r}
# Scatter plot with site_status
wp_uc_sc_surv<-ggplot(camps, aes(y = wp_uc, x = N_INDVI, color = Sit_Stt)) +

  geom_jitter(aes(x = (as.numeric(N_INDVI)),y = as.numeric(wp_uc)), size = 0.6, alpha = 0.8,show.legend = TRUE)+ geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) + 
  labs(title = "Comparison between estimated and survey iom populations",
       y = "Estimated population(Worldpop unconstrained)",
       x = "IOM surveyed population") +
  theme_minimal()
print(wp_uc_sc_surv)
corr_wp_uc<-cor(camps$N_INDVI,camps$wp_uc)
print(corr_wp_uc)

```


#2.(Informal)Subset the informal camps and plot the estimate  vs calc

```{r}

# 1. Subset the informal camps
informal_camps <- camps %>% filter(Sit_Stt == "Informal")

# 2. Extract relevant columns
data_plot <- informal_camps %>%
  select(wp_uc, N_INDVI)

# 3. Plot with ggplot2
inf_plot_wp_uc<-ggplot(data_plot, aes(y = wp_uc, x = N_INDVI)) + geom_smooth(method = "lm", se = FALSE) + 
  #geom_point() +
  geom_jitter(aes(x = (as.numeric(N_INDVI)),y = as.numeric(wp_uc)), size = 0.6, alpha = 0.8,show.legend = TRUE)
  labs(title = "World Pop (Unconstrained) vs Surveyed Population for Informal Camps",
  y = "World Pop (Unconstrained)Estimated Population", x = "Surveyed Population (N_INDVI)" )+theme_minimal()

print(inf_plot_wp_uc)

corr_wp_uc_inf<-cor(as.numeric(informal_camps$N_INDVI),as.numeric(informal_camps$wp_uc))
print(corr_wp_uc_inf)

#correlation result
#[1] 0.6962222
```



#3.(Formal)Subset the Formal camps and plot the estimate  vs calc
```{r}

# 1. Subset the informal camps
formal_camps <- camps %>% filter(Sit_Stt == "Formal")

# 2. Extract relevant columns
data_plot <- formal_camps %>%
  select(wp_uc, N_INDVI)

# 3. Plot with ggplot2
for_plot_wp_uc<-ggplot(data_plot, aes(y = wp_uc, x = N_INDVI)) +
  geom_jitter(aes(x = (as.numeric(N_INDVI)),y = as.numeric(wp_uc)), size = 0.6, alpha = 0.8,show.legend = TRUE)+ geom_smooth(method = "lm", se = FALSE) + 
  #geom_point() +
  labs(y = "GHSL Estimated Population", x = "Surveyed Population (N_INDVI)",
       title = "GHSL vs Surveyed Population for formal Camps")
print(for_plot_wp_uc)

corr_wp_uc_f<-cor(as.numeric(formal_camps$N_INDVI),as.numeric(formal_camps$wp_uc))
print(corr_wp_uc_f)


#correlation result
#[1] 0.6239074
```




#4.(informal_<5000)filtering the surveyed population less then 5000 for informal and plotting the calc vs estimated


```{r}
# 1. Subset the informal camps with surveyed population less than 5000
informal_camps_filtered <- camps %>%
  filter(Sit_Stt == "Informal" & N_INDVI < 5000)

# 2. Extract relevant columns
data_plot <- informal_camps_filtered %>%
  select(wp_uc, N_INDVI)

# 3. Plot with ggplot2
info_fil_wp_uc<-ggplot(data_plot, aes(x = N_INDVI, y = wp_uc)) +
  geom_jitter(aes(x = (as.numeric(N_INDVI)),y = as.numeric(wp_uc)), size = 0.6, alpha = 0.8,show.legend = TRUE)+ geom_smooth(method = "lm",  se = FALSE) + 
  #geom_point() +
  labs(x = "Surveyed Population (N_INDVI)", y = "World Pop (unconstrained) Estimated Population",
       title = "Surveyed vs Estimated Population for Informal Camps") 
 
print(info_fil_wp_uc)
corr_wp_uc_inf_ls5<-cor(as.numeric(informal_camps_filtered$N_INDVI),as.numeric(informal_camps_filtered$wp_uc))
print(corr_wp_uc_inf_ls5)

#correlation result
#[1] 0.4159303
```


# 5.(Area_wise>10000)now considering the area wise plots for area only camps having area greater than 10000 square meter area

```{r}
# Scatter plot with site_status
wp_uc_surv_a<-ggplot(subset_data, aes(y = wp_uc, x = N_INDVI, color = Sit_Stt)) + geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) + 
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(wp_uc)),size = 0.6, alpha = 0.8,show.legend = TRUE)+
  
  labs(title = "Comparison between estimated and survey iom populations for area greater then 10000 sq mts",
       y = "Estimated World Pop unconstrained population",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(wp_uc_surv_a)
  
corr_wp_uc_ath<-cor(as.numeric(subset_data$N_INDVI),as.numeric(subset_data$wp_uc))
print(corr_wp_uc_ath)

#correlation result
#[1]0.5932672
  
```



# 6.(Area_wise<10000)now considering the area wise plots for area only camps having area less than 10000 square meter area

```{r}
# Scatter plot with site_status
wp_uc_surv_als<-ggplot(subset_data_2, aes(y = wp_uc, x = N_INDVI, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(wp_uc)),size = 0.6, alpha = 0.8,show.legend = TRUE)+ geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) + 
  # geom_text(aes(x = as.numeric(N_INDVI), y = as.numeric(ghsl)), size = 1, vjust = -0.5, hjust = -0.5)+
  labs(title = "Comparison between estimated and survey iom populations for area less then 10000 sq mts",
       y = "Estimated Worldpop(UnConstrained) population",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(wp_uc_surv_als)
  
corr_wp_uc_als<-cor(as.numeric(subset_data_2$N_INDVI),as.numeric(subset_data_2$wp_uc))
print(corr_wp_uc_als)

#correlation result
#[1][1] 0.2369614
```



#Splitting the population estimates for <10000 and > 10000

#7.(POPwise<10000&>10000) to see the sitesname for less than and greateer than 10000
```{r}
campsgt10000 <- subset(camps, N_INDVI > 10000)
campls10000 <- subset(camps, N_INDVI < 10000)

# Scatter plot with site_status for N_INDVI greater than 10,000
wp_uc_surv_greater <- ggplot(subset(camps, as.numeric(N_INDVI) > 10000), aes(y = wp_uc, x = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_uc)), size = 0.6, alpha = 0.4, show.legend = TRUE) + geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between estimated and survey IOM populations",
       y = "Estimated population Worldpop(unconstrained)",
       x = "IOM surveyed population (N_INDVI > 10,000)") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(0, 40000, by = 5000))  # Adjust y-axis intervals

# Scatter plot with site_status for N_INDVI less than or equal to 10,000
wp_uc_surv_lesser <- ggplot(subset(camps, as.numeric(N_INDVI) <= 10000), aes(y = wp_uc, x = N_INDVI, color = Sit_Stt)) + geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_uc)), size = 0.6, alpha = 0.4, show.legend = TRUE) +
  labs(title = "Comparison between estimated and survey iom populations",
       y = "Estimated population(World pop unconstrained)",
       x = "IOM surveyed population (N_INDVI <= 10,000)") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(0, 10000, by = 1000))  # Adjust y-axis intervals

# Print the plots
print(wp_uc_surv_greater)
print(wp_uc_surv_lesser)



cor_wp_uc_gt10000<-cor(campsgt10000 $N_INDVI,campsgt10000$wp_uc)
print('population greater than10000')
print(cor_wp_uc_gt10000)
cor_wp_uc_ls10000<-cor(campls10000 $N_INDVI,campls10000$wp_uc )
print('population less than10000')
print(cor_wp_uc_ls10000)
```

```{r}
# 1. Scatterplot of the estimated vs survey population
ggsave("Plots/wp_uc_sc_surv.png", plot =wp_uc_sc_surv, width = 8, height = 6, dpi = 400)
```


#8.(POP<500)splitting the population less than 500


```{r}
ghsl_ls_500<-subset(camps, N_INDVI<500)
wp_uc_surv_ls500 <- ggplot(subset(camps, as.numeric(N_INDVI) < 500), aes(y = wp_uc, x = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_uc)), size = 0.6, alpha = 0.4, show.legend = TRUE) +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between estimated and survey IOM populations",
       y = "Estimated population (Wp_uc",
       x = "IOM surveyed population (N_INDVI < 500)") +
  theme_minimal() 
  # scale_y_continuous(breaks = seq(0, 550, by = 100))+scale_x_continuous(breaks = seq(0, 550, by = 100))  # Adjust y-axis intervals

#print plots'
print(wp_uc_surv_ls500)
#correlation
cor_wp_uc_ls500<-cor(ghsl_ls_500 $N_INDVI,ghsl_ls_500$wp_uc )
print(cor_wp_uc_ls500)

```

#9.(SHELTER TYPE) Plot between calc vs surveyed pop arranged according to the shelter type

```{r}
# Define custom colors for Shelter_type
custom_colors <- c("#FF5733", "#33FF57", "#3366FF", "#FF33A8", "#FFFF33", "#33FFFF",  "#808080", "#A52A2A")
# filt_data_shltyls <- subset(camps, as.numeric(N_INDVI)<500)
# Set the alpha value for all points
alpha_value <- 0.2
# Scatter plot with different colors based on Shelter_type
shlt_typ_wp_uc<-ggplot(camps, aes(y = as.numeric(wp_uc), x = as.numeric(N_INDVI), color = Shlt_ty)) +
  geom_point(alpha = alpha_value) +
  labs(title = "Comparison between ghsl and N_INDVI",
       y = "Estimated WorldPop unconstrained population",
       x = "Surveyed Population") +
  scale_color_manual(values = custom_colors) +  # Set custom colors
   # scale_y_continuous(breaks = seq(0, 2500, by = 500)) +
   # # scale_x_continuous(breaks = seq(0,2500 , by = 500))  # Adjust y-axis intervals
  theme_minimal()
print(shlt_typ_wp_uc)
```




#10.(SETTLEMENT CLASS) Settlement class wise plot for calc vs estimated plot

```{r}
# Define custom colors for Shelter_type
custom_colors <- c( "#A52A2A","#33FFFF",  "#FF33A8")
# filt_data_shltyls <- subset(camps, as.numeric(N_INDVI)<500)
# Set the alpha value for all points
alpha_value <- 0.5
# Scatter plot with different colors based on Shelter_type
sl_cls_wp_uc<-ggplot(camps, aes(y = as.numeric(wp_uc), x = as.numeric(N_INDVI), color = St_clss)) +
  geom_point(alpha = alpha_value) +
  labs(title = "Comparison between ghsl and N_INDVI",
       y = "Estimated WorldPop unconstrained population",
       x = "Surveyed Population") +
  scale_color_manual(values = custom_colors) +  # Set custom colors
   # scale_y_continuous(breaks = seq(0, 2500, by = 500)) +
   # # scale_x_continuous(breaks = seq(0,2500 , by = 500))  # Adjust y-axis intervals
  theme_minimal()
print(sl_cls_wp_uc)

```



#11.(N_HHvsN_INDVI)The plots with Number of Households and survey population +ghsl population


```{r}
# Scatter plot comparing N_INDIVID and N_HH
N_ind_HH <- ggplot(camps, aes(x = as.numeric(N_INDVI), y = as.numeric(N_HH), color = Sit_Stt)) +
  geom_point() +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between IOM survey population and Survey Houshold numbers",
       x = "Iom Survey population",
       y = "Households") +
  theme(plot.title = element_text(size = 3, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3, hjust = 0.5),
        axis.title.y = element_text(size = 3, hjust = 0.5),
        axis.text.x = element_text(size = 2),
        axis.text.y = element_text(size = 2)) +
  theme_minimal()

# Scatter plot comparing N_HH and wp_uc
WP_uc_N_HH <- ggplot(camps, aes(y = as.numeric(N_HH), x = as.numeric(wp_uc), color = Sit_Stt)) +
  geom_point() +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between Household survey and Estimated Worldpop unconstrained Population",
       y = "Households",
       x = "Estimated WP_unconstrained Population") +

  theme(plot.title = element_text(size = 3, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3, hjust = 0.5),
        axis.title.y = element_text(size = 3, hjust = 0.5),
        axis.text.x = element_text(size = 2),
        axis.text.y = element_text(size = 2)) +
  theme_minimal()

# Arrange the plots in a grid
hh_wp_uc<-grid.arrange(N_ind_HH, WP_uc_N_HH , ncol = 1)
```
#12.Number of households and GHSL population only

```{r}

# Scatter plot comparing N_HH and wp_uc
WP_uc_N_HH <- ggplot(camps, aes(y = as.numeric(N_HH), x = as.numeric(wp_uc), color = Sit_Stt)) +
  geom_point() +
  labs(title = "Comparison between Household survey and Estimated GHSL Population",
       y = "Households",
       x = "Estimated WP_unconstrained Population") +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +

  theme(plot.title = element_text(size = 3, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3, hjust = 0.5),
        axis.title.y = element_text(size = 3, hjust = 0.5),
        axis.text.x = element_text(size = 2),
        axis.text.y = element_text(size = 2)) +
  theme_minimal()

print(WP_uc_N_HH)
```

#ALL WORLDPOP CO PLOT SAVE

```{r}
# Save the plot to a file
#1.survey +estimated scatterplot
ggsave("Plots/wp_uc_sc_surv.png", plot =wp_uc_sc_surv, width = 8, height = 6, dpi = 400)

#2.Informal camp subset survey+estimated
ggsave("Plots/inf_plot_wp_uc.png", plot =inf_plot_wp_uc, width = 8, height = 6, dpi = 400)
#3.Formal camp subset survey +estimated
ggsave("Plots/for_plot_wp_uc.png", plot =for_plot_wp_uc, width = 8, height = 6, dpi = 400)
#4.Informal camp filtered for population<5000
ggsave("Plots/info_fil_wp_uc.png", plot =info_fil_wp_uc, width = 8, height = 6, dpi = 400)
#5.Areawise subsetted(>10000 sqmts) calc vs estimated plot for formal and informal
ggsave("Plots/wp_uc_surv_a.png", plot =wp_uc_surv_a, width = 8, height = 6, dpi = 400)

#6.Areawise subsetted(<10000 sqmts) calc vs estimated plot for formal and informal
ggsave("Plots/wp_uc_surv_als.png", plot =wp_uc_surv_als, width = 8, height = 6, dpi = 400)

#7.Populationwise subsetted(>10000 ) calc vs estimated plot for formal and informal
ggsave("Plots/wp_uc_surv_greater.png", plot =wp_uc_surv_greater, width = 8, height = 6, dpi = 400)

#8.Populationwise subsetted(<10000 ) calc vs estimated plot for formal and informal
ggsave("Plots/wp_uc_surv_lesser.png", plot =wp_uc_surv_lesser, width = 8, height = 6, dpi = 400)

#9.Populationwise subsetted(<500) calc vs estimated plot for formal and informal
ggsave("Plots/wp_uc_surv_ls500.png", plot =wp_uc_surv_ls500, width = 8, height = 6, dpi = 400)

#10. Shelter type wise calc vs estimated plot 
ggsave("Plots/shlt_typ_wp_uc.png", plot =shlt_typ_wp_uc, width = 8, height = 6, dpi = 400)

#11.Settlement class wise calc vs estimated plot
ggsave("Plots/sl_cls_wp_uc.png", plot=ghsl_st_cl,width = 8, height = 6, dpi = 400)

#12. Houslhold survey number vs surveyed population and estimated population plot
ggsave("Plots/hh_wp_uc.png", plot =hh_wp_uc, width = 8, height = 6, dpi = 400)

#13. Household number vs estimated population
ggsave("Plots/WP_uc_N_HH.png", plot =WP_uc_N_HH, width = 8, height = 6, dpi = 400)
```


#___WORLD_POP_UC END________________________
#____________________________________________
#A.Correlation between houshold and population(both survey and estimated WP_UC)

```{r}
# Convert numeric variables from character to numeric
# Convert numeric variables from character to numeric
camps$N_INDVI <- as.numeric(camps$N_INDVI)
camps$N_HH <- as.numeric(camps$N_HH)
camps$wp_uc <- as.numeric(camps$wp_uc)


# Check the data types again
str(camps[, c("N_INDVI", "wp_uc", "N_HH")])

# Check for missing values
summary(camps[, c("N_INDVI", "wp_uc", "N_HH")])

# CalculateH correlation coefficients
corr_wp_uc_HH<- cor(camps$N_HH,camps$wp_uc)
corr_ind_HH<-cor(camps$N_INDVI,camps$N_HH)

# View correlation coefficients
print(corr_wp_uc_HH)
print(corr_ind_HH)

# [1] 0.6188335
# [1] 0.9409748

```


#B.Find about the difference in  statistics which will help in understanding the change in population of the camps from that of the estimated population 
```{r}
wp_uc_dff_stats<-summary(as.numeric(camps$wp_uc_df))
print(wp_uc_dff_stats)

```

#C.Absolute diff/percentage diff/RMSE/mean absolute percentage error

```{r}
# Convert variables to numeric if necessary
camps$wp_uc <- as.numeric(camps$wp_uc)
camps$N_INDVI <- as.numeric(camps$N_INDVI)

# Calculate absolute difference
absolute_difference_wp_uc<- abs(camps$wp_uc - camps$N_INDVI)

# Calculate percentage difference
percentage_difference_wp_uc <- abs((camps$wp_uc - camps$N_INDVI) / camps$N_INDVI) * 100

# Calculate root mean square error (RMSE)
rmse_wp_uc<- sqrt(mean((camps$wp_uc - camps$N_INDVI)^2))

# Calculate mean absolute percentage error (MAPE)
mape_uc <- mean(percentage_difference, na.rm = TRUE)

# Calculate absolute error
absolute_error_wp_uc <- mean(abs(as.numeric(camps$wp_uc) - as.numeric(camps$N_INDVI)))

# Print the result
print(absolute_error_wp_uc)

# Calculate percentage error
percentage_error_wp_uc <- mean(abs(as.numeric(camps$wp_uc) - as.numeric(camps$N_INDVI)) / as.numeric(camps$N_INDVI)) * 100

# Print the result
print(percentage_error_wp_uc)

# Print results
cat("Absolute Difference:", mean(absolute_difference_wp_uc), "\n")
cat("Percentage Difference:", mean(percentage_difference_wp_uc), "%\n")
cat("RMSE:", rmse_wp_uc, "\n")
cat("MAPE:", mape_uc, "%\n")
cat("Absolute error:",absolute_error_wp_uc,"\n")
cat("Percentage error:",percentage_error_wp_uc)

```
#____________________________________________
#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
#_______________________________________________
#3.World POP(constrained)
#_______________________________________________
```{r}
World_pop_constr <- rast('D:/EAGLE/Master_Thesis_Hannes/1/world_pop_build/nga_ppp_2020_constrained.tif')
print(World_pop_constr)

```

```{r}
# Call function

camps <- extract_sum(World_pop_constr,camps,"Name")

```

#Difference in the survery_population and world_pop  constrained
```{r}


# Subtract N_INDVID from ras_name
camps$wp_c_df <- camps$N_INDVI - camps$wp_c

# View the resulting data frame with the new "difference" column
print(camps)
```

#%%%%%%%%%WORDPOP CONST END%%%%%%%%%%
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

#_____WORLDPOP C PLOTS________________

  #1.(ESTI_SUR)worldpop unconstrained Estimated and Iom survey population
```{r}
# Scatter plot with site_status
wp_c_surv<-ggplot(camps, aes(x = wp_c, y = N_INDVI, color = Sit_Stt)) +

  geom_jitter(aes(x = (as.numeric(N_INDVI)),y = as.numeric(wp_c)), size = 0.6, alpha = 0.8,show.legend = TRUE)+geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) + 
  labs(title = "Comparison between estimated WorldPop(constrained) and survey Iom populations",
       y = "Estimated population (Worldpop(constrained))",
       x = "Iom surveyed population") +
  theme_minimal()
print(wp_c_surv)
corr_wp_c<-cor(camps$N_INDVI,camps$wp_c)
print(corr_wp_c)
```


#2.(Informal)Subset the informal camps and plot the estimate  vs calc

```{r}

# 1. Subset the informal camps
informal_camps <- camps %>% filter(Sit_Stt == "Informal")

# 2. Extract relevant columns
data_plot <- informal_camps %>%
  select(wp_c, N_INDVI)

# 3. Plot with ggplot2
inf_plot_wp_c<-ggplot(data_plot, aes(y = wp_c, x = N_INDVI)) +geom_smooth(method = "lm", se = FALSE) +
  #geom_point() +
  geom_jitter(aes(x = (as.numeric(N_INDVI)),y = as.numeric(wp_c)), size = 0.6, alpha = 0.8,show.legend = TRUE)+geom_smooth(method = "lm", se = FALSE) + 
  labs(title = "World Pop (Constrained) vs Surveyed Population for Informal Camps",
  y = "World Pop (Unconstrained)Estimated Population", x = "Surveyed Population (N_INDVI)" )

print(inf_plot_wp_c)

corr_wp_c_inf<-cor(as.numeric(informal_camps$N_INDVI),as.numeric(informal_camps$wp_c))
print(corr_wp_c_inf)

#correlation result
#[1] 0.4915582
```



#3.(Formal)Subset the Formal camps and plot the estimate  vs calc
```{r}

# 1. Subset the informal camps
formal_camps <- camps %>% filter(Sit_Stt == "Formal")

# 2. Extract relevant columns
data_plot <- formal_camps %>%
  select(wp_c, N_INDVI)

# 3. Plot with ggplot2
for_plot_wp_c<-ggplot(data_plot, aes(y = wp_c, x = N_INDVI)) +
  geom_jitter(aes(x = (as.numeric(N_INDVI)),y = as.numeric(wp_c)), size = 0.6, alpha = 0.8,show.legend = TRUE)+geom_smooth(method = "lm",  se = FALSE) +
  #geom_point() +
  labs(y = "World Pop (Unconstrained)estimated Population", x = "Surveyed Population (N_INDVI)",
       title = "World Pop (Unconstrained) vs Surveyed Population for formal Camps")
print(for_plot_wp_c)

corr_wp_c_f<-cor(as.numeric(formal_camps$N_INDVI),as.numeric(formal_camps$wp_c))
print(corr_wp_c_f)


#correlation result
#[1] 0.584717
```


#4.(Informal_<5000)filtering the surveyed population less then 5000 for informal and plotting the calc vs estimated


```{r}
# 1. Subset the informal camps with surveyed population less than 5000
informal_camps_filtered <- camps %>%
  filter(Sit_Stt == "Informal" & N_INDVI < 5000)

# 2. Extract relevant columns
data_plot <- informal_camps_filtered %>%
  select(wp_c, N_INDVI)

# 3. Plot with ggplot2
info_fil_wp_c<-ggplot(data_plot, aes(x = N_INDVI, y = wp_c)) +geom_smooth(method = "lm",  se = FALSE)  + 
  geom_jitter(aes(x = (as.numeric(N_INDVI)),y = as.numeric(wp_c)), size = 0.6, alpha = 0.8,show.legend = TRUE)+
  #geom_point() +
  labs(x = "Surveyed Population (N_INDVI)", y = "World Pop (constrained) Estimated Population",
       title = "Surveyed vs Estimated Population for Informal Camps") 
 
print(info_fil_wp_c)
corr_wp_c_inf_ls5<-cor(as.numeric(informal_camps_filtered$N_INDVI),as.numeric(informal_camps_filtered$wp_c))
print(corr_wp_c_inf_ls5)

#correlation result
#[1]  0.19632393
```


# 5.(Area_wise>10000)now considering the area wise plots for area only camps having area greater than 10000 square meter area

```{r}
# Scatter plot with site_status
wp_c_surv_a<-ggplot(subset_data, aes(y = wp_c, x = N_INDVI, color = Sit_Stt)) +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(wp_c)),size = 0.6, alpha = 0.8,show.legend = TRUE)+
  
  labs(title = "Comparison between estimated and survey iom populations for area greater then 10000 sq mts",
       y = "Estimated World Pop constrained population",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(wp_c_surv_a)
  
corr_wp_c_ath<-cor(as.numeric(subset_data$N_INDVI),as.numeric(subset_data$wp_c))
print(corr_wp_c_ath)

#correlation result
#[1] 0.5065452
  
```



# 6.(Area_wise<10000)now considering the area wise plots for area only camps having area less than 10000 square meter area

```{r}
# Scatter plot with site_status
wp_c_surv_als<-ggplot(subset_data_2, aes(y = wp_c, x = N_INDVI, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(wp_c)),size = 0.6, alpha = 0.8,show.legend = TRUE)+geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  # geom_text(aes(x = as.numeric(N_INDVI), y = as.numeric(ghsl)), size = 1, vjust = -0.5, hjust = -0.5)+
  labs(title = "Comparison between estimated and survey iom populations for area less then 10000 sq mts",
       y = "Estimated Worldpop(Constrained) population",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(wp_c_surv_als)
  
corr_wp_c_als<-cor(as.numeric(subset_data_2$N_INDVI),as.numeric(subset_data_2$wp_c))
print(corr_wp_c_als)

#correlation result
#[1] 0.1276143
```



# splitting the population estimates for <10000 and > 10000
#7.(POPwise<10000&>10000) to see the sitesname for less than and greateer than 10000
```{r}
campsgt10000 <- subset(camps, N_INDVI > 10000)
campls10000 <- subset(camps, N_INDVI < 10000)
# Scatter plot with site_status for N_INDVI greater than 10,000
wp_c_surv_greater <- ggplot(subset(camps, as.numeric(N_INDVI) > 10000), aes(y = wp_c, x = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_c)), size = 0.6, alpha = 0.4, show.legend = TRUE) +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between estimated and survey IOM populations",
       y = "Estimated population Worldpop(constrained)",
       x = "Iom surveyed population (N_INDVI > 10,000)") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(0, 40000, by = 5000))  # Adjust y-axis intervals

# Scatter plot with site_status for N_INDVI less than or equal to 10,000
wp_c_surv_lesser <- ggplot(subset(camps, as.numeric(N_INDVI) <= 10000), aes(y = wp_c, x = N_INDVI, color = Sit_Stt)) +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_c)), size = 0.6, alpha = 0.4, show.legend = TRUE) +
  labs(title = "Comparison between estimated and survey iom populations",
       y = "Estimated population(World pop constrained)",
       x = "Iom surveyed population (N_INDVI <= 10,000)") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(0, 10000, by = 1000))  # Adjust y-axis intervals

# Print the plots
print(wp_c_surv_greater)
print(wp_c_surv_lesser)


cor_wp_c_gt10000<-cor(campsgt10000 $N_INDVI,campsgt10000$wp_c)
print('population greater than10000')
print(cor_wp_c_gt10000)
cor_wp_c_ls10000<-cor(campls10000 $N_INDVI,campls10000$wp_c )
print('population less than10000')
print(cor_wp_c_ls10000)
```


#8.(POP<500)splitting the population less than 500
```{r}
wp_c_surv_ls500 <- ggplot(subset(camps, as.numeric(N_INDVI) < 500), aes(y = wp_c, x = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_c)), size = 0.6, alpha = 0.4, show.legend = TRUE) +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between estimated and survey IOM populations",
       y = "Estimated population (Wp_c)",
       x = "IOM surveyed population (N_INDVI < 500)") +
  theme_minimal() 
  # scale_y_continuous(breaks = seq(0, 550, by = 100))+scale_x_continuous(breaks = seq(0, 550, by = 100))  # Adjust y-axis intervals

#print plots'
print(wp_c_surv_ls500)
#correlation
cor_wp_c_ls500<-cor(ghsl_ls_500 $N_INDVI,ghsl_ls_500$wp_c )
print(cor_wp_c_ls500)
```


#9.(SHELTER TYPE) Plot between calc vs surveyed pop arranged according to the shelter type

```{r}
# Define custom colors for Shelter_type
custom_colors <- c("#FF5733", "#33FF57", "#3366FF", "#FF33A8", "#FFFF33", "#33FFFF",  "#808080", "#A52A2A")
# filt_data_shltyls <- subset(camps, as.numeric(N_INDVI)<500)
# Set the alpha value for all points
alpha_value <- 0.2
# Scatter plot with different colors based on Shelter_type
shlt_typ_wp_c<-ggplot(camps, aes(y = as.numeric(wp_c), x = as.numeric(N_INDVI), color = Shlt_ty)) +
  geom_point(alpha = alpha_value) +
  labs(title = "Comparison between ghsl and N_INDVI",
       y = "Estimated WorldPop constrained population",
       x = "Surveyed Population") +
  scale_color_manual(values = custom_colors) +  # Set custom colors
   # scale_y_continuous(breaks = seq(0, 2500, by = 500)) +
   # # scale_x_continuous(breaks = seq(0,2500 , by = 500))  # Adjust y-axis intervals
  theme_minimal()
print(shlt_typ_wp_c)
```


#10.(SETTLEMENT CLASS) Settlement class wise plot for calc vs estimated plot

```{r}
# Define custom colors for Shelter_type
custom_colors <- c( "#A52A2A","#33FFFF",  "#FF33A8")
# filt_data_shltyls <- subset(camps, as.numeric(N_INDVI)<500)
# Set the alpha value for all points
alpha_value <- 0.5
# Scatter plot with different colors based on Shelter_type
sl_cls_wp_c<-ggplot(camps, aes(x = as.numeric(wp_c), y = as.numeric(N_INDVI), color = St_clss)) +
  geom_point(alpha = alpha_value) +
  labs(title = "Comparison between ghsl and N_INDVI",
       x = "Estimated WorldPop constrained population",
       y = "Surveyed Population") +
  scale_color_manual(values = custom_colors) +  # Set custom colors
   # scale_y_continuous(breaks = seq(0, 2500, by = 500)) +
   # # scale_x_continuous(breaks = seq(0,2500 , by = 500))  # Adjust y-axis intervals
  theme_minimal()
print(sl_cls_wp_c)

```

#11.(N_HHvsN_INDVI)The plots with Number of Households and survey population +wp_c population
```{r}
# Scatter plot comparing N_INDIVID and N_HH
N_ind_HH <- ggplot(camps, aes(x = as.numeric(N_INDVI), y = as.numeric(N_HH), color = Sit_Stt)) +
  geom_point() +
  labs(title = "Comparison between IOM survey population and Survey Houshold numbers",
       x = "Iom Survey population",
       y = "Households") +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  theme(plot.title = element_text(size = 3, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3, hjust = 0.5),
        axis.title.y = element_text(size = 3, hjust = 0.5),
        axis.text.x = element_text(size = 2),
        axis.text.y = element_text(size = 2)) +
  theme_minimal()

# Scatter plot comparing N_HH and ghsl
WP_c_N_HH <- ggplot(camps, aes(y = as.numeric(N_HH), x = as.numeric(wp_c), color = Sit_Stt)) +
  geom_point() +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between Household survey and Estimated worldpop constrained Population",
       y = "Households",
       x= "Estimated Worldpop const Population") +
  
  theme(plot.title = element_text(size = 3, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3, hjust = 0.5),
        axis.title.y = element_text(size = 3, hjust = 0.5),
        axis.text.x = element_text(size = 2),
        axis.text.y = element_text(size = 2)) +
  theme_minimal()

# Arrange the plots in a grid
hh_wp_c<-grid.arrange(N_ind_HH, WP_c_N_HH , ncol = 1)
```

#12.Number of households and GHSL population only
```{r}

# Scatter plot comparing N_HH and ghsl
WP_c_N_HH <- ggplot(camps, aes(y = as.numeric(N_HH), x = as.numeric(wp_c), color = Sit_Stt)) +
  geom_point() +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between Household survey and Estimated worldpop constrained Population",
       y = "Households",
       x= "Estimated Worldpop const Population") +
  
  theme(plot.title = element_text(size = 3, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3, hjust = 0.5),
        axis.title.y = element_text(size = 3, hjust = 0.5),
        axis.text.x = element_text(size = 2),
        axis.text.y = element_text(size = 2)) +
  theme_minimal()

print(WP_c_N_HH )
```




#ALL WORLDPOP CO PLOT SAVE

```{r}
#1.survey +estimated scatterplot
ggsave("Plots/wp_c_surv_scat.png", plot =wp_c_surv, width = 8, height = 6, dpi = 400)

#2.Informal camp subset survey+estimated
ggsave("Plots/inf_plot_wp_c.png", plot =inf_plot_wp_c, width = 8, height = 6, dpi = 400)

#3.Formal camp subset survey +estimated
ggsave("Plots/for_plot_wp_c.png", plot =for_plot_wp_c, width = 8, height = 6, dpi = 400)

#4.Informal camp filtered for population<5000
ggsave("Plots/info_fil_wp_c.png", plot =info_fil_wp_c, width = 8, height = 6, dpi = 400)

#5.Areawise subsetted(>10000 sqmts) calc vs estimated plot for formal and informal
ggsave("Plots/wp_c_surv_a.png", plot =wp_c_surv_a, width = 8, height = 6, dpi = 400)

#6.Areawise subsetted(<10000 sqmts) calc vs estimated plot for formal and informal
ggsave("Plots/wp_c_surv_als.png", plot =wp_c_surv_als, width = 8, height = 6, dpi = 400)


#7.Populationwise subsetted(>10000 ) calc vs estimated plot for formal and informal
ggsave("Plots/wp_c_surv_greater.png", plot =wp_c_surv_greater, width = 8, height = 6, dpi = 400)

#8.Populationwise subsetted(<10000 ) calc vs estimated plot for formal and informal
ggsave("Plots/wp_c_surv_lesser.png", plot =wp_c_surv_lesser, width = 8, height = 6, dpi = 400)

#9.Populationwise subsetted(<500 ) calc vs estimated plot for formal and informal
ggsave("Plots/wp_c_surv_ls500.png", plot =wp_c_surv_ls500, width = 8, height = 6, dpi = 400)

#10. Shelter type wise calc vs estimated plot
ggsave("Plots/shlt_typ_wp_c.png", plot =shlt_typ_wp_c, width = 8, height = 6, dpi = 400)

#11.Settlement class wise calc vs estimated plot
ggsave("Plots/sl_cls_wp_c.png", plot =sl_cls_wp_c, width = 8, height = 6, dpi = 400)

#12. Houslhold survey number vs surveyed population and estimated population plot
ggsave("Plots/hh_wp_c.png", plot =hh_wp_c, width = 8, height = 6, dpi = 400)

#13. Household number vs estimated population
ggsave("Plots/WP_c_N_HH .png", plot =WP_c_N_HH , width = 8, height = 6, dpi = 400)

```



#___WORLD_POP_UC END________________________
#____________________________________________
#A.Correlation between houshold and population(both survey and estimated WP_UC)



```{r}
# Convert numeric variables from character to numeric
# Convert numeric variables from character to numeric
camps$N_INDVI <- as.numeric(camps$N_INDVI)
camps$N_HH <- as.numeric(camps$N_HH)
camps$wp_c <- as.numeric(camps$wp_c)


# Check the data types again
str(camps[, c("N_INDVI", "wp_c", "N_HH")])

# Check for missing values
summary(camps[, c("N_INDVI", "wp_c", "N_HH")])

# CalculateH correlation coefficients
corr_wp_c_HH<- cor(camps$N_HH,camps$wp_c)
corr_ind_HH<-cor(camps$N_INDVI,camps$N_HH)

# View correlation coefficients
print(corr_wp_c_HH)
print(corr_ind_HH)

#results
# [1] 0.5242888
# [1] 0.9409748
```



#B.Find about the difference in  statistics which will help in understanding the change in population of the camps from that of the estimated population 
```{r}
wp_c_dff_stats<-summary(as.numeric(camps$wp_c_df))
print(wp_c_dff_stats)

```

#C.absolute diff/percentage diff/RMSE/mean absolute percentage error

```{r}
# Convert variables to numeric if necessary
camps$wp_c <- as.numeric(camps$wp_c)
camps$N_INDVI <- as.numeric(camps$N_INDVI)

# Calculate absolute difference
absolute_difference_wp_c <- abs(camps$wp_c - camps$N_INDVI)

# Calculate percentage difference
percentage_difference_wp_c <- abs((camps$wp_c - camps$N_INDVI) / camps$N_INDVI) * 100

# Calculate root mean square error (RMSE)
rmse_wp_c <- sqrt(mean((camps$wp_c - camps$N_INDVI)^2))

# Calculate mean absolute percentage error (MAPE)
mape_wp_c <- mean(percentage_difference_wp_c, na.rm = TRUE)

# Calculate absolute error
absolute_error_wp_c <- mean(abs(as.numeric(camps$wp_c) - as.numeric(camps$N_INDVI)))

# Print the result
print(absolute_error_wp_c)

# Calculate percentage error
percentage_error_wp_c <- mean(abs(as.numeric(camps$wp_c) - as.numeric(camps$N_INDVI)) / as.numeric(camps$N_INDVI)) * 100

# Print the result
print(percentage_error_wp_c)

# Print results
cat("Absolute Difference:", mean(absolute_difference_wp_c), "\n")
cat("Percentage Difference:", mean(percentage_difference_wp_c), "%\n")
cat("RMSE:", rmse_wp_c, "\n")
cat("MAPE:", mape_wp_c, "%\n")
cat("Absolute error:",absolute_error_wp_c,"\n")
cat("Percentage error:",percentage_error_wp_c)

```

#Analysis 
A percentage difference of 92.51982% signifies that, on average, the estimated population is 92.51982% higher than the surveyed population across the 223 sites. In other words, the estimated population is, on average, nearly twice as high as the surveyed population. This indicates a substantial overestimation in the estimated population compared to the surveyed population.


#____________________________________________
#$$$$$$$$$$$$$$$$#%%%%WORLDPOP C PLOTS END %%%%%%%%%%%%%%%%%%%%%%%%%%%$$$$$$$$$$$$$$$$$$$$$$$$$$
#_______________________________________________
##4. GPW_V4 normal
#_______________________________________________


```{r}

gpw <- rast('D:/EAGLE/Master_Thesis_Hannes/1/gpw/gpw-v4-population-count-rev11_2020_30_sec_tif/gpw_v4_population_count_rev11_2020_30_sec.tif')
print(gpw)
```


```{r}
# Call function

polygon_camps <- extract_sum(gpw,camps,"Name")
```

#Difference in the survery_population and gpw_population
```{r}
# Assuming you have a column named "N_INDVID" in the polygon_camps data frame
# Adjust the column name if needed

# Subtract N_INDVID from ras_name
camps$gpwu_dff <- camps$N_INDVI - camps$gpw

# View the resulting data frame with the new "difference" column
print(camps)
```



#_______GPW_UN_V4 PLOTS____________

#1.(ESTI_SUR)GPWUN estimated and Iom survey population


```{r}
# Scatter plot with site_status
gpw_surv_scat<-ggplot(camps, aes(y = gpw, x = N_INDVI, color = Sit_Stt)) +

  geom_jitter(aes(x = (as.numeric(N_INDVI)),y = as.numeric(gpw)), size = 0.6, alpha = 0.8,show.legend = TRUE)+geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between estimated and survey iom populations",
       x = "Estimated population(GPW V4)",
       y = "Iom surveyed population") +
  theme_minimal()
print(gpw_surv_scat)
corr_gpw<-cor(camps$N_INDVI,camps$gpw)
print(corr_gpw)

```


#2.(Informal)Subset the informal camps and plot the estimate  vs calc

```{r}

# 1. Subset the informal camps
informal_camps <- camps %>% filter(Sit_Stt == "Informal")

# 2. Extract relevant columns
data_plot <- informal_camps %>%
  select(gpw, N_INDVI)

# 3. Plot with ggplot2
inf_plot_gpw<-ggplot(data_plot, aes(y = gpw, x = N_INDVI)) +geom_smooth(method = "lm", se = FALSE) +geom_smooth(method = "lm", se = FALSE) +
  #geom_point() +
  geom_jitter(aes(x = (as.numeric(N_INDVI)),y = as.numeric(gpw)), size = 0.6, alpha = 0.8,show.legend = TRUE)+
  labs(title = "GPW vs Surveyed Population for Informal Camps",
  y = "GPW estimated Population", x = "Surveyed Population (N_INDVI)" )

print(inf_plot_gpw)

corr_gpw_inf<-cor(as.numeric(informal_camps$N_INDVI),as.numeric(informal_camps$gpw))
print(corr_gpw_inf)

#correlation result
#[1] 0.4915582
```



#3.(Formal)Subset the Formal camps and plot the estimate  vs calc
```{r}

# 1. Subset the informal camps
formal_camps <- camps %>% filter(Sit_Stt == "Formal")

# 2. Extract relevant columns
data_plot_gpw <- formal_camps %>%
  select(gpw, N_INDVI)

# 3. Plot with ggplot2
for_plot_gpw<-ggplot(data_plot_gpw, aes(y = gpw, x = N_INDVI)) +geom_smooth(method = "lm", se = FALSE) +
  geom_jitter(aes(x = (as.numeric(N_INDVI)),y = as.numeric(gpw)), size = 0.6, alpha = 0.8,show.legend = TRUE)+
  #geom_point() +
  labs(y = "GPW Estimated Population", x = "Surveyed Population (N_INDVI)",
       title = "GPW vs Surveyed Population for formal Camps")
print(for_plot_gpw)

corr_gpw_f<-cor(as.numeric(formal_camps$N_INDVI),as.numeric(formal_camps$gpw))
print(corr_gpw_f)


#correlation result
#[1]0.2008553
```


#4.(Informal_<5000)filtering the surveyed population less then 5000 for informal and plotting the calc vs estimated


```{r}
# 1. Subset the informal camps with surveyed population less than 5000
informal_camps_filtered <- camps %>%
  filter(Sit_Stt == "Informal" & N_INDVI < 5000)

# 2. Extract relevant columns
data_plot_gpw <- informal_camps_filtered %>%
  select(gpw, N_INDVI)

# 3. Plot with ggplot2
info_fil_gpw<-ggplot(data_plot, aes(x = N_INDVI, y = gpw)) +geom_smooth(method = "lm", se = FALSE) +
  geom_jitter(aes(x = (as.numeric(N_INDVI)),y = as.numeric(gpw)), size = 0.6, alpha = 0.8,show.legend = TRUE)+
  #geom_point() +
  labs(x = "Surveyed Population (N_INDVI)", y = "GPW estimated Population",
       title = "Surveyed vs Estimated Population for Informal Camps") 
 
print(info_fil_gpw)
corr_gpw_inf_ls5<-cor(as.numeric(informal_camps_filtered$N_INDVI),as.numeric(informal_camps_filtered$gpw))
print(corr_gpw_inf_ls5)

#correlation result
#[1]0.01338329
```

# 5.(Area_wise>10000)now considering the area wise plots for area only camps having area greater than 10000 square meter area

```{r}
# Scatter plot with site_status
gpw_surv_a<-ggplot(subset_data, aes(y = gpw, x = N_INDVI, color = Sit_Stt)) +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(gpw)),size = 0.6, alpha = 0.8,show.legend = TRUE)+
  
  labs(title = "Comparison between estimated and survey IOM populations for area greater then 10000 sq mts",
       y = "Estimated GPW population",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(gpw_surv_a)
  
corr_gpw_ath<-cor(as.numeric(subset_data$N_INDVI),as.numeric(subset_data$gpw))
print(corr_gpw_ath)

#correlation result
#[1] 0.1122278
  
```



# 6.(Area_wise<10000)now considering the area wise plots for area only camps having area less than 10000 square meter area

```{r}
# Scatter plot with site_status
gpw_surv_als<-ggplot(subset_data_2, aes(y = gpw, x = N_INDVI, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(gpw)),size = 0.6, alpha = 0.8,show.legend = TRUE)+geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  # geom_text(aes(x = as.numeric(N_INDVI), y = as.numeric(ghsl)), size = 1, vjust = -0.5, hjust = -0.5)+
  labs(title = "Comparison between estimated and survey iom populations for area less then 10000 sq mts",
       y = "Estimated GPW population",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(gpw_surv_als)
  
corr_gpw_als<-cor(as.numeric(subset_data_2$N_INDVI),as.numeric(subset_data_2$gpw))
print(corr_gpw_als)

#correlation result
#[1] 0.05922067
```











# splitting the population estimates for <10000 and > 10000

#7.(POPwise<10000&>10000) to see the sitesname for less than and greateer than 10000
```{r}
campsgt10000 <- subset(camps, N_INDVI > 10000)
campls10000 <- subset(camps, N_INDVI < 10000)
# Scatter plot with site_status for N_INDVI greater than 10,000
gpw_surv_greater <- ggplot(subset(camps, as.numeric(N_INDVI) > 10000), aes(y = gpw, x = N_INDVI, color = Sit_Stt)) +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(gpw)), size = 0.6, alpha = 0.4, show.legend = TRUE) +
  labs(title = "Comparison between estimated and survey iom populations",
       y = "Estimated population (GPW-V4)",
       x = "Iom surveyed population (N_INDVI > 10,000)") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(0, 40000, by = 5000))  # Adjust y-axis intervals

# Scatter plot with site_status for N_INDVI less than or equal to 10,000
gpw_surv_lesser <- ggplot(subset(camps, as.numeric(N_INDVI) <= 10000), aes(y = gpw, x = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(gpw)), size = 0.6, alpha = 0.4, show.legend = TRUE) +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between estimated and survey IOM populations",
       y = "Estimated population(GPW-V4)",
       x = "Iom surveyed population (N_INDVI <= 10,000)") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(0, 10000, by = 1000))  # Adjust y-axis intervals

# Print the plots
print(gpw_surv_greater)
print(gpw_surv_lesser)
cor_gpw_gt10000<-cor(campsgt10000 $N_INDVI,campsgt10000$gpw)
print('population greater than10000')
print(cor_gpw_gt10000)
cor_gpw_ls10000<-cor(campls10000 $N_INDVI,campls10000$gpw )
print('population less than10000')
print(cor_gpw_ls10000)
```

#8.(POP<500)splitting the population less than 500
```{r}
ghsl_ls_500<-subset(camps, N_INDVI<500)
gpw_surv_ls500 <- ggplot(subset(camps, as.numeric(N_INDVI) < 500), aes(y = gpw, x = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(gpw)), size = 0.6, alpha = 0.4, show.legend = TRUE) +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between estimated and survey IOM populations",
       y = "Estimated population (gpw)",
       x = "IOM surveyed population (N_INDVI < 500)") +
  theme_minimal() 
  # scale_y_continuous(breaks = seq(0, 550, by = 100))+scale_x_continuous(breaks = seq(0, 550, by = 100))  # Adjust y-axis intervals

#print plots'
print(gpw_surv_ls500)
#correlation
cor_gpw_ls500<-cor(ghsl_ls_500 $N_INDVI,ghsl_ls_500$gpw )
print(cor_gpw_ls500)
```

#9.(SHELTER TYPE) Plot between calc vs surveyed pop arranged according to the shelter type

```{r}
# Define custom colors for Shelter_type
custom_colors <- c("#FF5733", "#33FF57", "#3366FF", "#FF33A8", "#FFFF33", "#33FFFF",  "#808080", "#A52A2A")
# filt_data_shltyls <- subset(camps, as.numeric(N_INDVI)<500)
# Set the alpha value for all points
alpha_value <- 0.2
# Scatter plot with different colors based on Shelter_type
shlt_typ_gpw<-ggplot(camps, aes(y = as.numeric(gpw), x = as.numeric(N_INDVI), color = Shlt_ty)) +
  geom_point(alpha = alpha_value) +
  labs(title = "Comparison between GPW and N_INDVI",
       y= "Estimated GPW population",
       x = "Surveyed Population") +
  scale_color_manual(values = custom_colors) +  # Set custom colors
   # scale_y_continuous(breaks = seq(0, 2500, by = 500)) +
   # # scale_x_continuous(breaks = seq(0,2500 , by = 500))  # Adjust y-axis intervals
  theme_minimal()
print(shlt_typ_gpw)
```

#10.(SETTLEMENT CLASS) Settlement class wise plot for calc vs estimated plot


```{r}
# Define custom colors for Shelter_type
custom_colors <- c( "#A52A2A","#33FFFF",  "#FF33A8")
# filt_data_shltyls <- subset(camps, as.numeric(N_INDVI)<500)
# Set the alpha value for all points
alpha_value <- 0.5
# Scatter plot with different colors based on Shelter_type
sl_cls_gpw<-ggplot(camps, aes(y = as.numeric(gpw), x = as.numeric(N_INDVI), color = St_clss)) +
  geom_point(alpha = alpha_value) +
  labs(title = "Comparison between GPW-V4 and N_INDVI with Shelter type",
       y = "Estimated GPW population",
       x = "Surveyed Population") +
  scale_color_manual(values = custom_colors) +  # Set custom colors
   # scale_y_continuous(breaks = seq(0, 2500, by = 500)) +
   # # scale_x_continuous(breaks = seq(0,2500 , by = 500))  # Adjust y-axis intervals
  theme_minimal()
print(sl_cls_gpw)

```



#11.(N_HHvsN_INDVI)The plots with Number of Households and survey population +wp_c population


```{r}
# Scatter plot comparing N_INDIVID and N_HH
N_ind_HH <- ggplot(camps, aes(x = as.numeric(N_INDVI), y = as.numeric(N_HH), color = Sit_Stt)) +
  geom_point() +
  labs(title = "Comparison between IOM survey population and Survey Houshold numbers",
       x = "Iom Survey population",
       y = "Households") +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  theme(plot.title = element_text(size = 3, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3, hjust = 0.5),
        axis.title.y = element_text(size = 3, hjust = 0.5),
        axis.text.x = element_text(size = 2),
        axis.text.y = element_text(size = 2)) +
  theme_minimal()

# Scatter plot comparing N_HH and ghsl
gpw_N_HH <- ggplot(camps, aes(y = as.numeric(N_HH), x = as.numeric(gpw), color = Sit_Stt)) +
  geom_point() +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between Household survey and Estimated GPW",
      y = "Households",
       x = "Estimated GPW Population") +
  
  theme(plot.title = element_text(size = 3, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3, hjust = 0.5),
        axis.title.y = element_text(size = 3, hjust = 0.5),
        axis.text.x = element_text(size = 2),
        axis.text.y = element_text(size = 2)) +
  theme_minimal()

# Arrange the plots in a grid
hh_gpw<-grid.arrange(N_ind_HH, gpw_N_HH , ncol = 1)
```


#12.Number of households and GHSL population only
```{r}
# Scatter plot comparing N_HH and ghsl
gpw_N_HH <- ggplot(camps, aes(y = as.numeric(N_HH), x = as.numeric(gpw), color = Sit_Stt)) +
  geom_point() +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between Household survey and Estimated GPW",
      y = "Households",
       x = "Estimated GPW Population") +
  
  theme(plot.title = element_text(size = 3, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3, hjust = 0.5),
        axis.title.y = element_text(size = 3, hjust = 0.5),
        axis.text.x = element_text(size = 2),
        axis.text.y = element_text(size = 2)) +
  theme_minimal()

plot(gpw_N_HH)
```


#__GPW-V4 CO PLOT SAVE


```{r}
#1.survey +estimated scatterplot
ggsave("Plots/gpw_surv_scat.png", plot =gpw_surv_scat, width = 8, height = 6, dpi = 400)

#2.Informal camp subset survey+estimated
ggsave("Plots/inf_plot_wp_c.png", plot =inf_plot_gpw, width = 8, height = 6, dpi = 400)

#3.Formal camp subset survey +estimated
ggsave("Plots/for_plot_wp_c.png", plot =for_plot_gpw, width = 8, height = 6, dpi = 400)

#4.Informal camp filtered for population<5000
ggsave("Plots/info_fil_wp_c.png", plot =info_fil_gpw, width = 8, height = 6, dpi = 400)

#5.Areawise subsetted(>10000 sqmts) calc vs estimated plot for formal and informal
ggsave("Plots/gpw_surv_a.png", plot =gpw_surv_a, width = 8, height = 6, dpi = 400)

#6.Areawise subsetted(<10000 sqmts) calc vs estimated plot for formal and informal
ggsave("Plots/gpw_surv_als.png", plot =gpw_surv_als, width = 8, height = 6, dpi = 400)

#7.Populationwise subsetted(>10000 ) calc vs estimated plot for formal and informal
ggsave("Plots/gpw_surv_greater.png", plot =gpw_surv_greater, width = 8, height = 6, dpi = 400)

#8.Populationwise subsetted(<10000 ) calc vs estimated plot for formal and informal
ggsave("Plots/gpw_surv_lesser.png", plot =gpw_surv_lesser, width = 8, height = 6, dpi = 400)

#9.Populationwise subsetted(<500 ) calc vs estimated plot for formal and informal
ggsave("Plots/gpw_surv_ls500.png", plot =gpw_surv_ls500, width = 8, height = 6, dpi = 400)

#10. Shelter type wise calc vs estimated plot 
ggsave("Plots/shlt_typ_gpw.png", plot =shlt_typ_gpw, width = 8, height = 6, dpi = 400)

#11.Settlement class wise calc vs estimated plot
ggsave("Plots/sl_cls_gpw.png", plot =sl_cls_gpw, width = 8, height = 6, dpi = 400)

#12. Houslhold survey number vs surveyed population and estimated population plot
ggsave("Plots/hh_gpw.png", plot =hh_gpw, width = 8, height = 6, dpi = 400)

#13. Household number vs estimated population
ggsave("Plots/gpw_N_HH .png", plot =gpw_N_HH , width = 8, height = 6, dpi = 400)


```


#___GPW Plot end________________________
#____________________________________________
#A.Correlation between houshold and population(both survey and estimated GPW)


```{r}
# Convert numeric variables from character to numeric
# Convert numeric variables from character to numeric
camps$N_INDVI <- as.numeric(camps$N_INDVI)
camps$N_HH <- as.numeric(camps$N_HH)
camps$gpw <- as.numeric(camps$gpw)


# Check the data types again
str(camps[, c("N_INDVI", "gpw", "N_HH")])

# Check for missing values
summary(camps[, c("N_INDVI", "gpw", "N_HH")])

# CalculateH correlation coefficients
corr_gpw_HH<- cor(camps$N_HH,camps$gpw)
corr_ind_HH<-cor(camps$N_INDVI,camps$N_HH)

# View correlation coefficients
print(corr_gpw_HH)
print(corr_ind_HH)


#results 
# [1] 0.1016669
# [1] 0.9409748

```



#B.Find about the difference in  statistics which will help in understanding the change in population of the camps from that of the estimated population 
```{r}
gpw_dff_stats<-summary(as.numeric(camps$gpw_df))
print(gpw_dff_stats)

```

#C.absolute diff/percentage diff/RMSE/mean absolute percentage error

```{r}
# Convert variables to numeric if necessary
camps$gpw <- as.numeric(camps$gpw)
camps$N_INDVI <- as.numeric(camps$N_INDVI)

# Calculate absolute difference
absolute_difference_gpw <- abs(camps$gpw - camps$N_INDVI)

# Calculate percentage difference
percentage_difference_gpw <- abs((camps$gpw - camps$N_INDVI) / camps$N_INDVI) * 100

# Calculate root mean square error (RMSE)
rmse_gpw <- sqrt(mean((camps$gpw - camps$N_INDVI)^2))

# Calculate mean absolute percentage error (MAPE)
mape_gpw <- mean(percentage_difference_gpw, na.rm = TRUE)

# Calculate absolute error
absolute_error_gpw <- mean(abs(as.numeric(camps$gpw) - as.numeric(camps$N_INDVI)))

# Print the result
print(absolute_error_gpw)

# Calculate percentage error
percentage_error_gpw <- mean(abs(as.numeric(camps$gpw) - as.numeric(camps$N_INDVI)) / as.numeric(camps$N_INDVI)) * 100

# Print the result
print(percentage_error_gpw)

# Print results
cat("Absolute Difference:", mean(absolute_difference_gpw), "\n")
cat("Percentage Difference:", mean(percentage_difference_gpw), "%\n")
cat("RMSE:", rmse_gpw, "\n")
cat("MAPE:", mape_gpw, "%\n")
cat("Absolute error:",absolute_error_gpw,"\n")
cat("Percentage error:",percentage_error_gpw)

```
#____________________________________________
#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
#_______________________________________________
##4.GPW UN adjusted 
#_______________________________________________





```{r}
gpw_UN <- rast('D:/EAGLE/Master_Thesis_Hannes/1/gpw/gpw_UNadj/gpw-v4-population-count-adjusted-to-2015-unwpp-country-totals-rev11_2020_30_sec_tif/gpw_v4_population_count_adjusted_to_2015_unwpp_country_totals_rev11_2020_30_sec.tif')
print(gpw_UN)
```

#!!!!!!The extract function!!!!!!!!!!!!!!!

```{r}
# function

# weighted sum per polygon (using the size of the pixel covered by the polygon "coverage_fraction")

extract_sum  <-  function(raster, polygon, field){

  polygon $id_tmp <- as.data.frame(polygon)[,field]

  v.exact <- exactextractr::exact_extract(raster, polygon, include_cols = 'id_tmp', max_cells_in_memory=3e+10)

  x <- do.call("rbind",v.exact)

  x[,"gpw_UN"] <- x[, "value"] * x$coverage_fraction

  x_sum <- x %>%

    dplyr::group_by(id_tmp)%>%

    dplyr::summarise_at("gpw_UN", sum, na.rm = TRUE)

polygon <- polygon %>%

    left_join(x_sum, by = "id_tmp")

  rm(x,v.exact,x_sum)

  return(polygon)

}
```




```{r}
camps <- extract_sum(gpw_UN, camps,"Name")
```

#comparing GPW and GPW_UN adjusted extracted population values
```{r}
# Check if values in two columns are the same
values_are_same <- all(camps$gpw == camps$gpw_UN)

# If values are not the same, print the columns of differences
if(!values_are_same) {
  # Get the indices where values are not the same
  different_indices <- which(camps$gpw != camps$gpw_UN)
  
  # Print the columns of differences
  print(paste("Columns of differences at indices:", different_indices))
  print(paste("Values in gpw:", camps$gpw[different_indices]))
  print(paste("Values in gpw_UN:", camps$gpw_UN[different_indices]))
} else {
  print("Values in the two columns are the same.")
}
```

# Analysis:GPW v4 and GPW v4 UN adjusted both differ
The values obtained are different for both GPW and GPW un adjusted




#Difference in the survery_population and gpw_population
```{r}
# Assuming you have a column named "N_INDVID" in the polygon_camps data frame
# Adjust the column name if needed

# Subtract N_INDVID from ras_name
camps$gpwU_df <- camps$N_INDVI - camps$gpw_UN

# View the resulting data frame with the new "difference" column
head(camps)
```

#%%%%%%%%%GPW END%%%%%%%%%%

#_________GPW_UN_PLOTS____________

#1.(ESTI_SUR)GPWUN adjusted Estimated and Iom survey population


```{r}
# Scatter plot with site_status
gpw_UN_surv_scat<-ggplot(camps, aes(y = gpw_UN, x = N_INDVI, color = Sit_Stt)) +

  geom_jitter(aes(x = (as.numeric(N_INDVI)),y = as.numeric(gpw_UN)), size = 0.6, alpha = 0.8,show.legend = TRUE)+geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between estimated and survey iom populations",
       x = "Estimated population(GPW V4)",
       y = "Iom surveyed population") +
  theme_minimal()
print(gpw_UN_surv_scat)
corr_gpw_UN<-cor(camps$N_INDVI,camps$gpw_UN)
print(corr_gpw_UN)
```


#2.(Informal)Subset the informal camps and plot the estimate  vs calc

```{r}

# 1. Subset the informal camps
informal_camps <- camps %>% filter(Sit_Stt == "Informal")

# 2. Extract relevant columns
data_plot_gpw_U <- informal_camps %>%
  select(gpw_UN, N_INDVI)

# 3. Plot with ggplot2
inf_plot_gpw_UN<-ggplot(data_plot_gpw_U, aes(y = gpw_UN, x = N_INDVI)) +geom_smooth(method = "lm",  se = FALSE) +
  #geom_point() +
  geom_jitter(aes(x = (as.numeric(N_INDVI)),y = as.numeric(gpw_UN)), size = 0.6, alpha = 0.8,show.legend = TRUE)+
  labs(title = "GPW_UN vs Surveyed Population for Informal Camps",
  y = "GPW_UN estimated Population", x = "Surveyed Population (N_INDVI)" )

print(inf_plot_gpw_UN)

corr_gpw_UN_inf<-cor(as.numeric(informal_camps$N_INDVI),as.numeric(informal_camps$gpw_UN))
print(corr_gpw_UN_inf)

#correlation result
#[1]  0.1909797
```



#3.(Formal)Subset the Formal camps and plot the estimate  vs calc
```{r}

# 1. Subset the informal camps
formal_camps <- camps %>% filter(Sit_Stt == "Formal")

# 2. Extract relevant columns
data_plot_gpw_U <- formal_camps %>%
  select(gpw_UN, N_INDVI)

# 3. Plot with ggplot2
for_plot_gpw_UN<-ggplot(data_plot_gpw_U, aes(y = gpw_UN, x = N_INDVI)) +geom_smooth(method = "lm",  se = FALSE) +
  geom_jitter(aes(x = (as.numeric(N_INDVI)),y = as.numeric(gpw_UN)), size = 0.6, alpha = 0.8,show.legend = TRUE)+
  #geom_point() +
  labs(y = "GPW UN Estimated Population", x = "Surveyed Population (N_INDVI)",
       title = "GPW_UN vs Surveyed Population for formal Camps")
print(for_plot_gpw_UN)

corr_gpw_UN_f<-cor(as.numeric(formal_camps$N_INDVI),as.numeric(formal_camps$gpw_UN))
print(corr_gpw_UN_f)


#correlation result
#[1]0.2005626
```


#4.(Informal_<5000)filtering the surveyed population less then 5000 for informal and plotting the calc vs estimated


```{r}
# 1. Subset the informal camps with surveyed population less than 5000
informal_camps_filtered <- camps %>%
  filter(Sit_Stt == "Informal" & N_INDVI < 5000)

# 2. Extract relevant columns
data_plot_gpw_U <- informal_camps_filtered %>%
  select(gpw_UN, N_INDVI)

# 3. Plot with ggplot2
info_fil_gpw_UN<-ggplot(data_plot_gpw_U, aes(x = N_INDVI, y = gpw_UN)) +geom_smooth(method = "lm",  se = FALSE) +
  geom_jitter(aes(x = (as.numeric(N_INDVI)),y = as.numeric(gpw_UN)), size = 0.6, alpha = 0.8,show.legend = TRUE)+
  #geom_point() +
  labs(x = "Surveyed Population (N_INDVI)", y = "GPW_UN estimated Population",
       title = "Surveyed vs Estimated Population for Informal Camps") 
 
print(info_fil_gpw_UN)
corr_gpw_UN_inf_ls5<-cor(as.numeric(informal_camps_filtered$N_INDVI),as.numeric(informal_camps_filtered$gpw_UN))
print(corr_gpw_UN_inf_ls5)

#correlation result
#[1 0.01339489
```

# 5.(Area_wise>10000)now considering the area wise plots for area only camps having area greater than 10000 square meter area

```{r}
# Scatter plot with site_status
gpw_UN_surv_a<-ggplot(subset_data, aes(y = gpw_UN, x = N_INDVI, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(gpw_UN)),size = 0.6, alpha = 0.8,show.legend = TRUE)+geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  
  labs(title = "Comparison between estimated and survey IOM populations for area greater then 10000 sq mts",
       y = "Estimated GPW_UN population",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(gpw_UN_surv_a)
  
corr_gpw_UN_ath<-cor(as.numeric(subset_data$N_INDVI),as.numeric(subset_data$gpw_UN))
print(corr_gpw_UN_ath)

#correlation result
#[1]  0.1120491
```



# 6.(Area_wise<10000)now considering the area wise plots for area only camps having area less than 10000 square meter area

```{r}
# Scatter plot with site_status
gpw_UN_surv_als<-ggplot(subset_data_2, aes(y = gpw_UN, x = N_INDVI, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(gpw_UN)),size = 0.6, alpha = 0.8,show.legend = TRUE)+geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  # geom_text(aes(x = as.numeric(N_INDVI), y = as.numeric(ghsl)), size = 1, vjust = -0.5, hjust = -0.5)+
  labs(title = "Comparison between estimated and survey iom populations for area less then 10000 sq mts",
       y = "Estimated GPW_UN population",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(gpw_surv_als)
  
corr_gpw_UN_als<-cor(as.numeric(subset_data_2$N_INDVI),as.numeric(subset_data_2$gpw_UN))
print(corr_gpw_UN_als)

#correlation result
#[1] 0.0590567
```











# splitting the population estimates for <10000 and > 10000

#7.(POPwise<10000&>10000) to see the sitesname for less than and greateer than 10000
```{r}
campsgt10000 <- subset(camps, N_INDVI > 10000)
campls10000 <- subset(camps, N_INDVI < 10000)
# Scatter plot with site_status for N_INDVI greater than 10,000
gpw_UN_surv_greater <- ggplot(subset(camps, as.numeric(N_INDVI) > 10000), aes(y = gpw_UN, x = N_INDVI, color = Sit_Stt)) +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(gpw_UN)), size = 0.6, alpha = 0.4, show.legend = TRUE) +
  labs(title = "Comparison between estimated and survey iom populations",
       y = "Estimated population (GPW_UN-V4)",
       x = "Iom surveyed population (N_INDVI > 10,000)") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(0, 40000, by = 5000))  # Adjust y-axis intervals

# Scatter plot with site_status for N_INDVI less than or equal to 10,000
gpw_UN_surv_lesser <- ggplot(subset(camps, as.numeric(N_INDVI) <= 10000), aes(y = gpw_UN, x = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(gpw_UN)), size = 0.6, alpha = 0.4, show.legend = TRUE) +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between estimated and survey IOM populations",
       y = "Estimated population(GPW-V4_UN)",
       x = "Iom surveyed population (N_INDVI <= 10,000)") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(0, 10000, by = 1000))  # Adjust y-axis intervals

# Print the plots
print(gpw_UN_surv_greater)
print(gpw_UN_surv_lesser)

# Print the plots

cor_gpw_UN_gt10000<-cor(campsgt10000 $N_INDVI,campsgt10000$gpw_UN)
print('population greater than10000')
print(cor_gpw_UN_gt10000)
cor_gpw_UN_ls10000<-cor(campls10000 $N_INDVI,campls10000$gpw_UN )
print('population less than10000')
print(cor_gpw_UN_ls10000)
```

#8.(POP<500)splitting the population less than 500
```{r}
ghsl_ls_500<-subset(camps, N_INDVI<500)
gpw_UN_surv_ls500 <- ggplot(subset(camps, as.numeric(N_INDVI) < 500), aes(y = gpw_UN, x = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(gpw_UN)), size = 0.6, alpha = 0.4, show.legend = TRUE) +
  labs(title = "Comparison between estimated and survey IOM populations",
       y = "Estimated population (gpw_UN)",
       x = "IOM surveyed population (N_INDVI < 500)") +
  theme_minimal() 
  # scale_y_continuous(breaks = seq(0, 550, by = 100))+scale_x_continuous(breaks = seq(0, 550, by = 100))  # Adjust y-axis intervals

#print plots'
print(gpw_UN_surv_ls500)
cor_gpw_UN_ls500<-cor(ghsl_ls_500 $N_INDVI,ghsl_ls_500$gpw_UN )
print(cor_gpw_UN_ls500)
```

#9.(SHELTER TYPE) Plot between calc vs surveyed pop arranged according to the shelter type

```{r}
# Define custom colors for Shelter_type
custom_colors <- c("#FF5733", "#33FF57", "#3366FF", "#FF33A8", "#FFFF33", "#33FFFF",  "#808080", "#A52A2A")
# filt_data_shltyls <- subset(camps, as.numeric(N_INDVI)<500)
# Set the alpha value for all points
alpha_value <- 0.2
# Scatter plot with different colors based on Shelter_type
shlt_typ_gpw_UN<-ggplot(camps, aes(y = as.numeric(gpw_UN), x = as.numeric(N_INDVI), color = Shlt_ty)) +
  geom_point(alpha = alpha_value) +
  labs(title = "Comparison between GPW_UN and N_INDVI",
       y= "Estimated GPW_UN population",
       x = "Surveyed Population") +
  scale_color_manual(values = custom_colors) +  # Set custom colors
   # scale_y_continuous(breaks = seq(0, 2500, by = 500)) +
   # # scale_x_continuous(breaks = seq(0,2500 , by = 500))  # Adjust y-axis intervals
  theme_minimal()
print(shlt_typ_gpw_UN)
```

#10.(SETTLEMENT CLASS) Settlement class wise plot for calc vs estimated plot


```{r}
# Define custom colors for Shelter_type
custom_colors <- c( "#A52A2A","#33FFFF",  "#FF33A8")
# filt_data_shltyls <- subset(camps, as.numeric(N_INDVI)<500)
# Set the alpha value for all points
alpha_value <- 0.5
# Scatter plot with different colors based on Shelter_type
sl_cls_gpw_UN<-ggplot(camps, aes(y = as.numeric(gpw_UN), x = as.numeric(N_INDVI), color = St_clss)) +
  geom_point(alpha = alpha_value) +
  labs(title = "Comparison between GPW-V4UN and N_INDVI with Shelter type",
       y = "Estimated GPW_UN population",
       x = "Surveyed Population") +
  scale_color_manual(values = custom_colors) +  # Set custom colors
   # scale_y_continuous(breaks = seq(0, 2500, by = 500)) +
   # # scale_x_continuous(breaks = seq(0,2500 , by = 500))  # Adjust y-axis intervals
  theme_minimal()
print(sl_cls_gpw_UN)

```



#11.(N_HHvsN_INDVI)The plots with Number of Households and survey population +wp_c population


```{r}
# Scatter plot comparing N_INDIVID and N_HH
N_ind_HH <- ggplot(camps, aes(x = as.numeric(N_INDVI), y = as.numeric(N_HH), color = Sit_Stt)) +
  geom_point() +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between IOM survey population and Survey Houshold numbers",
       x = "Iom Survey population",
       y = "Households") +
  theme(plot.title = element_text(size = 3, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3, hjust = 0.5),
        axis.title.y = element_text(size = 3, hjust = 0.5),
        axis.text.x = element_text(size = 2),
        axis.text.y = element_text(size = 2)) +
  theme_minimal()

# Scatter plot comparing N_HH and ghsl
gpw_UN_N_HH <- ggplot(camps, aes(y = as.numeric(N_HH), x = as.numeric(gpw_UN), color = Sit_Stt)) +
  geom_point() +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between Household survey and Estimated GPW_UN",
      y = "Households",
       x = "Estimated GPW_UN Population") +
  
  theme(plot.title = element_text(size = 3, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3, hjust = 0.5),
        axis.title.y = element_text(size = 3, hjust = 0.5),
        axis.text.x = element_text(size = 2),
        axis.text.y = element_text(size = 2)) +
  theme_minimal()

# Arrange the plots in a grid
hh_gpw_UN<-grid.arrange(N_ind_HH, gpw_UN_N_HH , ncol = 1)
```


#12.Number of households and GHSL population only
```{r}
# Scatter plot comparing N_HH and ghsl
gpw_UN_N_HH <- ggplot(camps, aes(y = as.numeric(N_HH), x = as.numeric(gpw_UN), color = Sit_Stt)) +
  geom_point() +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between Household survey and Estimated GPW_UN",
      y = "Households",
       x = "Estimated GPW_UN Population") +
  
  theme(plot.title = element_text(size = 3, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3, hjust = 0.5),
        axis.title.y = element_text(size = 3, hjust = 0.5),
        axis.text.x = element_text(size = 2),
        axis.text.y = element_text(size = 2)) +
  theme_minimal()

plot(gpw_UN_N_HH)
```


#__GPW-UN_V4 PLOT SAVE___


```{r}
#1.survey +estimated scatterplot
ggsave("Plots/gpw_UN_surv_scat.png", plot =gpw_UN_surv_scat, width = 8, height = 6, dpi = 400)

#2.Informal camp subset survey+estimated
ggsave("Plots/inf_plot_gpw_UN.png", plot =inf_plot_gpw_UN, width = 8, height = 6, dpi = 400)

#3.Formal camp subset survey +estimated
ggsave("Plots/for_plot_gpw_UN.png", plot =for_plot_gpw_UN, width = 8, height = 6, dpi = 400)

#4.Informal camp filtered for population<5000
ggsave("Plots/info_fil_gpw_UN.png", plot =info_fil_gpw_UN, width = 8, height = 6, dpi = 400)

#5.Areawise subsetted(>10000 sqmts) calc vs estimated plot for formal and informal
ggsave("Plots/gpw_UN_surv_a.png", plot =gpw_UN_surv_a, width = 8, height = 6, dpi = 400)

#6.Areawise subsetted(<10000 sqmts) calc vs estimated plot for formal and informal
ggsave("Plots/gpw_UN_surv_als.png", plot =gpw_UN_surv_als, width = 8, height = 6, dpi = 400)

#7.Populationwise subsetted(>10000 ) calc vs estimated plot for formal and informal
ggsave("Plots/gpw_UN_surv_greater.png", plot =gpw_UN_surv_greater, width = 8, height = 6, dpi = 400)

#8.Populationwise subsetted(<10000 ) calc vs estimated plot for formal and informal
ggsave("Plots/gpw_UN_surv_lesserr.png", plot =gpw_UN_surv_lesser, width = 8, height = 6, dpi = 400)

#9.Populationwise subsetted(<500 ) calc vs estimated plot for formal and informal
ggsave("Plots/gpw_UN_surv_ls500.png", plot =gpw_UN_surv_ls500, width = 8, height = 6, dpi = 400)

#10. Shelter type wise calc vs estimated plot 
ggsave("Plots/shlt_typ_gpw_UN.png", plot =shlt_typ_gpw_UN, width = 8, height = 6, dpi = 400)

#11.Settlement class wise calc vs estimated plot
ggsave("Plots/sl_cls_gpw_UN.png", plot =sl_cls_gpw_UN, width = 8, height = 6, dpi = 400)

#12. Houslhold survey number vs surveyed population and estimated population plot
ggsave("Plots/hh_gpw_UN.png", plot =hh_gpw_UN, width = 8, height = 6, dpi = 400)

#13. Household number vs estimated population
ggsave("Plots/gpw_UN_N_HH .png", plot =gpw_UN_N_HH , width = 8, height = 6, dpi = 400)


```


#___GPW-UN Plot END________________________
#____________________________________________
#A.Correlation between houshold and population(both survey and estimated GPW)


```{r}
# Convert numeric variables from character to numeric
# Convert numeric variables from character to numeric
camps$N_INDVI <- as.numeric(camps$N_INDVI)
camps$N_HH <- as.numeric(camps$N_HH)
camps$gpw_UN <- as.numeric(camps$gpw_UN)


# Check the data types again
str(camps[, c("N_INDVI", "gpw_UN", "N_HH")])

# Check for missing values
summary(camps[, c("N_INDVI", "gpw_UN", "N_HH")])

# CalculateH correlation coefficients
corr_gpw_UN_HH<- cor(camps$N_HH,camps$gpw_UN)
corr_ind_HH<-cor(camps$N_INDVI,camps$N_HH)

# View correlation coefficients
print(corr_gpw_UN_HH)
print(corr_ind_HH)


#results 
# [1] 0.1014933
# [1] 0.9409748

```



#B.Find about the difference in  statistics which will help in understanding the change in population of the camps from that of the estimated population 
```{r}
gpw_dff_UN_stats<-summary(as.numeric(camps$gpwU_df))
print(gpw_dff_UN_stats)

```

#C.absolute diff/percentage diff/RMSE/mean absolute percentage error

```{r}
# Convert variables to numeric if necessary
camps$gpw_UN <- as.numeric(camps$gpw_UN)
camps$N_INDVI <- as.numeric(camps$N_INDVI)

# Calculate absolute difference
absolute_difference_gpw_UN <- abs(camps$gpw_UN - camps$N_INDVI)

# Calculate percentage difference
percentage_difference_gpw_UN <- abs((camps$gpw_UN - camps$N_INDVI) / camps$N_INDVI) * 100

# Calculate root mean square error (RMSE)
rmse_gpw_UN <- sqrt(mean((camps$gpw_UN - camps$N_INDVI)^2))

# Calculate mean absolute percentage error (MAPE)
mape_gpw_UN <- mean(percentage_difference_gpw_UN, na.rm = TRUE)

# Calculate absolute error
absolute_error_gpw_UN <- mean(abs(as.numeric(camps$gpw_UN) - as.numeric(camps$N_INDVI)))

# Print the result
print(absolute_error_gpw_UN)

# Calculate percentage error
percentage_error_gpw_UN <- mean(abs(as.numeric(camps$gpw_UN) - as.numeric(camps$N_INDVI)) / as.numeric(camps$N_INDVI)) * 100

# Print the result
print(percentage_error_gpw_UN)

# Print results
cat("Absolute Difference:", mean(absolute_difference_gpw_UN), "\n")
cat("Percentage Difference:", mean(percentage_difference_gpw_UN), "%\n")
cat("RMSE:", rmse_gpw_UN, "\n")
cat("MAPE:", mape_gpw_UN, "%\n")
cat("Absolute error:",absolute_error_gpw_UN,"\n")
cat("Percentage error:",percentage_error_gpw_UN)

```

#____________________________________________
#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
#_______________________________________________


#COMBINING THE PLOTS
#______________________________________


##**%%%Combining the scatterplots for all the eo datsets in one plot%%%%%
#(Main)_combined_scatterplot 1-
```{r}
library(gridExtra)

# Scatter plot with site_status for gpw
scatter_gpw <- ggplot(camps, aes(x= gpw, y= N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_INDVI), x = as.numeric(gpw)), size = 0.6, alpha = 0.8, show.legend = TRUE) +
  labs(title = "Comparison between estimated and survey iom populations",
       x = "Estimated population (GPW)",
       y = "Survey_population") +  # No y-axis label
  theme_minimal()+theme(plot.title = (element_text(size = 9,colour = "Red")),axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))

# Scatter plot with site_status for wp_con
scatter_wp_con <- ggplot(camps, aes(x = wp_c, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_INDVI), x = as.numeric(wp_c)), size = 0.6, alpha = 0.8, show.legend = TRUE) +
  labs(title = NULL,  # No title
       x = "Estimated population (WP_CON)",
       y = "Survey_population") +  # No y-axis label
  theme_minimal()+theme(axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))

# Scatter plot with site_status for wp_uncon
scatter_wp_uncon <- ggplot(camps, aes(x= wp_uc, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_INDVI), x = as.numeric(wp_uc)), size = 0.6, alpha = 0.8, show.legend = TRUE) +
  labs(title = NULL,  # No title
       x = "Estimated population (WP_UNCON)",
       y = "Survey_population") +  # No y-axis label
  theme_minimal()+theme(axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))

# Scatter plot with site_status for ghsl
scatter_ghsl <- ggplot(camps, aes(x = ghsl, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_INDVI), x = as.numeric(ghsl)), size = 0.6, alpha = 0.8, show.legend = TRUE) +
  labs(title = NULL,  # No title
       x = "Estimated population (GHSL)",
       y = "Survey_population") +  # Only this plot has y-axis label
  theme_minimal()+theme(axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))


# Scatter plot with site_status for gpw_UN
scatter_gpw_UN<- ggplot(camps, aes(x = gpw_UN, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(y= as.numeric(N_INDVI), x = as.numeric(gpw_UN)), size = 0.6, alpha = 0.8, show.legend = TRUE) +
  labs(title = NULL,  # No title
       x = "Estimated population (GPW_UN)",
       y = "Survey_population") +  # Only this plot has y-axis label
  theme_minimal()+theme(axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))

# Combine all scatter plots into one
combined_plot1 <- grid.arrange(scatter_gpw,scatter_gpw_UN, scatter_wp_con, scatter_wp_uncon, scatter_ghsl, nrow = 3, ncol = 2)

# Print the combined plot
print(combined_plot1)
```




#Same scale compared scatterplots for pop
```{r}
library(ggplot2)
library(gridExtra)

# Find the minimum and maximum values of the estimated population variable across all datasets
min_value <- min(c(min(camps$gpw, camps$wp_c, camps$wp_uc, camps$ghsl, camps$gpw_UN)))
max_value <- max(c(max(camps$gpw, camps$wp_c, camps$wp_uc, camps$ghsl, camps$gpw_UN)))

# Define the x-value for the vertical line
vertical_line_x <- 15000

# Function to create scatter plot with equal aspect ratio, diagonal line, and vertical line
create_scatter_plot <- function(data, x_var) {
  ggplot(data, aes_string(x = x_var, y = "N_INDVI", color = "Sit_Stt")) +
    geom_jitter(aes_string(y = "as.numeric(N_INDVI)", x = paste0("as.numeric(", x_var, ")")), 
                size = 0.6, alpha = 0.8, show.legend = TRUE) +
    geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "black") +  # Add diagonal line
    geom_vline(xintercept = vertical_line_x, linetype = "dotted", color = "red") +  # Add vertical line
    theme_minimal() + 
    theme(axis.text.x = element_text(size = 5),
          axis.text.y = element_text(size = 5),
          axis.title.x = element_text(size = 5),
          axis.title.y = element_text(size = 5)) +
    scale_x_continuous(limits = c(min_value, max_value), 
                       breaks = seq(min_value, max_value, by = (max_value - min_value) / 5)) +
    coord_fixed(ratio = 1)  # Set equal aspect ratio
}

# Scatter plot with site_status for gpw
scatter_gpw <- create_scatter_plot(camps, "gpw")

# Scatter plot with site_status for wp_con
scatter_wp_con <- create_scatter_plot(camps, "wp_c")

# Scatter plot with site_status for wp_uncon
scatter_wp_uncon <- create_scatter_plot(camps, "wp_uc")

# Scatter plot with site_status for ghsl
scatter_ghsl <- create_scatter_plot(camps, "ghsl")

# Scatter plot with site_status for gpw_UN
scatter_gpw_UN <- create_scatter_plot(camps, "gpw_UN")

# Arrange the plots using grid.arrange
combined_plot_scale_adj <- grid.arrange(scatter_gpw, scatter_wp_con, scatter_wp_uncon, scatter_ghsl, scatter_gpw_UN,
                               nrow = 3, ncol = 2)

# Print the combined plot
print(combined_plot_scale_adj)




```

```{r}
ggsave("Plots/combined_plot_scale_adj.png", plot = combined_plot_scale_adj, width = 8, height = 6, dpi = 400)
```







#fit the line
```{r}
library(ggplot2)

# Find the minimum and maximum values of the estimated population variable across all datasets
min_value <- min(c(min(camps$gpw, camps$wp_c, camps$wp_uc, camps$ghsl, camps$gpw_UN)))
max_value <- max(c(max(camps$gpw, camps$wp_c, camps$wp_uc, camps$ghsl, camps$gpw_UN)))

# Function to create scatter plot with fit line and consistent x-axis scale
create_scatter_plot_with_fit <- function(data, x_var, title, min_x, max_x) {
  ggplot(data, aes_string(x = x_var, y = "N_INDVI", color = "Sit_Stt")) +
    geom_jitter(aes_string(y = "as.numeric(N_INDVI)", x = paste0("as.numeric(", x_var, ")")), 
                size = 0.6, alpha = 0.8) +
    geom_smooth(method = "lm", se = FALSE) +  # Add fit line
    labs(title = title,
         x = "Estimated Population",
         y = "Survey Population") +
    theme_minimal() +
    theme(plot.title = element_text(hjust = 0.5),
          legend.position = "none") +
    scale_x_continuous(limits = c(min_x, max_x))  # Set x-axis limits
}

# Scatter plot with fit line for gpw
scatter_gpw <- create_scatter_plot_with_fit(camps, "gpw", "GPW", min_value, max_value)

# Scatter plot with fit line for wp_con
scatter_wp_con <- create_scatter_plot_with_fit(camps, "wp_c", "WP_CON", min_value, max_value)

# Scatter plot with fit line for wp_uncon
scatter_wp_uncon <- create_scatter_plot_with_fit(camps, "wp_uc", "WP_UNCON", min_value, max_value)

# Scatter plot with fit line for ghsl
scatter_ghsl <- create_scatter_plot_with_fit(camps, "ghsl", "GHSL", min_value, max_value)

# Scatter plot with fit line for gpw_UN
scatter_gpw_UN <- create_scatter_plot_with_fit(camps, "gpw_UN", "GPW_UN", min_value, max_value)

# Arrange the plots using grid.arrange
combined_smooth <- grid.arrange(scatter_gpw,scatter_gpw_UN,  scatter_ghsl, scatter_wp_con, scatter_wp_uncon,
                              nrow = 3, ncol = 2)

# Print the combined plot
print(combined_smooth)


```

```{r}
ggsave("Plots/combined_smooth.png", plot = combined_smooth, width = 8, height = 6, dpi = 400)
```

#scatterplots with geom_smooth and geomabline slope =1
```{r}
library(ggplot2)

# Find the minimum and maximum values of the estimated population variable across all datasets
min_value <- min(c(min(camps$gpw, camps$wp_c, camps$wp_uc, camps$ghsl, camps$gpw_UN)))
max_value <- max(c(max(camps$gpw, camps$wp_c, camps$wp_uc, camps$ghsl, camps$gpw_UN)))

# Function to create scatter plot with fit line and consistent x-axis scale
create_scatter_plot_with_fit <- function(data, x_var, title, min_x, max_x) {
  ggplot(data, aes_string(x = x_var, y = "N_INDVI", color = "Sit_Stt")) +
    geom_jitter(aes_string(y = "as.numeric(N_INDVI)", x = paste0("as.numeric(", x_var, ")")), 
                size = 0.6, alpha = 0.8) +
    geom_smooth(method = "lm", se = FALSE) +  # Add fit line
    geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "black") +  # Add diagonal line
    labs(title = title,
         x = "Estimated Population",
         y = "Survey Population") +
    theme_minimal() +
    theme(plot.title = element_text(hjust = 0.5),
          legend.position = "none") +
    scale_x_continuous(limits = c(min_x, max_x))  # Set x-axis limits
}

# Scatter plot with fit line for gpw
scatter_gpw <- create_scatter_plot_with_fit(camps, "gpw", "GPW", min_value, max_value)

# Scatter plot with fit line for wp_con
scatter_wp_con <- create_scatter_plot_with_fit(camps, "wp_c", "WP_CON", min_value, max_value)

# Scatter plot with fit line for wp_uncon
scatter_wp_uncon <- create_scatter_plot_with_fit(camps, "wp_uc", "WP_UNCON", min_value, max_value)

# Scatter plot with fit line for ghsl
scatter_ghsl <- create_scatter_plot_with_fit(camps, "ghsl", "GHSL", min_value, max_value)

# Scatter plot with fit line for gpw_UN
scatter_gpw_UN <- create_scatter_plot_with_fit(camps, "gpw_UN", "GPW_UN", min_value, max_value)

# Arrange the plots using grid.arrange
combined_plot_smooth_line <- grid.arrange(scatter_gpw, scatter_gpw_UN,scatter_ghsl,scatter_wp_con, scatter_wp_uncon,  
                              nrow = 3, ncol = 2)

# Print the combined plot
print(combined_plot_smooth_line)

```


```{r}
ggsave("Plots/combined_plot_smooth_line.png", plot = combined_plot_smooth_line, width = 8, height = 6, dpi = 400)
```








#combined_scatterplot 3
```{r}
library(cowplot)

# General y-axis label
y_label <- "Iom surveyed population"

# General fill label
fill_label <- "Site Status"

# Scatter plot with site_status for gpw
scatter_gpw <- ggplot(camps, aes(x = gpw, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(gpw)), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(
       x = "Estimated population (GPW)",
       y = NULL) +  # No y-axis label
  theme_minimal()+
  theme(plot.title = element_text(size = 9, color = "Blue", hjust = 0.5),
        axis.title.x = element_text(size = 3.5, hjust = 0.5),axis.text.y = element_text(size = 3.5),
        axis.text.x = element_text(size =3.5))

# Scatter plot with site_status for wp_con
scatter_wp_con <- ggplot(camps, aes(x = wp_c, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_c)), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(title = NULL,  # No title
       x = "Estimated population (WP_CON)",
       y = NULL) +  # No y-axis label
  theme_minimal()+
  theme(axis.title.x = element_text(size = 3.5, hjust = 0.5),axis.text.y = element_text(size = 3.5),
        axis.text.x = element_text(size = 3.5))

# Scatter plot with site_status for wp_uncon
scatter_wp_uncon <- ggplot(camps, aes(x = wp_uc, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(wp_uc)), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(title = NULL,  # No title
       x = "Estimated population (WP_UNCON)",
       y = NULL) +  # No y-axis label
  theme_minimal()+
  theme(axis.title.x = element_text(size = 3.5, hjust = 0.5),axis.text.y = element_text(size = 3.5),
        axis.text.x = element_text(size = 3.5))

# Scatter plot with site_status for ghsl
scatter_ghsl <- ggplot(camps, aes(x = ghsl, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(x = as.numeric(N_INDVI), y = as.numeric(ghsl), fill = Sit_Stt), size = 0.6, alpha = 0.8, show.legend = FALSE) +
  labs(title = NULL,  # No title
       x = "Estimated population (GHSL)",
       y = NULL) +  # No y-axis label
  theme_minimal()+
  theme(axis.title.x = element_text(size = 3.5, hjust = 0.5),axis.text.y = element_text(size = 3.5),
        axis.text.x = element_text(size = 3.5))

# Combine all scatter plots into one using cowplot
combined_plot <- plot_grid(scatter_gpw, scatter_wp_con, scatter_wp_uncon, scatter_ghsl, nrow = 2, ncol = 2, align = "h",  rel_widths = c(0.5,0.5), rel_heights = c(0.5,0.5),labels = "AUTO",label_size = 5,label_colour = "red")

# Add y-axis label outside the grid
combined_plot3 <- combined_plot + draw_label(y_label, x = 0, angle = 90, vjust = 0.75, hjust = 0.5, size = 5)

# Add fill label outside the grid
# combined_plot <- combined_plot + draw_label(fill_label, x = 1, y = 1, angle = 90, size = 5, hjust =5, vjust =0.1)

# # Add title outside the grid
# combined_plot <- combined_plot + draw_label("Comparison of Estimated and Surveyed Populations", x = 0.5, y = 1, size = 5, hjust = 0.2,vjust=0.5)

# Print the combined plot
print(combined_plot3)
```


#-Main combined scatterplot household and population

```{r}


# Scatter plot with site_status for gpw
scatter_nindvi_hh<- ggplot(camps, aes(x= N_INDVI, y= N_HH, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_HH), x = as.numeric(N_INDVI)), size = 0.6, alpha = 0.8, show.legend = TRUE) +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = "Comparison between  population and survey household numbers",
       x = "Survey  population (N_INDVI)",
       y = "Survey_House holdnumbers") +  # No y-axis label
  theme_minimal()+theme(plot.title = (element_text(size = 6,colour = "Red")),axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))

# Scatter plot with site_status for gpw
scatter_gpw_hh<- ggplot(camps, aes(x= gpw, y= N_HH, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_HH), x = as.numeric(gpw)), size = 0.6, alpha = 0.8, show.legend = TRUE) +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = NULL,
       x = "Estimated population (GPW)",
       y = "Survey_House holdnumbers") +  # No y-axis label
  theme_minimal()+theme(axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))

# Scatter plot with site_status for wp_con
scatter_wp_con_hh <- ggplot(camps, aes(x = wp_c, y = N_HH, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_HH), x = as.numeric(wp_c)), size = 0.6, alpha = 0.8, show.legend = TRUE) +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = NULL,  # No title
       x = "Estimated population (WP_CON)",
       y = "Survey_household number") +  # No y-axis label
  theme_minimal()+theme(axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))

# Scatter plot with site_status for wp_uncon
scatter_wp_uncon_hh <- ggplot(camps, aes(x= wp_uc, y = N_HH, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_HH), x = as.numeric(wp_uc)), size = 0.6, alpha = 0.8, show.legend = TRUE) +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = NULL,  # No title
       x = "Estimated population (WP_UNCON)",
       y = "Survey_household number") +  # No y-axis label
  theme_minimal()+theme(axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))

# Scatter plot with site_status for ghsl
scatter_ghsl_hh <- ggplot(camps, aes(x = ghsl, y = N_HH, color = Sit_Stt)) +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  geom_jitter(aes(y = as.numeric(N_HH), x = as.numeric(ghsl)), size = 0.6, alpha = 0.8, show.legend = TRUE) +
  labs(title = NULL,  # No title
       x = "Estimated population (GHSL)",
       y = "Survey_household number") +  # Only this plot has y-axis label
  theme_minimal()+theme(axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))


# Scatter plot with site_status for gpw_UN
scatter_gpw_UN_hh<- ggplot(camps, aes(x = gpw_UN, y = N_HH, color = Sit_Stt)) +
  geom_jitter(aes(y= as.numeric(N_HH), x = as.numeric(gpw_UN)), size = 0.6, alpha = 0.8, show.legend = TRUE) +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  labs(title = NULL,  # No title
       x = "Estimated population (GPW_UN)",
       y = "Survey_household number") +  # Only this plot has y-axis label
  theme_minimal()+theme(axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))

# Combine all scatter plots into one
combined_plot_hh <- grid.arrange(scatter_nindvi_hh,scatter_gpw_hh,scatter_gpw_UN_hh, scatter_wp_con_hh, scatter_wp_uncon_hh, scatter_ghsl_hh, nrow = 2, ncol = 3)


print(combined_plot_hh)
```

#Same scale for hh plots
```{r}
# Find the minimum and maximum values of the estimated population variable across all datasets
min_value <- min(c(min(camps$gpw, camps$wp_c, camps$wp_uc, camps$ghsl, camps$gpw_UN,camps$N_INDVI)))
max_value <- max(c(max(camps$gpw, camps$wp_c, camps$wp_uc, camps$ghsl, camps$gpw_UN,camps$N_INDVI)))

# Function to create scatter plot with fit line and consistent x-axis scale
create_scatter_plot_with_fit <- function(data, x_var, title, min_x, max_x) {
  ggplot(data, aes_string(x = x_var, y = "N_HH", color = "Sit_Stt")) +
    geom_jitter(aes_string(y = "as.numeric(N_HH)", x = paste0("as.numeric(", x_var, ")")), 
                size = 0.6, alpha = 0.8) +
    geom_smooth(method = "lm", se = FALSE) +  # Add fit line
    geom_abline(intercept = 0, slope = 0.5, linetype = "dashed", color = "black") +  # Add diagonal line
    labs(title = title,
         x = "Population",
         y = "Survey Household number") +
    theme_minimal() +
    theme(plot.title = element_text(hjust = 0.5),
          legend.position = "none") +
    scale_x_continuous(limits = c(min_x, max_x))  # Set x-axis limits
}
#scatter plot with fit line for  N_INDVI
scatter_nind_nhh<-
create_scatter_plot_with_fit(camps, "N_INDVI", "Survey population", min_value, max_value)  

# Scatter plot with fit line for gpw
scatter_gpw <- create_scatter_plot_with_fit(camps, "gpw", "GPW", min_value, max_value)

# Scatter plot with fit line for wp_con
scatter_wp_con <- create_scatter_plot_with_fit(camps, "wp_c", "WP_CON", min_value, max_value)

# Scatter plot with fit line for wp_uncon
scatter_wp_uncon <- create_scatter_plot_with_fit(camps, "wp_uc", "WP_UNCON", min_value, max_value)

# Scatter plot with fit line for ghsl
scatter_ghsl <- create_scatter_plot_with_fit(camps, "ghsl", "GHSL", min_value, max_value)

# Scatter plot with fit line for gpw_UN
scatter_gpw_UN <- create_scatter_plot_with_fit(camps, "gpw_UN", "GPW_UN", min_value, max_value)

# Arrange the plots using grid.arrange
combined_plot_smooth_line_hh <- grid.arrange(scatter_nind_nhh,scatter_gpw, scatter_gpw_UN,scatter_ghsl,scatter_wp_con, scatter_wp_uncon,  
                              nrow = 2, ncol = 3)

# Print the combined plot
print(combined_plot_smooth_line_hh)

```


#saving the all scatterplots

```{r}
# Save the plot to a file
ggsave("Plots/combined_sctr1.png", plot = combined_plot1, width = 8, height = 6, dpi = 400)
ggsave("Plots/combined_sctr2.png", plot = combined_plot2, width = 8, height = 6, dpi = 400)
ggsave("Plots/combined_plot_hh.png", plot = combined_plot_hh, width = 8, height = 6, dpi = 400)
ggsave("Plots/combined_plot_smooth_line_hh.png", plot = combined_plot_smooth_line_hh, width = 8, height = 6, dpi = 400)
```
#_____________________________

#AREA WISE combined scatterplots
#(area_wise>10000)
```{r}
# Find the minimum and maximum values of the estimated population variable across all datasets
min_value <- min(c(min(subset_data$gpw, subset_data$wp_c, subset_data$wp_uc, subset_data$ghsl, subset_data$gpw_UN)))
max_value <- max(c(max(subset_data$gpw, subset_data$wp_c, subset_data$wp_uc, subset_data$ghsl, subset_data$gpw_UN)))

# Function to create scatter plot with fit line and consistent x-axis scale
create_scatter_plot_with_fit_g1 <- function(data, x_var, title, min_x, max_x) {
  ggplot(data, aes_string(x = x_var, y = "N_INDVI", color = "Sit_Stt")) +
    geom_jitter(aes_string(y = "as.numeric(N_INDVI)", x = paste0("as.numeric(", x_var, ")")), 
                size = 0.6, alpha = 0.8) +
    geom_smooth(method = "lm", se = FALSE) +  # Add fit line
    geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "black") +  # Add diagonal line
    labs(title = title,
         x = "Estimated Population(area>10000m2)",
         y = "Survey Population") +
    theme_minimal() +
    theme(plot.title = element_text(hjust = 0.5),
          legend.position = "none") +
    scale_x_continuous(limits = c(min_x, max_x))  # Set x-axis limits
}

# Scatter plot with fit line for gpw
scatter_gpw_g1 <- create_scatter_plot_with_fit_g1(subset_data, "gpw", "GPW", min_value, max_value)

# Scatter plot with fit line for wp_con
scatter_wp_con_g1 <- create_scatter_plot_with_fit_g1(subset_data, "wp_c", "WP_CON", min_value, max_value)

# Scatter plot with fit line for wp_uncon
scatter_wp_uncon_g1<- create_scatter_plot_with_fit_g1(subset_data, "wp_uc", "WP_UNCON", min_value, max_value)

# Scatter plot with fit line for ghsl
scatter_ghsl_g1 <- create_scatter_plot_with_fit_g1(subset_data, "ghsl", "GHSL", min_value, max_value)

# Scatter plot with fit line for gpw_UN
scatter_gpw_UN_g1 <- create_scatter_plot_with_fit_g1(subset_data, "gpw_UN", "GPW_UN", min_value, max_value)

# Arrange the plots using grid.arrange
combined_plot_smooth_line_g1 <- grid.arrange(scatter_gpw_g1, scatter_gpw_UN_g1,scatter_ghsl_g1,scatter_wp_con_g1, scatter_wp_uncon_g1,  
                              nrow = 3, ncol = 2)

# Print the combined plot
print(combined_plot_smooth_line_g1)
```



#(area_wise<10000)
```{r}
# Find the minimum and maximum values of the estimated population variable across all datasets
min_value <- min(c(min(subset_data_2$gpw, subset_data_2$wp_c, subset_data_2$wp_uc, subset_data_2$ghsl, subset_data_2$gpw_UN)))
max_value <- max(c(max(subset_data_2$gpw, subset_data_2$wp_c, subset_data_2$wp_uc, subset_data_2$ghsl, subset_data_2$gpw_UN)))

# Function to create scatter plot with fit line and consistent x-axis scale
create_scatter_plot_with_fit_l1 <- function(data, x_var, title, min_x, max_x) {
  ggplot(data, aes_string(x = x_var, y = "N_INDVI", color = "Sit_Stt")) +
    geom_jitter(aes_string(y = "as.numeric(N_INDVI)", x = paste0("as.numeric(", x_var, ")")), 
                size = 0.6, alpha = 0.8) +
    geom_smooth(method = "lm", se = FALSE) +  # Add fit line
    geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "black") +  # Add diagonal line
    labs(title = title,
         x = "Estimated Population(area<10000m2)",
         y = "Survey Population") +
    theme_minimal() +
    theme(plot.title = element_text(hjust = 0.5),
          legend.position = "none") +
    scale_x_continuous(limits = c(min_x, max_x))  # Set x-axis limits
}

# Scatter plot with fit line for gpw
scatter_gpw_l1 <- create_scatter_plot_with_fit_l1(subset_data_2, "gpw", "GPW", min_value, max_value)

# Scatter plot with fit line for wp_con
scatter_wp_con_l1 <- create_scatter_plot_with_fit_l1(subset_data_2, "wp_c", "WP_CON", min_value, max_value)

# Scatter plot with fit line for wp_uncon
scatter_wp_uncon_l1<- create_scatter_plot_with_fit_l1(subset_data_2, "wp_uc", "WP_UNCON", min_value, max_value)

# Scatter plot with fit line for ghsl
scatter_ghsl_l1 <- create_scatter_plot_with_fit_l1(subset_data_2, "ghsl", "GHSL", min_value, max_value)

# Scatter plot with fit line for gpw_UN
scatter_gpw_UN_l1 <- create_scatter_plot_with_fit_g1(subset_data_2, "gpw_UN", "GPW_UN", min_value, max_value)

# Arrange the plots using grid.arrange
combined_plot_smooth_line_l1 <- grid.arrange(scatter_gpw_l1, scatter_gpw_UN_l1,scatter_ghsl_l1,scatter_wp_con_l1, scatter_wp_uncon_l1,  
                              nrow = 3, ncol = 2)

# Print the combined plot
print(combined_plot_smooth_line_l1)
```




#save the plot

```{r}
# Save the plot to a file
ggsave("Plots/combined_plot_smooth_line_g1.png", plot = combined_plot_smooth_line_g1, width = 8, height = 6, dpi = 400)
# Save the plot to a file
ggsave("Plots/combined_plot_smooth_line_l1.png", plot = combined_plot_smooth_line_l1, width = 8, height = 6, dpi = 400)
```

#POPULATION WISE  SPLIT

```{r}
campsgt10000 <- subset(camps, N_INDVI > 10000)
campls10000 <- subset(camps, N_INDVI < 10000)
```
#population <10000
```{r}
# Find the minimum and maximum values of the estimated population variable across all datasets
min_value <- min(c(min(campls10000 $gpw, campls10000 $wp_c, campls10000 $wp_uc, campls10000 $ghsl, campls10000 $gpw_UN)))
max_value <- max(c(max(campls10000 $gpw, campls10000$wp_c, campls10000$wp_uc, campls10000 $ghsl, campls10000$gpw_UN)))

# Function to create scatter plot with fit line and consistent x-axis scale
create_scatter_plot_with_fit_pl1 <- function(data, x_var, title, min_x, max_x) {
  ggplot(data, aes_string(x = x_var, y = "N_INDVI", color = "Sit_Stt")) +
    geom_jitter(aes_string(y = "as.numeric(N_INDVI)", x = paste0("as.numeric(", x_var, ")")), 
                size = 0.6, alpha = 0.8) +
    geom_smooth(method = "lm", se = FALSE) +  # Add fit line
    geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "black") +  # Add diagonal line
    labs(title = title,
         x = "Estimated Population",
         y = "Survey Population(<10000)") +
    theme_minimal() +
    theme(plot.title = element_text(hjust = 0.5),
          legend.position = "none") +
    scale_x_continuous(limits = c(min_x, max_x))  # Set x-axis limits
}

# Scatter plot with fit line for gpw
scatter_gpw_pl1 <- create_scatter_plot_with_fit_pl1(campls10000 , "gpw", "GPW", min_value, max_value)

# Scatter plot with fit line for wp_con
scatter_wp_con_pl1 <- create_scatter_plot_with_fit_pl1(campls10000 , "wp_c", "WP_CON", min_value, max_value)

# Scatter plot with fit line for wp_uncon
scatter_wp_uncon_pl1<- create_scatter_plot_with_fit_pl1(campls10000 , "wp_uc", "WP_UNCON", min_value, max_value)

# Scatter plot with fit line for ghsl
scatter_ghsl_pl1 <- create_scatter_plot_with_fit_pl1(campls10000 , "ghsl", "GHSL", min_value, max_value)

# Scatter plot with fit line for gpw_UN
scatter_gpw_UN_pl1 <- create_scatter_plot_with_fit_pl1(campls10000 , "gpw_UN", "GPW_UN", min_value, max_value)

# Arrange the plots using grid.arrange
combined_plot_smooth_line_pl1 <- grid.arrange(scatter_gpw_pl1, scatter_gpw_UN_pl1,scatter_ghsl_pl1,scatter_wp_con_pl1, scatter_wp_uncon_pl1,  
                              nrow = 3, ncol = 2)

# Print the combined plot
print(combined_plot_smooth_line_pl1)
```

#population>10000
```{r}

# Find the minimum and maximum values of the estimated population variable across all datasets
min_value <- min(c(min(campsgt10000$gpw, campsgt10000$wp_c, campsgt10000$wp_uc, campsgt10000$ghsl, campsgt10000$gpw_UN)))
max_value <- max(c(max(campsgt10000$gpw, campsgt10000$wp_c, campsgt10000$wp_uc, campsgt10000$ghsl, campsgt10000$gpw_UN)))

# Function to create scatter plot with fit line and consistent x-axis scale
create_scatter_plot_with_fit_pg1 <- function(data, x_var, title, min_x, max_x) {
  ggplot(data, aes_string(x = x_var, y = "N_INDVI", color = "Sit_Stt")) +
    geom_jitter(aes_string(y = "as.numeric(N_INDVI)", x = paste0("as.numeric(", x_var, ")")), 
                size = 0.6, alpha = 0.8) +
    geom_smooth(method = "lm", se = FALSE) +  # Add fit line
    geom_abline(intercept = 0, slope = 1, linetype = "dashed", color = "black") +  # Add diagonal line
    labs(title = title,
         x = "Estimated Population",
         y = "Survey Population(>10000)") +
    theme_minimal() +
    theme(plot.title = element_text(hjust = 0.5),
          legend.position = "none") +
    scale_x_continuous(limits = c(min_x, max_x))  # Set x-axis limits
}

# Scatter plot with fit line for gpw
scatter_gpw_pg1 <- create_scatter_plot_with_fit_pg1(campsgt10000, "gpw", "GPW", min_value, max_value)

# Scatter plot with fit line for wp_con
scatter_wp_con_pg1 <- create_scatter_plot_with_fit_pg1(campsgt10000, "wp_c", "WP_CON", min_value, max_value)

# Scatter plot with fit line for wp_uncon
scatter_wp_uncon_pg1<- create_scatter_plot_with_fit_pg1(campsgt10000, "wp_uc", "WP_UNCON", min_value, max_value)

# Scatter plot with fit line for ghsl
scatter_ghsl_pg1 <- create_scatter_plot_with_fit_pg1(campsgt10000, "ghsl", "GHSL", min_value, max_value)

# Scatter plot with fit line for gpw_UN
scatter_gpw_UN_pg1 <- create_scatter_plot_with_fit_pg1(campsgt10000, "gpw_UN", "GPW_UN", min_value, max_value)

# Arrange the plots using grid.arrange
combined_plot_smooth_line_pg1 <- grid.arrange(scatter_gpw_pg1, scatter_gpw_UN_pg1,scatter_ghsl_pg1,scatter_wp_con_pg1, scatter_wp_uncon_pg1,  
                              nrow = 3, ncol = 2)

# Print the combined plot
print(combined_plot_smooth_line_pg1)
```

#save the plot

```{r}
# Save the plot to a file
ggsave("Plots/combined_plot_smooth_line_pg1.png", plot = combined_plot_smooth_line_pg1, width = 8, height = 6, dpi = 400)
# Save the plot to a file
ggsave("Plots/combined_plot_smooth_line_pl1.png", plot = combined_plot_smooth_line_pl1, width = 8, height = 6, dpi = 400)
```



#load the data with all the population output to an new variable
```{r}
output_path<-("D:/EAGLE/Master_Thesis_Hannes/1/R/Lallu_thesis/all_pop_output/camps_EO")

# Write the camps sf dataframe to the specified location
st_write(camps, file.path(output_path, "camps_eo.shp"))
```
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
#________________________________________________

#___BUILDING STATS__________________________
#!!!5 loading the data from all the building stats

#****after forgetting ms data again loaded as all_build_stat_ms.shp

```{r}
build_stat_path<-("D:/EAGLE/Master_Thesis_Hannes/1/R/Lallu_thesis/all_pop_output/build_stat_inc_ms/all_build_stat_ms.shp")
build_stats_inc<-st_read(build_stat_path)
head(build_stats_inc)
```


#calculating the shape_area of the camp from the geometries of camp_polygons

```{r}

#Calculate the shape area for each camp polygon
build_stats_inc$cl_Shp_a <-st_area(build_stats_inc$geometry)

# Print or view the results
print(build_stats_inc[,c("Name", "cl_Shp_a","Site_Ar")])

# Remove 'units' from the columns
build_stats_inc$cl_Shp_a <- as.numeric(build_stats_inc$cl_Shp_a)
build_stats_inc$Site_Ar <- as.numeric(build_stats_inc$Site_Ar)

# Calculate the difference between 'Calculated_Shape_Area' and 'Site_Ar'
build_stats_inc$Ar_diff <- build_stats_inc$Site_Ar-build_stats_inc$cl_Shp_a

print(build_stats_inc[, c("Name", "cl_Shp_a","Site_Ar","Ar_diff")])
```





#Write out the output with the polygon shapearea for surety

```{r}


# Export the sf object to a shapefile
st_write(build_stats_inc,
 "all_pop_output/build_stat_inc_ms/build_stat_inc_ms_c.shp")
```






```{r}
# Filter camps with high N_INDVID and small cal_Shape_area
check_hipop_lessarea <- camps %>%
  filter(as.numeric(N_INDVI)<10000)
#,Site_Ar<1000
# Print or view the selected camps
print(check_hipop_lessarea[, c("Name", "N_INDVI", "cl_Shp_a","Site_Ar","Site_nm")])
```


# the camp values(BO_S294 has the high population of 224 with less area of 342 sq m)
#  Name N_INDVI cal_Shp_area
<!-- 1  AD_S018    75.0   25822.0515 -->
<!-- 2  BO_S294   224.0     342.7668 -->
<!-- 3  AD_S003  1234.0  104062.6921 -->
<!-- 4  BO_S012  3375.0   17558.3622 -->
<!-- 5  BO_S015  1259.0   39288.4634 -->
<!-- 6  BO_S113  5708.0  256595.9877 -->
<!-- 7  BO_S114   739.0   10824.5435 -->
<!-- 8  BO_S160  2500.0  143393.6697 -->
<!-- 9  BO_S162  1260.0   40156.3581 -->
<!-- 10 BO_S203  9223.0  575925.1669 -->

#another filtering of population >50 and area <1000square gave 3 filters
1 BO_S294     224  342.7668  334.61 POLYGON ((13.19264 11.85126...
2 BO_S265     207 1015.6604  999.93 POLYGON ((13.13323 11.78958...
3 BO_S105     110  985.3237  934.06 POLYGON ((13.13257 11.79066...




#!!Attributes removing code
#!! Run only if needed
```{r}
# attributes_to_remove <- c("cl_Shp_r","Area_Dff");
# 
# # Remove specified attributes
# data1<- data1%>%select(-one_of(attributes_to_remove))

```


#Population density 

```{r}
# Calculate population density

camps$Site_Ar <- as.numeric(camps$Site_Ar)
camps$N_INDVI <- as.numeric(camps$N_INDVI)
camps$st_pp_d <- (camps$N_INDVI) / (camps$Site_Ar)

# Print the result
# Print or view the selected camps
print(camps[, c("Name", "N_INDVI", "Site_Ar","st_pp_d")])

```



#Write out the population density

```{r}


# Export the sf object to a shapefile
st_write(camps,
 "D:/EAGLE/Master_Thesis_Hannes/1/R/Lallu_thesis/all_pop_output/camps_EO/camps_eo1.shp")
```


# loading the data for till density 

```{r}
build_stat_path2<-("D:/EAGLE/Master_Thesis_Hannes/1/R/Lallu_thesis/all_pop_output/camps_EO/camps_eo1.shp")
camps<-st_read(build_stat_path2)
head(camps)
```


#deleting the small camp with high popultion so that there is only 222 camps

```{r}
# Assuming "Name" is the column name where the names are stored
#camps <- subset(camps, Name != "BO_S294")
head(camps)

```



#_____________________


_______________
#******Plots for the EO datasets****************

#_____ALL_BOX_VIOLIN_NO_NEED_____
#BOX+VIOLIN plot for the IOM survey population for different Site Type informal camps


```{r}
# Create a boxplot for N_INDVI
plot_camp_pop <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = N_INDVI, fill = "N_INDVI"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Site Population", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = N_INDVI, fill = "N_INDVI",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site population from IOM survey for different Site Status", x = "Site Status", y = "Site Population") +
  geom_violin(aes(x = Sit_Stt, y = N_INDVI, fill = "N_INDVI"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 9,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)
  #median pointed code if needed
  #  stat_summary(
  #   aes(x = Sit_Stt, y = as.numeric(N_INDVI), fill = "N_INDVI"),
  #   fun = median,
  #   geom = "point",
  #   shape = 23,
  #   size = 2,
  #   color = "black",
  #   position = position_dodge(width = 0.5)
  # )
  
  
 # !!!!if needed to display then have to run the median code below first 
  # geom_text(
  #   data = median_values,
  #   aes(x = Sit_Stt, y = median_ghsl, label = sprintf("%.1f", median_ghsl)),
  #   vjust = -1,
  #   size = 1,
  #   color = "black",
  #   hjust = 0.5
  # ) 
#   # Calculate median values for each Sit_Stt group
# median_values <- camps %>%
#   group_by(Sit_Stt) %>%
#   summarize(median_N_INDVI = median(as.numeric(N_INDVI)))
#   

# stat_summary(
  #   aes(x = Sit_Stt, y = as.numeric(N_INDVI)),
  #   fun = median,
  #   geom = "crossbar",
  #   width = 0.4,
  #   col = "red",
  #   show.legend = FALSE
  # )

print(plot_camp_pop)
```
#Analysis :
1.It is totally evident that the population in the informal survey sites are lesser than that of the formal survey sites
2.One of the outliers for the formal camps ranges greater than 4000 for the site population



#saving the N_INDVI plot 
```{r}
# Save the plot to a file
ggsave("plots/N_INDVI.png", plot = plot_camp_pop, width = 8, height = 6, dpi = 400)
```

#BOX+VIOLIN plot for the calculated ghsl population for classified as formal and informal camps


```{r}
# Create a boxplot for ghsl
ghsl_plot <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = as.numeric(ghsl), fill = "ghsl"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Calculated GHSL Population", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = as.numeric(ghsl), fill ="ghsl",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site population calculated from GHS POP  for different Site Status", x = "Site Status", y = "Calculated GHSL Population") +
  geom_violin(aes(x = Sit_Stt, y = as.numeric(ghsl), fill = "ghsl"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 9,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)

print(ghsl_plot)
  
```
#saving the ghsl plot 
```{r}
# Save the plot to a file
ggsave("plots/ghsl_box.png", plot = ghsl_plot, width = 8, height = 6, dpi = 400)
```


#BOX+VIOLIN plot for the calculated Worldpop(Unconstrained) population for classified as formal and informal camps


```{r}
# Create a boxplot for wp_unconstrained
wp_u_plot <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = as.numeric(wp_uc), fill = "wp_uc"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Calculated worldpop Population(unconstrained)", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = as.numeric(wp_uc), fill ="wp_uc",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site population calculated from Worlpop(Unconstrained) for different Site Status", x = "Site Status", y = "Calculated worldpop Population(unconstrained)") +
  geom_violin(aes(x = Sit_Stt, y = as.numeric(wp_uc), fill = "wp_uc"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 9,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)

print(wp_u_plot)
```

#saving the wp_uc plot 
```{r}
# Save the plot to a file
ggsave("plots/box_wp_uc.png", plot = wp_u_plot, width = 8, height = 6, dpi = 400)
```

#BOX+VIOLIN plot for the calculated Worldpop(constrained) population for classified as formal and informal camps

```{r}
# Create a boxplot for wp_constrained
wp_c_plot <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = as.numeric(wp_c), fill = "wp_c"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Calculated worldpop Population(Constrained)", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = as.numeric(wp_c), fill ="wp_c",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site population calculated from Worlpop(Constrained) for different Site Status", x = "Site Status", y = "Calculated worldpop Population(Constrained)") +
  geom_violin(aes(x = Sit_Stt, y = as.numeric(wp_c), fill = "wp_c"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 9,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)

print(wp_c_plot)
```
#saving the wp_c plot 
```{r}
# Save the plot to a file
ggsave("plots/box_wp_c.png", plot = wp_c_plot, width = 8, height = 6, dpi = 400)
```

#BOX+VIOLIN plot for the calculated GPW population for different site status

```{r}
# Create a boxplot forgpw
gpw_plot <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = as.numeric(gpw), fill = "gpw"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Calculated GPW population", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = as.numeric(gpw), fill ="gpw",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site population calculated from GPW data for different Site Status", x = "Site Status", y = "Calculated GPW population") +
  geom_violin(aes(x = Sit_Stt, y = as.numeric(gpw), fill = "gpw"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 9,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)

print(gpw_plot)
```


#saving the gpw plot 
```{r}
# Save the plot to a file
ggsave("plots/box_gpw.png", plot =gpw_plot, width = 8, height = 6, dpi = 400)
```


#**BUILDING DATA PLOTS*************

#BOX+VIOLIN plot for number of households in Survey data  for different site status

```{r}
N_HHplot <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = as.numeric(N_HH), fill = "N_HH"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Survey Household number", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = as.numeric(N_HH), fill ="N_HH",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site IOM surveyed household numbers", x = "Site Status", y = "Surveyed household number") +
  geom_violin(aes(x = Sit_Stt, y = as.numeric(N_HH), fill = "N_HH"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 7,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)

print(N_HHplot)
```

#saving the google building count plot 
```{r}
# Save the plot to a file
ggsave("plots/N_HHplot.png", plot =N_HHplot, width = 8, height = 6, dpi = 400)
```



#BOX+VIOLIN plot for calculated buildings in Google building footprint data for different site status


```{r}
goog_plot <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = as.numeric(g_b_c), fill = "g_b_c"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Calculated Building count form GOOGLE data", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = as.numeric(g_b_c), fill ="g_b_c",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site building count calculated from Google building data for different Site Status", x = "Site Status", y = "Calculated Google building count") +
  geom_violin(aes(x = Sit_Stt, y = as.numeric(g_b_c), fill = "g_b_c"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 7,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)

print(goog_plot)
```

#saving the google building count plot 
```{r}
# Save the plot to a file
ggsave("plots/box_goog.png", plot =goog_plot, width = 8, height = 6, dpi = 400)
```

#BOX+VIOLIN plot for calculated buildings in OSM building footprint data for different site status

```{r}
osm_plot <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = as.numeric(osm_b_c), fill = "osm_b_c"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Calculated Building count form Open Street Map data", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = as.numeric(osm_b_c), fill ="osm_b_c",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site building count calculated from Open Street map building data for different Site Status", x = "Site Status", y = "Calculated Open Street Map building count") +
  geom_violin(aes(x = Sit_Stt, y = as.numeric(osm_b_c), fill = "osm_b_c"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 7,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)

print(osm_plot)
```
#saving the OSM building count plot 
```{r}
# Save the plot to a file
ggsave("plots/box_osm.png", plot =osm_plot, width = 8, height = 6, dpi = 400)
```

#BOX+VIOLIN plot for calculated buildings in Microsoft building footprint data for different site status

```{r}
msplot <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = as.numeric(ms_b_c), fill = "ms_b_c"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Calculated Building count form Microsoft data", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = as.numeric(ms_b_c), fill ="ms_b_c",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site building count calculated from Microsoft building data for different Site Status", x = "Site Status", y = "Calculated Microsoft building count") +
  geom_violin(aes(x = Sit_Stt, y = as.numeric(ms_b_c), fill = "ms_b_c"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 7,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)

print(msplot)
```

#saving the Microsoft building count plot 
```{r}
# Save the plot to a file
ggsave("plots/box_ms.png", plot =msplot, width = 8, height = 6, dpi = 400)
```


#BOX+VIOLIN plot for calculated buildings in vida MS_gOOGLE data for different site status

```{r}
vida_plot <- ggplot(camps) + 
  geom_boxplot(aes(x = Sit_Stt, y = as.numeric(vida_b_c), fill = "vida_b_c"), alpha = 0.2, width = 0.5) +
  #scale_fill_viridis`(discrete = TRUE, alpha = 0.6) +
  scale_fill_viridis_d(name = "Calculated Building count form Vida Google-Microsoft data", alpha = 0.6) +
  theme_ipsum()+
  geom_jitter(aes(x = Sit_Stt, y = as.numeric(vida_b_c), fill ="vida_b_c",color = Sit_Stt), size = 0.2, alpha = 0.9,show.legend = FALSE) +
  coord_flip() +
  labs(title = "Refugee site building count calculated from Vida Google-Microsoft building data for different Site Status", x = "Site Status", y = "Calculated Microsoft building count") +
  geom_violin(aes(x = Sit_Stt, y = as.numeric(vida_b_c), fill = "vida_b_c"), alpha = 0.3) +
  
  theme(plot.title = element_text(size = 7,color="Blue",hjust=0.5),
        axis.title.x = element_text(size = 6,hjust = 0.5),
        axis.title.y=element_text(size = 6,hjust = 0.5),
        axis.text.x = element_text(size=5),
        axis.text.y=element_text(size = 5),
        )+ guides(fill = FALSE)

print(vida_plot)
```


#saving the vida building count plot 
```{r}
# Save the plot to a file
ggsave("plots/box_vida.png", plot =vida_plot, width = 8, height = 6, dpi = 400)
```

#________________________________________________
#________________________________________________
#POP_CORRELATION

```{r}
# Convert numeric variables from character to numeric
# Convert numeric variables from character to numeric
camps$N_INDVI <- as.numeric(camps$N_INDVI)
camps$ghsl <- as.numeric(camps$ghsl)
camps$wp_c <- as.numeric(camps$wp_c)
camps$wp_uc<- as.numeric(camps$wp_uc)
camps$gpw <- as.numeric(camps$gpw)
camps$gpw_UN<-as.numeric(camps$gpw_UN)


# Check the data types again
str(camps[, c("N_INDVI", "ghsl", "wp_c", "wp_uc", "gpw","gpw_UN")])

# Check for missing values
summary(camps[, c("N_INDVI", "ghsl", "wp_c", "wp_uc", "gpw","gpw_UN")])

# Calculate correlation coefficients
corr_ghsl <- cor(camps$N_INDVI,camps$ghsl)
corr_wp_c<-cor(camps$N_INDVI,camps$wp_c)
corr_wp_uc<-cor(camps$N_INDVI,camps$wp_uc)
corr_gpw<-cor(camps$N_INDVI,camps$gpw)
corr_gpw_UN<-cor(camps$N_INDVI,camps$gpw_UN)
# View correlation coefficients

print(paste("GHSL:",corr_ghsl))
print(paste("wp_uc:",corr_wp_uc))
print(paste("wp_c",corr_wp_c))
print(paste("gpw:",corr_gpw))
print(paste("gpw_UN:",corr_gpw_UN))

# [1] "GHSL: 0.669789737777376"
# [1] "wp_uc: 0.624792200593656"
# [1] "wp_c 0.551139435664867"
# [1] "gpw: 0.155070313136419"
# [1] "gpw_UN: 0.154896612345902"


```
#doing the correlation matrix n_indvi and estimated populations

```{r}
# Create a matrix of correlation coefficients
cor_matrix <- matrix(c(corr_ghsl, corr_wp_c, corr_wp_uc, corr_gpw,corr_gpw_UN),
                     nrow = 1, byrow = TRUE,
                     dimnames = list(c("N_INDVI"), c("ghsl", "wp_c", "wp_uc", "gpw","gpw_UN")))

# Plot the correlation matrix
corrplot(cor_matrix, method = "color", type = "upper", 
         addCoef.col = "black", tl.col = "black", tl.srt = 45)
```





#Coorelation matrix calculation
```{r}
# Convert spatial object to data frame without geometry
camps_data_nogeom <- st_drop_geometry(camps)

# Define numeric columns
numeric_cols <- c("N_INDVI","N_HH", "ghsl", "wp_c", "wp_uc", "gpw","gpw_UN")

# Convert selected columns to numeric, handling non-numeric values
for (col in numeric_cols) {
  camps_data_nogeom[[col]] <- as.numeric(as.character(camps_data_nogeom[[col]]))
}

# Calculate correlation coefficients
correlation_matrix <- cor(camps_data_nogeom[, numeric_cols])
print(correlation_matrix)
```
# Analysis correlation matrix
N_INDVI vs. ghsl: The correlation coefficient is 0.6701, indicating a moderate positive correlation between N_INDVI and ghsl.
N_INDVI vs. wp_con: The correlation coefficient is 0.6251, indicating a moderate positive correlation between N_INDVI and wp_con.
ghsl vs. wp_con: The correlation coefficient is 0.8905, indicating a strong positive correlation between ghsl and wp_con.
wp_uncon vs. N_INDVI: The correlation coefficient is 0.5516, indicating a moderate positive correlation between wp_uncon and N_INDVI.
wp_uncon vs. ghsl: The correlation coefficient is 0.6079, indicating a moderate positive correlation between wp_uncon and ghsl.
wp_uncon vs. wp_con: The correlation coefficient is 0.6640, indicating a moderate positive correlation between wp_uncon and wp_con.
gpw vs. N_INDVI: The correlation coefficient is 0.1556, indicating a weak positive correlation between gpw and N_INDVI.
gpw vs. ghsl: The correlation coefficient is 0.1361, indicating a weak positive correlation between gpw and ghsl.
gpw vs. wp_con: The correlation coefficient is 0.1953, indicating a weak positive correlation between gpw and wp_con.
wp_uncon vs. gpw: The correlation coefficient is 0.7454, indicating a strong positive correlation between wp_uncon and gpw.

#Heat map of correlation matrix



```{r}


# Convert the correlation matrix to a dataframe
corr_matrix <- correlation_matrix
# Assign row and column names
rownames(corr_matrix) <- colnames(corr_matrix) <- c("N_INDVI","N_HH", "ghsl", "wp_con", "wp_uncon", "gpw","gpw_UN")
# Convert the correlation matrix to long format
corr_matrix_long <- melt(corr_matrix)



# Plot the heatmap with lighter color and correlation values
heat_map_corr <- ggplot(data = corr_matrix_long, aes(x = Var1, y = Var2, fill = value, label = round(value, 2))) +
  geom_tile(color = "white") +
  geom_text(color = "black", size = 2) +
  scale_fill_gradient(low = "lightblue", high = "lightcoral") +
  labs(title = "Correlation Matrix Heatmap ",
       x = "Variables",
       y = "Variables") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

print(heat_map_corr)

```


#Analysis heat map

N_INDVI (Survey Population):

Strong positive correlation with ghsl (0.67), indicating that areas with higher surveyed population tend to have higher estimated population according to the Global Human Settlement Layer (GHSL).
Moderate positive correlation with wp_con (0.63) and wp_uncon (0.55), suggesting that areas with higher surveyed population (N_INDVI) also tend to have higher estimated world population, both constrained and unconstrained.
GHSL (Global Human Settlement Layer):

Strong positive correlation with N_INDVI (0.67), indicating that areas with higher estimated population according to GHSL tend to have higher surveyed population.
Strong positive correlation with wp_con (0.89) and wp_uncon (0.61), suggesting that areas with higher estimated population according to GHSL also tend to have higher estimated world population, both constrained and unconstrained.
WP_CON (World Population Constrained):

Moderate positive correlation with N_INDVI (0.63) and ghsl (0.89), indicating that areas with higher surveyed population and higher estimated population according to GHSL also tend to have higher estimated world population (constrained).
Strong positive correlation with wp_uncon (0.66), suggesting that areas with higher estimated world population (unconstrained) tend to have higher estimated world population (constrained).
WP_UNCON (World Population Unconstrained):

Moderate positive correlation with N_INDVI (0.55) and ghsl (0.61), indicating that areas with higher surveyed population and higher estimated population according to GHSL also tend to have higher estimated world population (unconstrained).
Strong positive correlation with wp_con (0.66), suggesting that areas with higher estimated world population (constrained) tend to have higher estimated world population (unconstrained).
GPW (Gridded Population of the World):

Weak positive correlation with N_INDVI (0.16) and ghsl (0.14), suggesting a limited relationship between GPW and surveyed population or estimated population according to GHSL.
Weak positive correlation with wp_con (0.20) and wp_uncon (0.75), indicating a slight association with estimated world population, especially in unconstrained conditions.
GPW_UN (Gridded Population of the World Unconstrained):

Weak positive correlation with N_INDVI (0.16) and ghsl (0.14), similar to GPW, indicating a limited relationship with surveyed population or estimated population according to GHSL.
Strong positive correlation with wp_con (0.20) and wp_uncon (0.75), similar to GPW, suggesting a notable association with estimated world population, particularly in unconstrained conditions.




#Save heat map coorelation matrix

```{r}
# Save the plot to a file
ggsave("Plots/heat_map_corr.png", plot =heat_map_corr, width = 8, height = 6, dpi = 400)
```

#A<10000 Correlation(calculation correlation for N_INDVI and Estimated for area less than 10,000)
```{r}
#correlation for the area>10000msq and area<10000msq

subset_data_2$N_INDVI <- as.numeric(subset_data_2$N_INDVI)
subset_data_2$ghsl <- as.numeric(subset_data_2$ghsl)
subset_data_2$wp_c <- as.numeric(subset_data_2$wp_c)
subset_data_2$wp_uc<- as.numeric(subset_data_2$wp_uc)
subset_data_2$gpw <- as.numeric(subset_data_2$gpw_UN)


# Calculate correlation coefficients
corr_ghsl_areal <- cor(subset_data_2$N_INDVI,subset_data_2$ghsl)
corr_wp_c_areal <-cor(subset_data_2$N_INDVI,subset_data_2$wp_c)
corr_wp_uc_areal <-cor(subset_data_2$N_INDVI,subset_data_2$wp_uc)
corr_gpw_areal <-cor(subset_data_2$N_INDVI,subset_data_2$gpw)
corr_gpw_UN_areal <-cor(subset_data_2$N_INDVI,subset_data_2$gpw_UN)
# View correlation coefficients

print(paste("GHSL:",corr_ghsl_areal))
print(paste("wp_uc:",corr_wp_uc_areal))
print(paste("wp_c",corr_wp_c_areal))
print(paste("gpw:",corr_gpw_areal))
print(paste("gpw_UN:",corr_gpw_UN_areal))

# [1] "GHSL: 0.0213130853907562"
# [1] "wp_uc: 0.233885533437088"
# [1] "wp_c 0.125185506026443"
# [1] "gpw: 0.0566241801378073"
# [1] "gpw_UN: 0.0566241801378073"
```

# one line corr_mtrix doing the correlation matrix n_indvi and estimated populations for area<10000

```{r}
# Create a matrix of correlation coefficients
cor_matrix_areal <- matrix(c(corr_ghsl_areal, corr_wp_c_areal, corr_wp_uc_areal, corr_gpw_areal,corr_gpw_UN_areal),
                     nrow = 1, byrow = TRUE,
                     dimnames = list(c("N_INDVI"), c("ghsl", "wp_c", "wp_uc", "gpw","gpw_UN")))

# Plot the correlation matrix
corrplot(cor_matrix_areal , method = "color", type = "upper", 
         addCoef.col = "black", tl.col = "black", tl.srt = 45)
```


#A>10000 Correlation(calculation correlation for N_INDVI and Estimated for area greater than 10,000)
```{r}
#correlation for the area>10000msq and area<10000msq

subset_data$N_INDVI <- as.numeric(subset_data$N_INDVI)
subset_data$ghsl <- as.numeric(subset_data$ghsl)
subset_data$wp_c <- as.numeric(subset_data$wp_c)
subset_data$wp_uc<- as.numeric(subset_data$wp_uc)
subset_data$gpw <- as.numeric(subset_data$gpw_UN)


# Calculate correlation coefficients
corr_ghsl_areag <- cor(subset_data$N_INDVI,subset_data$ghsl)
corr_wp_c_areag <-cor(subset_data$N_INDVI,subset_data$wp_c)
corr_wp_uc_areag <-cor(subset_data$N_INDVI,subset_data$wp_uc)
corr_gpw_areag <-cor(subset_data$N_INDVI,subset_data$gpw)
corr_gpw_UN_areag <-cor(subset_data$N_INDVI,subset_data$gpw_UN)
# View correlation coefficients

print(paste("GHSL:",corr_ghsl_areag))
print(paste("wp_uc:",corr_wp_uc_areag))
print(paste("wp_c",corr_wp_c_areag))
print(paste("gpw:",corr_gpw_areag))
print(paste("gpw_UN:",corr_gpw_UN_areag))

# [1] "GHSL: 0.642902555892121"
# [1] "wp_uc: 0.593267199366151"
# [1] "wp_c 0.50654517342998"
# [1] "gpw: 0.112049137071047"
# [1] "gpw_UN: 0.112049137071047"
```

# one line corr_mtrix doing the correlation matrix n_indvi and estimated populations for area>10000

```{r}
# Create a matrix of correlation coefficients
cor_matrix_areag <- matrix(c(corr_ghsl_areag, corr_wp_c_areag, corr_wp_uc_areag, corr_gpw_areag,corr_gpw_UN_areag),
                     nrow = 1, byrow = TRUE,
                     dimnames = list(c("N_INDVI"), c("ghsl", "wp_c", "wp_uc", "gpw","gpw_UN")))

# Plot the correlation matrix
corrplot(cor_matrix_areag , method = "color", type = "upper", 
         addCoef.col = "black", tl.col = "black", tl.srt = 45)
```

#Correlation pop>10000

```{r}
#correlation for the area>10000msq and area<10000msq

campsgt10000$N_INDVI <- as.numeric(campsgt10000$N_INDVI)
campsgt10000$ghsl <- as.numeric(campsgt10000$ghsl)
campsgt10000$wp_c <- as.numeric(campsgt10000$wp_c)
campsgt10000$wp_uc<- as.numeric(campsgt10000$wp_uc)
campsgt10000$gpw <- as.numeric(campsgt10000$gpw_UN)


# Calculate correlation coefficients
corr_ghsl_pg <- cor(campsgt10000$N_INDVI,campsgt10000$ghsl)
corr_wp_c_pg <-cor(campsgt10000$N_INDVI,campsgt10000$wp_c)
corr_wp_uc_pg <-cor(campsgt10000$N_INDVI,campsgt10000$wp_uc)
corr_gpw_pg <-cor(campsgt10000$N_INDVI,campsgt10000$gpw)
corr_gpw_UN_pg <-cor(campsgt10000$N_INDVI,campsgt10000$gpw_UN)
# View correlation coefficients

print(paste("GHSL:",corr_ghsl_pg))
print(paste("wp_uc:",corr_wp_uc_pg))
print(paste("wp_c",corr_wp_c_pg))
print(paste("gpw:",corr_gpw_pg))
print(paste("gpw_UN:",corr_gpw_UN_pg))

# [1] "GHSL: 0.642902555892121"
# [1] "wp_uc: 0.593267199366151"
# [1] "wp_c 0.50654517342998"
# [1] "gpw: 0.112049137071047"
# [1] "gpw_UN: 0.112049137071047"
```

```{r}
# Create a matrix of correlation coefficients
cor_matrix_pg <- matrix(c(corr_ghsl_pg, corr_wp_c_pg, corr_wp_uc_pg, corr_gpw_pg,corr_gpw_UN_pg),
                     nrow = 1, byrow = TRUE,
                     dimnames = list(c("N_INDVI"), c("ghsl", "wp_c", "wp_uc", "gpw","gpw_UN")))

# Plot the correlation matrix
corrplot(cor_matrix_pg , method = "color", type = "upper", 
         addCoef.col = "black", tl.col = "black", tl.srt = 45)
```
#P<10000 Correlation(calculation correlation for N_INDVI and Estimated for population less than 10,000)
```{r}
#correlation for the pop<10000 and 
campls10000$N_INDVI <- as.numeric(campls10000$N_INDVI)
campls10000$ghsl <- as.numeric(campls10000$ghsl)
campls10000$wp_c <- as.numeric(campls10000$wp_c)
campls10000$wp_uc<- as.numeric(campls10000$wp_uc)
campls10000$gpw <- as.numeric(campls10000$gpw_UN)


# Calculate correlation coefficients
corr_ghsl_pl <- cor(campls10000$N_INDVI,campls10000$ghsl)
corr_wp_c_pl <-cor(campls10000$N_INDVI,campls10000$wp_c)
corr_wp_uc_pl <-cor(campls10000$N_INDVI,campls10000$wp_uc)
corr_gpw_pl <-cor(campls10000$N_INDVI,campls10000$gpw)
corr_gpw_UN_pl <-cor(campls10000$N_INDVI,campls10000$gpw_UN)
# View correlation coefficients

print(paste("GHSL:",corr_ghsl_pl))
print(paste("wp_uc:",corr_wp_uc_pl))
print(paste("wp_c",corr_wp_c_pl))
print(paste("gpw:",corr_gpw_pl))
print(paste("gpw_UN:",corr_gpw_UN_pl))

# [1] "GHSL: 0.394858142687066"
# [1] "wp_uc: 0.496829664295204"
# [1] "wp_c 0.303849036966698"
# [1] "gpw: 0.0717318653127183"
# [1] "gpw_UN: 0.0717318653127183"

```

```{r}
# Create a matrix of correlation coefficients
cor_matrix_pl <- matrix(c(corr_ghsl_pl, corr_wp_c_pl, corr_wp_uc_pl, corr_gpw_pl,corr_gpw_UN_pl),
                     nrow = 1, byrow = TRUE,
                     dimnames = list(c("N_INDVI"), c("ghsl", "wp_c", "wp_uc", "gpw","gpw_UN")))

# Plot the correlation matrix
corrplot(cor_matrix_pl , method = "color", type = "upper", 
         addCoef.col = "black", tl.col = "black", tl.srt = 45)
```


#formal camp_correlation
```{r}
# Create a matrix of correlation coefficients
cor_matrix_f <- matrix(c(corr_ghsl_f, corr_wp_c_f, corr_wp_uc_f, corr_gpw_f,corr_gpw_UN_f),
                     nrow = 1, byrow = TRUE,
                     dimnames = list(c("N_INDVI"), c("ghsl", "wp_c", "wp_uc", "gpw","gpw_UN")))

# Plot the correlation matrix
corrplot(cor_matrix_f, method = "color", type = "upper", 
         addCoef.col = "black", tl.col = "black", tl.srt = 45)
```


#informal camp_correlation
```{r}
# Create a matrix of correlation coefficients
cor_matrix_inf <- matrix(c(corr_ghsl_inf, corr_wp_c_inf, corr_wp_uc_inf, corr_gpw_inf,corr_gpw_UN_inf),
                     nrow = 1, byrow = TRUE,
                     dimnames = list(c("N_INDVI"), c("ghsl", "wp_c", "wp_uc", "gpw","gpw_UN")))

# Plot the correlation matrix
corrplot(cor_matrix_inf, method = "color", type = "upper", 
         addCoef.col = "black", tl.col = "black", tl.srt = 45)
```


#___CORR POP END______________
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@


#__CORR HOUSEHOLD____
#cor(survey hh and estimated pop)

```{r}

camps$N_HH <- as.numeric(camps$N_HH)
camps$ghsl <- as.numeric(camps$ghsl)
camps$wp_c <- as.numeric(camps$wp_c)
camps$wp_uc<- as.numeric(camps$wp_uc)
camps$gpw <- as.numeric(camps$gpw)
camps$gpw_UN<-as.numeric(camps$gpw_UN)


# Check the data types again
str(camps[, c("N_HH", "ghsl", "wp_c", "wp_uc", "gpw","gpw_UN")])

# Check for missing values
summary(camps[, c("N_HH", "ghsl", "wp_c", "wp_uc", "gpw","gpw_UN")])

# Calculate correlation coefficients
corr_ghsl_HH <- cor(camps$N_HH,camps$ghsl)
corr_wp_c_HH<-cor(camps$N_HH,camps$wp_c)
corr_wp_uc_HH<-cor(camps$N_HH,camps$wp_uc)
corr_gpw_HH<-cor(camps$N_HH,camps$gpw)
corr_gpw_UN_HH<-cor(camps$N_HH,camps$gpw_UN)
# View correlation coefficients

print(paste("GHSL:",corr_ghsl_HH))
print(paste("wp_uc:",corr_wp_uc_HH))
print(paste("wp_c",corr_wp_c_HH))
print(paste("gpw:",corr_gpw_HH))
print(paste("gpw_UN:",corr_gpw_UN_HH))

# [1] "GHSL: 0.694545351305014"
# [1] "wp_uc: 0.618515091659853"
# [1] "wp_c 0.523798604122295"
# [1] "gpw: 0.101174748926628"
# [1] "gpw_UN: 0.101001439700283"
```

```{r}
# Create a matrix of correlation coefficients
cor_matrix_hh <- matrix(c(corr_ghsl_HH, corr_wp_c_HH, corr_wp_uc_HH, corr_gpw_HH,corr_gpw_UN_HH),
                     nrow = 1, byrow = TRUE,
                     dimnames = list(c("N_HH"), c("ghsl", "wp_c", "wp_uc", "gpw","gpw_UN")))

# Plot the correlation matrix
corrplot(cor_matrix_hh, method = "color", type = "upper", 
         addCoef.col = "black", tl.col = "black", tl.srt = 45)
```
#A<10000 Correlation(calculation correlation for N_HH and Estimated for area less than 10,000)
```{r}
#correlation for the area>10000msq and area<10000msq

subset_data_2$N_HH<- as.numeric(subset_data_2$N_HH)
subset_data_2$ghsl <- as.numeric(subset_data_2$ghsl)
subset_data_2$wp_c <- as.numeric(subset_data_2$wp_c)
subset_data_2$wp_uc<- as.numeric(subset_data_2$wp_uc)
subset_data_2$gpw <- as.numeric(subset_data_2$gpw_UN)


# Calculate correlation coefficients
corr_ghsl_areal_hh <- cor(subset_data_2$N_HH,subset_data_2$ghsl)
corr_wp_c_areal_hh <-cor(subset_data_2$N_HH,subset_data_2$wp_c)
corr_wp_uc_areal_hh <-cor(subset_data_2$N_HH,subset_data_2$wp_uc)
corr_gpw_areal_hh <-cor(subset_data_2$N_HH,subset_data_2$gpw)
corr_gpw_UN_areal_hh <-cor(subset_data_2$N_HH,subset_data_2$gpw_UN)
# View correlation coefficients

print(paste("GHSL:",corr_ghsl_areal_hh))
print(paste("wp_uc:",corr_wp_uc_areal_hh))
print(paste("wp_c",corr_wp_c_areal_hh))
print(paste("gpw:",corr_gpw_areal_hh))
print(paste("gpw_UN:",corr_gpw_UN_areal_hh))

# [1] "GHSL: 0.0735245533503374"
# [1] "wp_uc: 0.258855419585444"
# [1] "wp_c 0.233787523829022"
# [1] "gpw: 0.129592074410419"
# [1] "gpw_UN: 0.129592074410419"
```

# one line corr_mtrix doing the correlation matrix n_indvi and estimated populations for area<10000

```{r}
# Create a matrix of correlation coefficients
cor_matrix_areal_hh <- matrix(c(corr_ghsl_areal_hh, corr_wp_c_areal_hh, corr_wp_uc_areal_hh, corr_gpw_areal_hh,corr_gpw_UN_areal_hh),
                     nrow = 1, byrow = TRUE,
                     dimnames = list(c("N_HH"), c("ghsl", "wp_c", "wp_uc", "gpw","gpw_UN")))

# Plot the correlation matrix
corrplot(cor_matrix_areal_hh , method = "color", type = "upper", 
         addCoef.col = "black", tl.col = "black", tl.srt = 45)
```
#A>10000 Correlation(calculation correlation for N_HH and Estimated for area greater than 10,000)
```{r}
#correlation for the area>10000msq and area<10000msq

subset_data$N_HH<- as.numeric(subset_data$N_HH)
subset_data$ghsl <- as.numeric(subset_data$ghsl)
subset_data$wp_c <- as.numeric(subset_data$wp_c)
subset_data$wp_uc<- as.numeric(subset_data$wp_uc)
subset_data$gpw <- as.numeric(subset_data$gpw_UN)


# Calculate correlation coefficients
corr_ghsl_areag_hh <- cor(subset_data$N_HH,subset_data$ghsl)
corr_wp_c_areag_hh <-cor(subset_data$N_HH,subset_data$wp_c)
corr_wp_uc_areag_hh <-cor(subset_data$N_HH,subset_data$wp_uc)
corr_gpw_areag_hh <-cor(subset_data$N_HH,subset_data$gpw)
corr_gpw_UN_areag_hh <-cor(subset_data$N_HH,subset_data$gpw_UN)
# View correlation coefficients

print(paste("GHSL:",corr_ghsl_areag_hh))
print(paste("wp_uc:",corr_wp_uc_areag_hh))
print(paste("wp_c",corr_wp_c_areag_hh))
print(paste("gpw:",corr_gpw_areag_hh))
print(paste("gpw_UN:",corr_gpw_UN_areag_hh))

# [1] "GHSL: 0.670731723075656"
# [1] "wp_uc: 0.587894390835026"
# [1] "wp_c 0.479422951378752"
# [1] "gpw: 0.0576024744490923"
# [1] "gpw_UN: 0.0576024744490923"
```

# one line corr_mtrix doing the correlation matrix n_indvi and estimated populations for area>10000

```{r}
# Create a matrix of correlation coefficients
cor_matrix_areag_hh <- matrix(c(corr_ghsl_areag_hh, corr_wp_c_areag_hh, corr_wp_uc_areag_hh, corr_gpw_areag_hh,corr_gpw_UN_areag_hh),
                     nrow = 1, byrow = TRUE,
                     dimnames = list(c("N_HH"), c("ghsl", "wp_c", "wp_uc", "gpw","gpw_UN")))

# Plot the correlation matrix
corrplot(cor_matrix_areag_hh , method = "color", type = "upper", 
         addCoef.col = "black", tl.col = "black", tl.srt = 45)
```

#Correlation hhh pop>10000

```{r}
#correlation for the area>10000msq and area<10000msq

campsgt10000$N_HH <- as.numeric(campsgt10000$N_HH)
campsgt10000$ghsl <- as.numeric(campsgt10000$ghsl)
campsgt10000$wp_c <- as.numeric(campsgt10000$wp_c)
campsgt10000$wp_uc<- as.numeric(campsgt10000$wp_uc)
campsgt10000$gpw <- as.numeric(campsgt10000$gpw_UN)


# Calculate correlation coefficients
corr_ghsl_pg_hh <- cor(campsgt10000$N_HH,campsgt10000$ghsl)
corr_wp_c_pg_hh <-cor(campsgt10000$N_HH,campsgt10000$wp_c)
corr_wp_uc_pg_hh <-cor(campsgt10000$N_HH,campsgt10000$wp_uc)
corr_gpw_pg_hh <-cor(campsgt10000$N_HH,campsgt10000$gpw)
corr_gpw_UN_pg_hh <-cor(campsgt10000$N_HH,campsgt10000$gpw_UN)
# View correlation coefficients

print(paste("GHSL:",corr_ghsl_pg_hh))
print(paste("wp_uc:",corr_wp_uc_pg_hh))
print(paste("wp_c",corr_wp_c_pg_hh))
print(paste("gpw:",corr_gpw_pg_hh))
print(paste("gpw_UN:",corr_gpw_UN_pg_hh))
# 
# [1] "GHSL: 0.626456167079001"
# [1] "wp_uc: 0.435672063691939"
# [1] "wp_c 0.221383934519847"
# [1] "gpw: -0.2373029109329"
# [1] "gpw_UN: -0.2373029109329"
```

```{r}
# Create a matrix of correlation coefficients
cor_matrix_pg_hh <- matrix(c(corr_ghsl_pg_hh, corr_wp_c_pg_hh, corr_wp_uc_pg_hh, corr_gpw_pg_hh,corr_gpw_UN_pg_hh),
                     nrow = 1, byrow = TRUE,
                     dimnames = list(c("N_HH"), c("ghsl", "wp_c", "wp_uc", "gpw","gpw_UN")))

# Plot the correlation matrix
corrplot(cor_matrix_pg , method = "color", type = "upper", 
         addCoef.col = "black", tl.col = "black", tl.srt = 45)
```
#P<10000 Correlation(calculation correlation for N_HH and Estimated for population less than 10,000)
```{r}
#correlation for the pop<10000 and 
campls10000$N_HH <- as.numeric(campls10000$N_HH)
campls10000$ghsl <- as.numeric(campls10000$ghsl)
campls10000$wp_c <- as.numeric(campls10000$wp_c)
campls10000$wp_uc<- as.numeric(campls10000$wp_uc)
campls10000$gpw <- as.numeric(campls10000$gpw_UN)


# Calculate correlation coefficients
corr_ghsl_pl_hh <- cor(campls10000$N_HH,campls10000$ghsl)
corr_wp_c_pl_hh <-cor(campls10000$N_HH,campls10000$wp_c)
corr_wp_uc_pl_hh <-cor(campls10000$N_HH,campls10000$wp_uc)
corr_gpw_pl_hh <-cor(campls10000$N_HH,campls10000$gpw)
corr_gpw_UN_pl_hh <-cor(campls10000$N_HH,campls10000$gpw_UN)
# View correlation coefficients

print(paste("GHSL:",corr_ghsl_pl_hh))
print(paste("wp_uc:",corr_wp_uc_pl_hh))
print(paste("wp_c",corr_wp_c_pl_hh))
print(paste("gpw:",corr_gpw_pl_hh))
print(paste("gpw_UN:",corr_gpw_UN_pl_hh))

# [1] "GHSL: 0.302281019187766"
# [1] "wp_uc: 0.332565256451791"
# [1] "wp_c 0.213400682368705"
# [1] "gpw: 0.0340064921223657"
# [1] "gpw_UN: 0.0340064921223657"

```

```{r}
# Create a matrix of correlation coefficients
cor_matrix_pl_hh <- matrix(c(corr_ghsl_pl_hh, corr_wp_c_pl_hh, corr_wp_uc_pl_hh, corr_gpw_pl_hh,corr_gpw_UN_pl_hh),
                     nrow = 1, byrow = TRUE,
                     dimnames = list(c("N_HH"), c("ghsl", "wp_c", "wp_uc", "gpw","gpw_UN")))

# Plot the correlation matrix
corrplot(cor_matrix_pl , method = "color", type = "upper", 
         addCoef.col = "black", tl.col = "black", tl.srt = 45)
```


#formal camp_correlation with household
```{r}
formal_camps$N_HH <- as.numeric(formal_camps$N_HH)
formal_camps$ghsl <- as.numeric(formal_camps$ghsl)
formal_camps$wp_c <- as.numeric(formal_camps$wp_c)
formal_camps$wp_uc<- as.numeric(formal_camps$wp_uc)
formal_camps$gpw <- as.numeric(formal_camps$gpw)
formal_camps$gpw_UN<-as.numeric(formal_camps$gpw_UN)


# Calculate correlation coefficients
corr_ghsl_HH_f <- cor(formal_camps$N_HH,formal_camps$ghsl)
corr_wp_c_HH_f<-cor(formal_camps$N_HH,formal_camps$wp_c)
corr_wp_uc_HH_f<-cor(formal_camps$N_HH,formal_camps$wp_uc)
corr_gpw_HH_f<-cor(formal_camps$N_HH,formal_camps$gpw)
corr_gpw_UN_HH_f<-cor(formal_camps$N_HH,formal_camps$gpw_UN)
# View correlation coefficients

print(paste("GHSL:",corr_ghsl_HH_f))
print(paste("wp_uc:",corr_wp_uc_HH_f))
print(paste("wp_c",corr_wp_c_HH_f))
print(paste("gpw:",corr_gpw_HH_f))
print(paste("gpw_UN:",corr_gpw_UN_HH_f))

# [1] "GHSL: 0.694545351305014"
# [1] "wp_uc: 0.618515091659853"
# [1] "wp_c 0.523798604122295"
# [1] "gpw: 0.101174748926628"
# [1] "gpw_UN: 0.101001439700283"
```

```{r}
# Create a matrix of correlation coefficients
cor_matrix_hh_f <- matrix(c(corr_ghsl_HH_f, corr_wp_c_HH_f, corr_wp_uc_HH_f, corr_gpw_HH_f,corr_gpw_UN_HH_f),
                     nrow = 1, byrow = TRUE,
                     dimnames = list(c("N_HH"), c("ghsl", "wp_c", "wp_uc", "gpw","gpw_UN")))

# Plot the correlation matrix
corrplot(cor_matrix_hh_f, method = "color", type = "upper", 
         addCoef.col = "black", tl.col = "black", tl.srt = 45)
```


#Informal camp_correlation with household
```{r}
informal_camps$N_HH <- as.numeric(informal_camps$N_HH)
informal_camps$ghsl <- as.numeric(informal_camps$ghsl)
informal_camps$wp_c <- as.numeric(informal_camps$wp_c)
informal_camps$wp_uc<- as.numeric(informal_camps$wp_uc)
informal_camps$gpw <- as.numeric(informal_camps$gpw)
informal_camps$gpw_UN<-as.numeric(informal_camps$gpw_UN)


# Calculate correlation coefficients
corr_ghsl_HH_if <- cor(informal_camps$N_HH,informal_camps$ghsl)
corr_wp_c_HH_if<-cor(informal_camps$N_HH,informal_camps$wp_c)
corr_wp_uc_HH_if<-cor(informal_camps$N_HH,informal_camps$wp_uc)
corr_gpw_HH_if<-cor(informal_camps$N_HH,informal_camps$gpw)
corr_gpw_UN_HH_if<-cor(informal_camps$N_HH,informal_camps$gpw_UN)
# View correlation coefficients

print(paste("GHSL:",corr_ghsl_HH_if))
print(paste("wp_uc:",corr_wp_uc_HH_if))
print(paste("wp_c",corr_wp_c_HH_if))
print(paste("gpw:",corr_gpw_HH_if))
print(paste("gpw_UN:",corr_gpw_UN_HH_if))

# [1] "GHSL: 0.655305587898169"
# [1] "wp_uc: 0.707152002283645"
# [1] "wp_c 0.45873543451475"
# [1] "gpw: 0.129618099138202"
# [1] "gpw_UN: 0.129566317570079"
```

```{r}
# Create a matrix of correlation coefficients
cor_matrix_hh_if <- matrix(c(corr_ghsl_HH_if, corr_wp_c_HH_if, corr_wp_uc_HH_if, corr_gpw_HH_if,corr_gpw_UN_HH_if),
                     nrow = 1, byrow = TRUE,
                     dimnames = list(c("N_HH"), c("ghsl", "wp_c", "wp_uc", "gpw","gpw_UN")))

# Plot the correlation matrix
corrplot(cor_matrix_hh_if, method = "color", type = "upper", 
         addCoef.col = "black", tl.col = "black", tl.srt = 45)
```



#___POPULATION DIFFERENCE___________
#poputalion difference e summary
```{r}
print('wp_c_difference')
summary(camps$wp_c_df)
print('wp_c_difference')
summary(as.numeric(camps$wp_c_df))
print('wp_uc_difference')
summary(as.numeric(camps$wp_uc_df))
print('gpw_difference')
summary(as.numeric(camps$gpw_dff))
print('ghsl_difference')
summary(as.numeric(camps$ghsl_df))
print('gpw_UN_difference')
summary(as.numeric(camps$gpwU_df))

cat("Absolute Difference GPW_UN:", mean(absolute_difference_gpw_UN), "\n")
cat("Absolute Difference GPW:", mean(absolute_difference_gpw), "\n")
cat("Absolute Difference:", mean(absolute_difference), "\n")
cat("Absolute Difference wp_uc:", mean(absolute_difference_wp_uc), "\n")
cat("Absolute Difference wp_c:", mean(absolute_difference_wp_c), "\n")



# GHSL
print("GHSL")
cat("Absolute Difference:", mean(absolute_difference), "\n")
cat("Percentage Difference:", mean(percentage_difference), "%\n")
cat("RMSE:", rmse, "\n")
cat("MAPE:", mape, "%\n")
cat("Absolute error:",absolute_error,"\n")
cat("Percentage error:",percentage_error)


# Print results
print("WP_UC")
cat("Absolute Difference:", mean(absolute_difference_wp_uc), "\n")
cat("Percentage Difference:", mean(percentage_difference_wp_uc), "%\n")
cat("RMSE:", rmse_wp_uc, "\n")
cat("MAPE:", mape_uc, "%\n")
cat("Absolute error:",absolute_error_wp_uc,"\n")
cat("Percentage error:",percentage_error_wp_uc)
  

# Print results
print("WP_C")
cat("Absolute Difference:", mean(absolute_difference_wp_c), "\n")
cat("Percentage Difference:", mean(percentage_difference_wp_c), "%\n")
cat("RMSE:", rmse_wp_c, "\n")
cat("MAPE:", mape_wp_c, "%\n")
cat("Absolute error:",absolute_error_wp_c,"\n")
cat("Percentage error:",percentage_error_wp_c)


print("GPW")
cat("Absolute Difference:", mean(absolute_difference_gpw), "\n")
cat("Percentage Difference:", mean(percentage_difference_gpw), "%\n")
cat("RMSE:", rmse_gpw, "\n")
cat("MAPE:", mape_gpw, "%\n")
cat("Absolute error:",absolute_error_gpw,"\n")
cat("Percentage error:",percentage_error_gpw)


# Print results
print("gpw_UN")
cat("Absolute Difference:", mean(absolute_difference_gpw_UN), "\n")
cat("Percentage Difference:", mean(percentage_difference_gpw_UN), "%\n")
cat("RMSE:", rmse_gpw_UN, "\n")
cat("MAPE:", mape_gpw_UN, "%\n")
cat("Absolute error:",absolute_error_gpw_UN,"\n")
cat("Percentage error:",percentage_error_gpw_UN)

```
#Boxplot of the difference of eo population pdt and N_INDVI



#box plot with mean value displayed
```{r}
library(ggplot2)

# Combine all population difference columns into one data frame
difference_data <- data.frame(
  Dataset = rep(c("WP_CON", "WP_UNCON", "GPW", "GHSL", "GPW_UN"), each = nrow(camps)),
  Population_Difference = c(as.numeric(camps$wp_c_df), as.numeric(camps$wp_uc_df),as.numeric(camps$gpw_dff), as.numeric(camps$ghsl_df),as.numeric(camps$gpwU_df))
)

# Calculate mean values
mean_values <- aggregate(Population_Difference ~ Dataset, data = difference_data, mean)

# Create a box plot
boxplot_pop_diff <- ggplot(difference_data, aes(x = Dataset, y = Population_Difference)) +
  geom_boxplot(fill = "skyblue", color = "black") +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 1, color = "red") + # Adding mean points
  geom_text(data = mean_values, aes(label = round(Population_Difference, digits = 2)), vjust = -0.5,size=2) + # Adding text labels
  labs(title = "Difference between Surveyed and Estimated Populations(Survey-Estimate) for different EO population data products",
       x = "Dataset", y = "Population Difference") +
  theme_minimal() +
 theme(axis.text.x = element_text(angle = 45, hjust = 1), 
        plot.title = element_text(size = 10)) # Rotate x-axis labels

# Print the box plot
print(boxplot_pop_diff)


```
#Save error boxplot

```{r}
# Save the plot to a file
ggsave("Plots/boxplot_pop_diff.png", plot =boxplot_pop_diff, width = 8, height = 6, dpi = 400)
```



#interactive box plot for population difference


```{r}
library(plotly)

# Combine all population difference columns into one data frame
difference_data <- data.frame(
  Dataset = rep(c("WP_CON", "WP_UNCON", "GPW", "GHSL", "GPW_UN"), each = nrow(camps)),
  Population_Difference = c(as.numeric(camps$wp_c_df), as.numeric(camps$wp_uc_df), as.numeric(camps$gpw_dff), as.numeric(camps$ghsl_df), as.numeric(camps$gpwU_df))
)

# Calculate mean values
mean_values <- aggregate(Population_Difference ~ Dataset, data = difference_data, mean)

# Create an interactive box plot with plotly
boxplot_pop_diff_interactive <- plot_ly(difference_data, x = ~Dataset, y = ~Population_Difference, type = "box") %>%
  add_markers(data = mean_values, x = ~Dataset, y = ~Population_Difference, marker = list(color = "red", size = 10)) %>%
  add_text(data = mean_values, x = ~Dataset, y = ~Population_Difference, text = ~paste("Mean:", round(Population_Difference, digits = 2)),
           showlegend = FALSE, textposition = "top", textfont = list(size = 12, color = "red")) %>%
  layout(title = "Difference between Surveyed and Estimated Populations(Survey-Estimate) for different EO population data products",
         xaxis = list(title = "Dataset"),
         yaxis = list(title = "Population Difference"))



# Create an interactive box plot
boxplot_pop_diff_interactive <- plot_ly(difference_data, x = ~Dataset, y = ~Population_Difference, type = "box") %>%
  add_markers(text = ~paste("Camp:", camps$Name, "<br>Population Difference:", Population_Difference, "<br>Situation Status:", camps$Sit_Stt, "<br>Cluster Shape Area:", camps$cl_Shp_a))

# Print the interactive plot
boxplot_pop_diff_interactive





```




#Formal camps error

```{r}
# Combine all population difference columns into one data frame
difference_data_formal <- data.frame(
  Dataset = rep(c("WP_CON", "WP_UNCON", "GPW", "GHSL", "GPW_UN"), each = nrow(formal_camps)),
  Population_Difference = c(as.numeric(formal_camps$wp_c_df), as.numeric(formal_camps$wp_uc_df),as.numeric(formal_camps$gpw_dff), as.numeric(formal_camps$ghsl_df),as.numeric(formal_camps$gpwU_df))
)

# Calculate mean values
mean_values <- aggregate(Population_Difference ~ Dataset, data = difference_data_formal, mean)

# Create a box plot
boxplot_pop_diff_formal<- ggplot(difference_data_formal, aes(x = Dataset, y = Population_Difference)) +
  geom_boxplot(fill = "skyblue", color = "black") +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 1, color = "red") + # Adding mean points
  geom_text(data = mean_values, aes(label = round(Population_Difference, digits = 2)), vjust = -0.5,size=1.5) + # Adding text labels
  labs(title = "Difference between Surveyed and Estimated Populations(Survey-Estimate) for formal camps",
       x = "Dataset", y = "Population Difference") +
  theme_minimal() +
 theme(axis.text.x = element_text(angle = 45, hjust = 1), 
        plot.title = element_text(size = 10)) # Rotate x-axis labels

# Print the box plot
print(boxplot_pop_diff_formal)

```
#Save error boxplot

```{r}
# Save the plot to a file
ggsave("Plots/boxplot_pop_diff_formal.png", plot =boxplot_pop_diff_formal, width = 8, height = 6, dpi = 400)
```


#InFormal camps error

```{r}
# Combine all population difference columns into one data frame
difference_data_informal <- data.frame(
  Dataset = rep(c("WP_CON", "WP_UNCON", "GPW", "GHSL", "GPW_UN"), each = nrow(informal_camps)),
  Population_Difference = c(as.numeric(informal_camps$wp_c_df), as.numeric(informal_camps$wp_uc_df),as.numeric(informal_camps$gpw_dff), as.numeric(informal_camps$ghsl_df),as.numeric(informal_camps$gpwU_df))
)

# Calculate mean values
mean_values <- aggregate(Population_Difference ~ Dataset, data = difference_data_formal, mean)

# Create a box plot
boxplot_pop_diff_informal<- ggplot(difference_data_informal, aes(x = Dataset, y = Population_Difference)) +
  geom_boxplot(fill = "skyblue", color = "black") +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 1, color = "red") + # Adding mean points
  geom_text(data = mean_values, aes(label = round(Population_Difference, digits = 2)), vjust = -0.5,size=1.5) + # Adding text labels
  labs(title = "Difference between Surveyed and Estimated Populations(Survey-Estimate) for informal camps",
       x = "Dataset", y = "Population Difference") +
  theme_minimal() +
 theme(axis.text.x = element_text(angle = 45, hjust = 1), 
        plot.title = element_text(size = 10)) # Rotate x-axis labels

# Print the box plot
print(boxplot_pop_diff_informal)

```
#Save error boxplot

```{r}
# Save the plot to a file
ggsave("Plots/boxplot_pop_diff_informal.png", plot =boxplot_pop_diff_informal, width = 8, height = 6, dpi = 400)
```

#Areawise boxplot for all the error
#area>10000
```{r}
# Combine all population difference columns into one data frame
difference_data_areag <- data.frame(
  Dataset = rep(c("WP_CON", "WP_UNCON", "GPW", "GHSL", "GPW_UN"), each = nrow(subset_data)),
  Population_Difference = c(as.numeric(subset_data$wp_c_df), as.numeric(subset_data$wp_uc_df),as.numeric(subset_data$gpw_dff), as.numeric(subset_data$ghsl_df),as.numeric(subset_data$gpwU_df))
)

# Calculate mean values
mean_values <- aggregate(Population_Difference ~ Dataset, data = difference_data_areag, mean)

# Create a box plot
boxplot_pop_diff_areag<- ggplot(difference_data_areag, aes(x = Dataset, y = Population_Difference)) +
  geom_boxplot(fill = "skyblue", color = "black") +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 1, color = "red") + # Adding mean points
  geom_text(data = mean_values, aes(label = round(Population_Difference, digits = 2)), vjust = -0.5,size=1.5) + # Adding text labels
  labs(title = "Difference(Survey-Estimate) for camps with area>10000",
       x = "Dataset", y = "Population Difference") +
  theme_minimal() +
 theme(axis.text.x = element_text(angle = 45, hjust = 1), 
        plot.title = element_text(size = 10)) # Rotate x-axis labels

# Print the box plot
print(boxplot_pop_diff_areag)
```
#Save error boxplot

```{r}
# Save the plot to a file
ggsave("Plots/boxplot_pop_diff_areag.png", plot =boxplot_pop_diff_areag, width = 8, height = 6, dpi = 400)
```

#Areawise boxplot for all the error
#area<10000


```{r}
# Combine all population difference columns into one data frame
difference_data_areal <- data.frame(
  Dataset = rep(c("WP_CON", "WP_UNCON", "GPW", "GHSL", "GPW_UN"), each = nrow(subset_data_2)),
  Population_Difference = c(as.numeric(subset_data_2$wp_c_df), as.numeric(subset_data_2$wp_uc_df),as.numeric(subset_data_2$gpw_dff), as.numeric(subset_data_2$ghsl_df),as.numeric(subset_data_2$gpwU_df))
)

# Calculate mean values
mean_values <- aggregate(Population_Difference ~ Dataset, data = difference_data_areal, mean)

# Create a box plot
boxplot_pop_diff_areal<- ggplot(difference_data_areal, aes(x = Dataset, y = Population_Difference)) +
  geom_boxplot(fill = "skyblue", color = "black") +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 1, color = "red") + # Adding mean points
  geom_text(data = mean_values, aes(label = round(Population_Difference, digits = 2)), vjust = -0.5,size=1.5) + # Adding text labels
  labs(title = "Difference(Survey-Estimate) for camps with area<10000",
       x = "Dataset", y = "Population Difference") +
  theme_minimal() +
 theme(axis.text.x = element_text(angle = 45, hjust = 1), 
        plot.title = element_text(size = 10)) # Rotate x-axis labels

# Print the box plot
print(boxplot_pop_diff_areal)
```

#Save error boxplot

```{r}
# Save the plot to a file
ggsave("Plots/boxplot_pop_diff_areal.png", plot =boxplot_pop_diff_areal, width = 8, height = 6, dpi = 400)
```

#POPwise error boxplot
#population >10000
```{r}
# Combine all population difference columns into one data frame
difference_data_pg <- data.frame(
  Dataset = rep(c("WP_CON", "WP_UNCON", "GPW", "GHSL", "GPW_UN"), each = nrow(campsgt10000)),
  Population_Difference = c(as.numeric(campsgt10000$wp_c_df), as.numeric(campsgt10000$wp_uc_df),as.numeric(campsgt10000$gpw_dff), as.numeric(campsgt10000$ghsl_df),as.numeric(campsgt10000$gpwU_df))
)

# Calculate mean values
mean_values <- aggregate(Population_Difference ~ Dataset, data = difference_data_pg, mean)

# Create a box plot
boxplot_pop_diff_pg<- ggplot(difference_data_pg, aes(x = Dataset, y = Population_Difference)) +
  geom_boxplot(fill = "skyblue", color = "black") +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 1, color = "red") + # Adding mean points
  geom_text(data = mean_values, aes(label = round(Population_Difference, digits = 2)), vjust = -0.5,size=1.5) + # Adding text labels
  labs(title = "Difference(Survey-Estimate) for camps with population>10000",
       x = "Dataset", y = "Population Difference") +
  theme_minimal() +
 theme(axis.text.x = element_text(angle = 45, hjust = 1), 
        plot.title = element_text(size = 10)) # Rotate x-axis labels

# Print the box plot
print(boxplot_pop_diff_pg)
```
#Save error boxplot

```{r}
# Save the plot to a file
ggsave("Plots/boxplot_pop_diff_pg.png", plot =boxplot_pop_diff_pg, width = 8, height = 6, dpi = 400)
```

#population <10000
```{r}
# Combine all population difference columns into one data frame
difference_data_pl <- data.frame(
  Dataset = rep(c("WP_CON", "WP_UNCON", "GPW", "GHSL", "GPW_UN"), each = nrow(campls10000)),
  Population_Difference = c(as.numeric(campls10000$wp_c_df), as.numeric(campls10000$wp_uc_df),as.numeric(campls10000$gpw_dff), as.numeric(campls10000$ghsl_df),as.numeric(campls10000$gpwU_df))
)

# Calculate mean values
mean_values <- aggregate(Population_Difference ~ Dataset, data = difference_data_pl, mean)

# Create a box plot
boxplot_pop_diff_pl<- ggplot(difference_data_pl, aes(x = Dataset, y = Population_Difference)) +
  geom_boxplot(fill = "skyblue", color = "black") +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 1, color = "red") + # Adding mean points
  geom_text(data = mean_values, aes(label = round(Population_Difference, digits = 2)), vjust = -0.5,size=1.5) + # Adding text labels
  labs(title = "Difference(Survey-Estimate) for camps with population<10000",
       x = "Dataset", y = "Population Difference") +
  theme_minimal() +
 theme(axis.text.x = element_text(angle = 45, hjust = 1), 
        plot.title = element_text(size = 10)) # Rotate x-axis labels

# Print the box plot
print(boxplot_pop_diff_pl)
```

#Save error boxplot

```{r}
# Save the plot to a file
ggsave("Plots/boxplot_pop_diff_pl.png", plot =boxplot_pop_diff_pl, width = 8, height = 6, dpi = 400)
```

#Bar plot of all the errors

```{r}
library(ggplot2)

# Create a data frame with the summary statistics for Mean Absolute Difference and RMSE
summary_data <- data.frame(
  Dataset = c("GHSL", "WP_UC", "WP_C", "GPW"),
  Mean_Absolute_Difference = c(mean(absolute_difference), mean(absolute_difference_wp_uc), 
                               mean(absolute_difference_wp_c), mean(absolute_difference_gpw)),
  RMSE = c(rmse, rmse_wp_uc, rmse_wp_c, rmse_gpw)
)

# Reshape the data frame into long format for plotting
summary_data_long <- tidyr::pivot_longer(summary_data, cols = c("Mean_Absolute_Difference", "RMSE"), 
                                         names_to = "Statistic", values_to = "Value")

# Create the bar plot
bar_plot_error_rmse <- ggplot(summary_data_long, aes(x = Dataset, y = Value, fill = Statistic, label = round(Value, digits = 2))) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(position = position_dodge(width = 0.9),    # Dodge position adjustment
            vjust = -0.5,    # Adjust vertical position
            size = 3) +      # Adjust text size
  labs(title = "Mean Absolute Difference and RMSE Comparison Across Datasets",
       x = "Dataset", y = "Value", fill = "Statistic") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Print the bar plot
print(bar_plot_error_rmse )


```

```{r}
# Save the plot to a file
ggsave("Plots/bar_plot_error_rmse.png", plot =bar_plot_error_rmse, width = 8, height = 6, dpi = 400)
```

#__RATIOS OF ERROR____
#ratio of error for EO datasets 
```{r}
# Calculate the ratio of the difference to the surveyed population
difference_data$ratio <- difference_data$Population_Difference / camps$N_INDVI

# Aggregate mean ratio values
mean_ratio_values <- aggregate(ratio ~ Dataset, data = difference_data, mean)

# Create a box plot for the ratios
boxplot_ratio <- ggplot(difference_data, aes(x = Dataset, y = ratio)) +
  geom_boxplot(fill = "skyblue", color = "black") +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 1, color = "red") +
  geom_text(data = mean_ratio_values, aes(label = round(ratio, digits = 2)), vjust = -0.5, size = 2,color='Red') +
  labs(title = "Ratio of Difference to Survey Population for Different EO Population Data Products",
       x = "Dataset", y = "Ratio of Difference to Survey Population") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        plot.title = element_text(size = 10))

# Print the box plot
print(boxplot_ratio)




```
#save ratio error plot

```{r}
# Save the plot to a file
ggsave("Plots/boxplot_ratio.png", plot =boxplot_ratio, width = 8, height = 6, dpi = 400)
```


#Interactive box plot for ratio of differences

```{r}
library(plotly)

# Calculate the ratio of the difference to the surveyed population
difference_data$ratio <- difference_data$Population_Difference / camps$N_INDVI

# Aggregate mean ratio values
mean_ratio_values <- aggregate(ratio ~ Dataset, data = difference_data, mean)

# Create an interactive box plot for the ratios
boxplot_ratio_interactive <- plot_ly(difference_data, x = ~Dataset, y = ~ratio, type = "box") %>%
  add_markers(text = ~paste("Dataset:", Dataset, "<br>Name:", camps$Name, "<br>Sit_Stt:", camps$Sit_Stt, "<br>cl_Shp_a:", camps$cl_Shp_a, "<br>Ratio:", ratio)) %>%
  add_markers(data = mean_ratio_values, x = ~Dataset, y = ~ratio, mode = "markers", color = I("red"), 
              text = ~paste("Mean Ratio:", round(ratio, digits = 2)))

# Print the interactive plot
boxplot_ratio_interactive


```


#saving the interactive plot 

```{r}
# Save the interactive plot as an HTML file
orca(boxplot_ratio_interactive, file = "boxplot_ratio_interactive.html")

```


# underestimation and overestimation plots

```{r}
# Assuming 'difference_data' contains the data with the ratios of difference

# Categorize the data into underestimation, overestimation, and correct estimation based on the difference of ratios
underestimation <- difference_data[difference_data$Population_Difference > 0, ]
overestimation <- difference_data[difference_data$Population_Difference < 0, ]
correct_estimation <- difference_data[difference_data$Population_Difference == 0, ]

# Create histograms for underestimation, overestimation, and correct estimation
hist_underestimation <- ggplot(underestimation, aes(x = Population_Difference)) +
  geom_histogram(binwidth = 0.1, fill = "skyblue", color = "black", alpha = 0.7) +
  labs(title = "Underestimation of Population",
       x = "Difference of Ratios",
       y = "Frequency") +
  theme_minimal()

hist_overestimation <- ggplot(overestimation, aes(x = Population_Difference)) +
  geom_histogram(binwidth = 0.1, fill = "salmon", color = "black", alpha = 0.7) +
  labs(title = "Overestimation of Population",
       x = "Difference of Ratios",
       y = "Frequency") +
  theme_minimal()

hist_correct_estimation <- ggplot(correct_estimation, aes(x = Population_Difference)) +
  geom_histogram(binwidth = 0.1, fill = "lightgreen", color = "black", alpha = 0.7) +
  labs(title = "Correct Estimation of Population",
       x = "Difference of Ratios",
       y = "Frequency") +
  theme_minimal()

# Print the histograms
print(hist_underestimation)
print(hist_overestimation)
print(hist_correct_estimation)


```

#under 20 over 20 estimation

```{r}
# Filter estimations that are within 20 of the surveyed population
within_20 <- difference_data[abs(difference_data$Population_Difference) <= 20, ]

# Print the filtered data
print(within_20)



```



```{r}
library(ggplot2)

# Create a boxplot of the filtered data
boxplot_within_20 <- ggplot(within_20, aes(x = Dataset, y = Population_Difference)) +
  geom_boxplot(fill = "skyblue", color = "black") +
  labs(title = "Population Difference within 20 of Surveyed Population",
       x = "Dataset", y = "Population Difference") +
  theme_minimal()

# Print the boxplot
print(boxplot_within_20)

```
#interactive of within 20

```{r}
library(plotly)

# Combine all population difference columns into one data frame
difference_data <- data.frame(
  Dataset = rep(c("WP_CON", "WP_UNCON", "GPW", "GHSL", "GPW_UN"), each = nrow(camps)),
  Population_Difference = c(as.numeric(camps$wp_c_df), as.numeric(camps$wp_uc_df), as.numeric(camps$gpw_dff), as.numeric(camps$ghsl_df), as.numeric(camps$gpwU_df)),
  Camp_Name = camps$Name
)

# Filter estimations that are within 20 of the surveyed population
within_20 <- difference_data[abs(difference_data$Population_Difference) <= 20, ]

# Calculate mean values
mean_values <- aggregate(Population_Difference ~ Dataset, data = within_20, mean)

# Create an interactive box plot with plotly
boxplot_within_20_interactive <- plot_ly(within_20, x = ~Dataset, y = ~Population_Difference, type = "box") %>%
  add_markers(data = mean_values, x = ~Dataset, y = ~Population_Difference, marker = list(color = "red", size = 10)) %>%
  add_trace(data = within_20, 
            type = "scatter", 
            mode = "markers", 
            marker = list(color = "rgba(0,0,0,0)"),
            hoverinfo = "text",
            text = ~paste("Camp:", Camp_Name)) %>%
  layout(title = "Population Difference within 20 of Surveyed Population",
         xaxis = list(title = "Dataset"),
         yaxis = list(title = "Population Difference"))

# Print the interactive plot
print(boxplot_within_20_interactive)

```

#____________________________________


#trying some summary stats

```{r}
camps$N_INDVI <- as.numeric(camps$N_INDVI)
camps$N_HH<-as.numeric(camps$N_HH)
camps$g_b_c <- as.numeric(camps$g_b_c)
camps$ms_b_c <- as.numeric(camps$ms_b_c)
camps$vida_b_c <- as.numeric(camps$vida_b_c)
camps$osm_b_c <- as.numeric(camps$osm_b_c)

print("g_b_c")
summary(camps$g_b_c)
print("ms_b_c")
summary(camps$ms_b_c)
print("vida_b_c")
summary(camps$vida_b_c)
print("osm_b_c")
summary(camps$osm_b_c)

```


#$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
#________________________________________
#____BUILDING STATS__________
#_______________________________________________


```{r}
camps$N_HH <- as.numeric(camps$N_HH)
camps$vida_b_c <- as.numeric(camps$vida_b_c)
camps$ms_b_c <- as.numeric(camps$ms_b_c)
camps$osm_b_c  <- as.numeric(camps$osm_b_c )
camps$g_b_c <- as.numeric(camps$g_b_c)
summary(camps[, c("N_HH", "vida_b_c", "ms_b_c", "osm_b_c", "g_b_c")])
```



#_____MICROSOFT BUILDING_____


#1.(Surveyed pop_ms building count)plot 
```{r}
# Scatter plot with site_status
ms_b_surv<-ggplot(camps, aes(y = ms_b_c, x = N_INDVI, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(ms_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between MS building count and survey iom populations",
       y = "Microsoft building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(ms_b_surv)
corr_ms_b_pop<-cor((as.numeric(camps$ms_b_c)),(as.numeric(camps$N_INDVI)))
print(corr_ms_b_pop)
# correlation is 
# [1] 0.8287113
```

#2.(Surveyed household vs _ms building count)plot 
```{r}
# Scatter plot with site_status
ms_b_surv_hh<-ggplot(camps, aes(y = ms_b_c, x = N_HH, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(ms_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between MS building count and survey household number",
       y = "Microsoft building count",
       x = "Iom surveyed Household count") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(ms_b_surv_hh)
  corr_ms_hh_pop<-cor((as.numeric(camps$ms_b_c)),(as.numeric(camps$N_HH)))
print(corr_ms_hh_pop)
# correlation is 
# [1]  0.8214727
```
#3.Site status (InFormal) only ms_building count vs population
```{r}
# 1. Subset the informal camps
informal_camps <- camps %>% filter(Sit_Stt == "Informal")

# 2. Extract relevant columns
data_plot_ms <- informal_camps %>%
  select(ms_b_c, N_INDVI,Sit_Stt)

# Scatter plot with site_status
ms_b_inf<-ggplot(data_plot_ms, aes(y = ms_b_c, x = N_INDVI,colour=Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(ms_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between MS building count and IOM survey populations for informal site status",
       y = "Microsoft building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(ms_b_inf)
corr_ms_b_pop_inf<-cor((as.numeric(camps$ms_b_c)),(as.numeric(camps$N_INDVI)))
print(corr_ms_b_pop_inf)
# correlation is 
# [1] 0.8287113
```


#4.Site status (InFormal) only ms_building count vs number of households

```{r}
# 1. Subset the informal camps
informal_camps <- camps %>% filter(Sit_Stt == "Informal")

# 2. Extract relevant columns
data_plot_ms <- informal_camps %>%
  select(ms_b_c, N_HH,Sit_Stt)

# Scatter plot with site_status
ms_b_inf<-ggplot(data_plot_ms, aes(y = ms_b_c, x = N_HH,colour=Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(ms_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between MS building count and IOM survey household count for informal site status",
       y = "Microsoft building count",
       x = "Iom surveyed household count") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(ms_b_inf)
corr_ms_b_hh_inf<-cor((as.numeric(informal_camps$ms_b_c)),(as.numeric(informal_camps$N_INDVI)))
print(corr_ms_b_hh_inf)
# correlation is 
# [1] 0.7585236
```


#5.Site status (Formal) only ms_building count vs survey population

```{r}
# 1. Subset the informal camps
formal_camps <- camps %>% filter(Sit_Stt == "Formal")

# 2. Extract relevant columns
data_plot_ms_f <- formal_camps %>%
  select(ms_b_c, N_INDVI,Sit_Stt)

# Scatter plot with site_status
ms_b_for<-ggplot(data_plot_ms_f, aes(y = ms_b_c, x = N_INDVI,colour=Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(ms_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between MS building count and IOM survey populations for formal site status",
       y = "Microsoft building count",
       x = "Iom surveyed population(formal sites") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
print(ms_b_for)
corr_ms_b_pop_f<-cor((as.numeric(formal_camps$ms_b_c)),(as.numeric(formal_camps$N_INDVI)))
print(corr_ms_b_pop_f)
# correlation is 
# [1] 0.7930982


```

#6.Site status (Formal) only ms_building count vs number of households

```{r}
# 1. Subset the informal camps
formal_camps <- camps %>% filter(Sit_Stt == "Formal")

# 2. Extract relevant columns
data_plot_ms_f <- formal_camps %>%
  select(ms_b_c, N_INDVI,Sit_Stt)

# Scatter plot with site_status
ms_b_for_hh<-ggplot(data_plot_ms_f, aes(y = ms_b_c, x = N_HH,colour=Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(ms_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between MS building count and IOM survey household count for formal site status",
       y = "Microsoft building count",
       x = "Iom surveyed household count(formal sites") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
print(ms_b_for)
corr_ms_b_hh_f<-cor((as.numeric(formal_camps$ms_b_c)),(as.numeric(formal_camps$N_HH)))
print(corr_ms_b_hh_f)
# correlation is 
# [1] 0.7810073

```

#7. Site_type plot for ms_building and population
```{r}
# Scatter plot with site_status
ms_b_st_typ<-ggplot(camps, aes(y = ms_b_c, x = N_INDVI, color = Sit_Typ)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(ms_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between MS building count and survey iom populations with Site Type ",
       y = "Microsoft building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(ms_b_st_typ)

```

#8. Site type plot for ms_building and survey household
```{r}
# Scatter plot with site_status
ms_b_st_typ_hh<-ggplot(camps, aes(y = ms_b_c, x = N_HH,colour=Sit_Typ)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(ms_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between MS building count and IOM survey household count",
       y = "Microsoft building count",
       x = "Iom surveyed household count(formal sites") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
print(ms_b_st_typ_hh)

```

#9. Site class(spontaneous/planned) plot for ms_building and survey population

```{r}
# Scatter plot with site_status
ms_b_st_typ<-ggplot(camps, aes(y = ms_b_c, x = N_INDVI, color = St_clss)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(ms_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between MS building count and survey iom populations with Site Class ",
       y = "Microsoft building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(ms_b_st_typ)
```



#10.Shelter type plot for survey population vs ms building counts
```{r}
# Scatter plot with site_status
ms_b_sl_typ<-ggplot(camps, aes(y = ms_b_c, x = N_INDVI, color = Shlt_ty)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(ms_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between MS building count and survey iom populations with Shelter type ",
       y = "Microsoft building count",
       x = "Iom surveyed population") +
  theme_minimal()  # Adjust axis scale to start from zero
print(ms_b_sl_typ)
```
#11.Shelter type plot for survey household count vs ms building counts


```{r}
# Scatter plot with site_status
ms_b_sl_typ_hh<-ggplot(camps, aes(y = ms_b_c, x = N_HH,colour=Shlt_ty)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(ms_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between MS building count and IOM survey household count for different shelter type",
       y = "Microsoft building count",
       x = "Iom surveyed household count") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
print(ms_b_sl_typ_hh)
```

#Microsoft building stats(Mean of building area/density and count)

```{r}


camps$ms_b_a <- as.numeric(camps$ms_b_a)
camps$ms_b_c <- as.numeric(camps$ms_b_c)
camps$N_HH<-as.numeric(camps$N_HH)
camps$cl_Shp_a<-as.numeric(camps$cl_Shp_a)

print("ms_b_c")
summary(camps$ms_b_c)
print("ms_b_a")
summary(camps$ms_b_a)
print("N_HH")
summary(camps$N_HH)
print("cl_Shp_a")
summary(camps$cl_Shp_a)

sum(camps$ms_b_c)
```



#____GOOGLE BUILDINGS______________
#1.(Surveyed population vs _ms building count)plot

```{r}
# Scatter plot with site_status
g_b_surv<-ggplot(camps, aes(y = g_b_c, x = N_INDVI, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(g_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Google building count and survey iom populations",
       y = "Google building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(g_b_surv)
```
#2.(Surveyed household vs _ms building count)plot
```{r}
# Scatter plot with site_status
g_b_hh<-ggplot(camps, aes(y = g_b_c, x = N_HH, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(g_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Google building count and survey Household count",
       y = "Google building count",
       x = "Iom surveyed household count") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(g_b_hh)
```
#3.Site status (InFormal) only ms_building count vs populatio

```{r}
# 1. Subset the informal camps
informal_camps <- camps %>% filter(Sit_Stt == "Informal")

# 2. Extract relevant columns
data_plot_g <- informal_camps %>%
  select(g_b_c, N_INDVI,Sit_Stt)

# Scatter plot with site_status
g_b_inf<-ggplot(data_plot_g, aes(y = g_b_c, x = N_INDVI,colour=Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(g_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Google building count and IOM survey populations for informal site status",
       y = "Google building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(g_b_inf)
corr_g_b_pop_inf<-cor((as.numeric(camps$g_b_c)),(as.numeric(camps$N_INDVI)))
print(corr_g_b_pop_inf)
# correlation is 
# [1] 0.7700363
```


#4.Site status (InFormal) only ms_building count vs number of households
```{r}
# 1. Subset the informal camps
informal_camps <- camps %>% filter(Sit_Stt == "Informal")

# 2. Extract relevant columns
data_plot_g <- informal_camps %>%
  select(g_b_c, N_HH,Sit_Stt)

# Scatter plot with site_status
g_b_inf_h<-ggplot(data_plot_g, aes(y = g_b_c, x = N_HH,colour=Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(g_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Google building count and IOM survey household count for informal site status",
       y = "Google building count",
       x = "Iom surveyed household count") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(g_b_inf)
corr_g_b_hh_inf<-cor((as.numeric(informal_camps$g_b_c)),(as.numeric(informal_camps$N_INDVI)))
print(corr_g_b_hh_inf)
# correlation is 
# [1]0.7117787
```

#5.Site status (Formal) only ms_building count vs survey population
```{r}
# 1. Subset the informal camps
formal_camps <- camps %>% filter(Sit_Stt == "Formal")

# 2. Extract relevant columns
data_plot_g_f <- formal_camps %>%
  select(g_b_c, N_INDVI,Sit_Stt)

# Scatter plot with site_status
g_b_for<-ggplot(data_plot_g_f, aes(y = g_b_c, x = N_INDVI,colour=Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(g_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Google building count and IOM survey populations for formal site status",
       y = "Google building count",
       x = "Iom surveyed population(formal sites") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
print(g_b_for)
corr_g_b_pop_f<-cor((as.numeric(formal_camps$g_b_c)),(as.numeric(formal_camps$N_INDVI)))
print(corr_g_b_pop_f)
# correlation is 
# [1]   0.7570887
```


#6.Site status (Formal) only ms_building count vs number of households
```{r}
# 1. Subset the informal camps
formal_camps <- camps %>% filter(Sit_Stt == "Formal")

# 2. Extract relevant columns
data_plot_g_f <- formal_camps %>%
  select(g_b_c, N_INDVI,Sit_Stt)

# Scatter plot with site_status
g_b_for_hh<-ggplot(data_plot_g_f, aes(y = g_b_c, x = N_HH,colour=Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(g_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Google building count and IOM survey household count for formal site status",
       y = "Google building count",
       x = "Iom surveyed household count(formal sites") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
print(g_b_for)
corr_g_b_hh_f<-cor((as.numeric(formal_camps$g_b_c)),(as.numeric(formal_camps$N_HH)))
print(corr_g_b_hh_f)
# correlation is 
# [1] 0.7147828

```

#7. Site_type plot for ms_building and population
```{r}
# Scatter plot with site_status
g_b_st_typ<-ggplot(camps, aes(y = g_b_c, x = N_INDVI, color = Sit_Typ)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(g_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Google building count and survey iom populations with Site Type ",
       y = "Google building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(g_b_st_typ)
```

#8. Site type plot for ms_building and survey household
```{r}
# Scatter plot with site_status
g_hh_st_typ<-ggplot(camps, aes(y = g_b_c, x = N_HH, color = Sit_Typ)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(g_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Google building count and survey household number with Site Type ",
       y = "Google building count",
       x = "Iom surveyed household number") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(g_hh_st_typ)
```

#9. Site class(spontaneous/planned) plot for ms_building and survey population
```{r}
# Scatter plot with site_status
g_b_st_typ<-ggplot(camps, aes(y = g_b_c, x = N_INDVI, color = St_clss)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(g_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Google building count and survey iom populations with Site Class ",
       y = "Google building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(g_b_st_typ)
```

#10.Shelter type plot for survey population vs ms building counts
```{r}
# Scatter plot with site_status
g_b_sl_typ<-ggplot(camps, aes(y = g_b_c, x = N_INDVI, color = Shlt_ty)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(g_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between google building count and survey iom populations with Shelter type ",
       y = "Google building count",
       x = "Iom surveyed population") +
  theme_minimal()  # Adjust axis scale to start from zero
print(g_b_sl_typ)
```
#11.Shelter type plot for survey household count vs ms building counts
```{r}
# Scatter plot with site_status
g_hh_sl_typ_hh<-ggplot(camps, aes(y = g_b_c, x = N_HH,colour=Shlt_ty)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(g_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Google building count and IOM survey household count for different shelter type",
       y = "Google building count",
       x = "Iom surveyed household count") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
print(g_hh_sl_typ_hh)
```

#Google building stats(Mean of building area/density and count)

```{r}


camps$g_b_a <- as.numeric(camps$g_b_a)
camps$g_b_c <- as.numeric(camps$g_b_c)
camps$N_HH<-as.numeric(camps$N_HH)
camps$cl_Shp_a<-as.numeric(camps$cl_Shp_a)

print("g_b_c")
summary(camps$ms_b_c)
print("g_b_a")
summary(camps$ms_b_a)
print("N_HH")
summary(camps$N_HH)
print("cl_Shp_a")
summary(camps$cl_Shp_a)
sum(camps$g_b_c)
```


#____VIDA BUILDINGS____________
#1.(Surveyed population vs _ms building count)plot
```{r}
# Scatter plot with site_status
vida_b_surv<-ggplot(camps, aes(y = vida_b_c, x = N_INDVI, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(vida_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Vida Google-Microsoft building count and survey iom populations",
       y = "Vida building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(vida_b_surv)
```

#2.(Surveyed household vs _ms building count)plot
```{r}
# Scatter plot with site_status
vida_b_hh<-ggplot(camps, aes(y = vida_b_c, x = N_HH, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(vida_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Vida Google-Microsoft building count and IOM survey household count",
       y = "Vida building count",
       x = "Iom surveyed household count") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(vida_b_hh)

```
#3.Site status (InFormal) only vida_building count vs populatio

```{r}
# 1. Subset the informal camps
informal_camps <- camps %>% filter(Sit_Stt == "Informal")

# 2. Extract relevant columns
data_plot_v<- informal_camps %>%
  select(vida_b_c, N_INDVI,Sit_Stt)

# Scatter plot with site_status
vida_b_inf<-ggplot(data_plot_v, aes(y = vida_b_c, x = N_INDVI,colour=Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(vida_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Vida Google-Microsoft building count and IOM survey populations for informal site status",
       y = "Vida Google-Microsoft building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(vida_b_inf)
corr_vida_b_pop_inf<-cor((as.numeric(camps$vida_b_c)),(as.numeric(camps$N_INDVI)))
print(corr_vida_b_pop_inf)
# correlation is 
#[1] 0.8105563
```

#4.Site status (InFormal) only ms_building count vs number of households
```{r}
# 1. Subset the informal camps
informal_camps <- camps %>% filter(Sit_Stt == "Informal")

# 2. Extract relevant columns
data_plot_vida <- informal_camps %>%
  select(vida_b_c, N_HH,Sit_Stt)

# Scatter plot with site_status
vida_b_inf_h<-ggplot(data_plot_vida, aes(y = vida_b_c, x = N_HH,colour=Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(vida_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Vida Google-Microsoft building count and IOM survey household count for informal site status",
       y = "Vida Google Microsoft building count",
       x = "Iom surveyed household count") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(vida_b_inf_h)
corr_vida_b_hh_inf<-cor((as.numeric(informal_camps$vida_b_c)),(as.numeric(informal_camps$N_INDVI)))
print(corr_vida_b_hh_inf)
# correlation is 
# [1] 0.7165895
```

#5.Site status (Formal) only ms_building count vs survey population
```{r}
# 1. Subset the formal camps
formal_camps <- camps %>% filter(Sit_Stt == "Formal")

# 2. Extract relevant columns
data_plot_vida_f <- formal_camps %>%
  select(vida_b_c, N_INDVI,Sit_Stt)

# Scatter plot with site_status
vida_b_for<-ggplot(data_plot_vida_f, aes(y = vida_b_c, x = N_INDVI,colour=Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(vida_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Vida Microsoft Google building count and IOM survey populations for formal site status",
       y = "Vida Google-microsoft building count",
       x = "Iom surveyed population(formal sites") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
print(vida_b_for)
corr_vida_b_pop_f<-cor((as.numeric(formal_camps$vida_b_c)),(as.numeric(formal_camps$N_INDVI)))
print(corr_vida_b_pop_f)
# correlation is 
# [1] 0.8083177
```

#6.Site status (Formal) only vida_building count vs number of households
```{r}
# 1. Subset the formal camps
formal_camps <- camps %>% filter(Sit_Stt == "Formal")

# 2. Extract relevant columns
data_plot_vida_f <- formal_camps %>%
  select(vida_b_c, N_INDVI,Sit_Stt)

# Scatter plot with site_status
vida_b_for_hh<-ggplot(data_plot_vida_f, aes(y = vida_b_c, x = N_HH,colour=Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(vida_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between vida Microsoft-Google building count and IOM survey household count for formal site status",
       y = "Vida Microsoft-Google building count",
       x = "Iom surveyed household count(formal sites") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
print(vida_b_for)
corr_vida_b_hh_f<-cor((as.numeric(formal_camps$vida_b_c)),(as.numeric(formal_camps$N_HH)))
print(corr_vida_b_hh_f)
# correlation is 
#[1] 0.7554208

```
#7. Site_type plot for vida_building and population
```{r}
# Scatter plot with site_status
vida_b_st_typ<-ggplot(camps, aes(y = vida_b_c, x = N_INDVI, color = Sit_Typ)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(vida_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Google building count and survey iom populations with Site Type ",
       y = "Google building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(vida_b_st_typ)
```


#8. Site type plot for vid_building and survey household
```{r}
# Scatter plot with site_status
vida_hh_st_typ<-ggplot(camps, aes(y = vida_b_c, x = N_HH, color = Sit_Typ)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(vida_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Vida Microsoft-Google building count and survey household number with Site Type ",
       y = "Vida Microsoft-Google building count",
       x = "Iom surveyed household number") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(vida_hh_st_typ)
```

#9. Site class(spontaneous/planned) plot for ms_building and survey population
```{r}
# Scatter plot with site_status
vida_b_st_typ<-ggplot(camps, aes(y = vida_b_c, x = N_INDVI, color = St_clss)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(vida_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Vida Microsoft Google building count and survey iom populations with Site Class ",
       y = "Vida Microsoft Google building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(vida_b_st_typ)
```

#10.Shelter type plot for survey population vs ms building counts
```{r}
# Scatter plot with site_status
vida_b_sl_typ<-ggplot(camps, aes(y = vida_b_c, x = N_INDVI, color = Shlt_ty)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(vida_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Vida Microsoft google building count and survey iom populations with Shelter type ",
       y = "Vida Microsoft Google building count",
       x = "Iom surveyed population") +
  theme_minimal()  # Adjust axis scale to start from zero
print(vida_b_sl_typ)
```


#11.Shelter type plot for survey household count vs ms building counts
```{r}
# Scatter plot with site_status
vida_hh_sl_typ_hh<-ggplot(camps, aes(y = vida_b_c, x = N_HH,colour=Shlt_ty)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(vida_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Vida Microsoft Google building count and IOM survey household count for different shelter type",
       y = "vida Microsoft Google building count",
       x = "Iom surveyed household count") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
print(vida_hh_sl_typ_hh)
```

#Vida building stats(Mean of building area/density and count)
```{r}


camps$vida_b_a <- as.numeric(camps$vida_b_a)
camps$vida_b_c <- as.numeric(camps$vida_b_c)
camps$N_HH<-as.numeric(camps$N_HH)
camps$cl_Shp_a<-as.numeric(camps$cl_Shp_a)

print("vida_b_c")
summary(camps$vida_b_c)
print("vida_b_a")
summary(camps$vida_b_a)
print("N_HH")
summary(camps$N_HH)
print("cl_Shp_a")
summary(camps$cl_Shp_a)
sum(camps$vida_b_c)
```



#___OPEN STREET MAP BUILDINGS____


#1.(Surveyed population vs _ms building count)plot

```{r}
# Scatter plot with site_status
osm_b_surv<-ggplot(camps, aes(y = osm_b_c, x = N_INDVI, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(osm_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Open Street map data building count and survey iom populations",
       y = "OSM building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(osm_b_surv)
```


#2.(Surveyed household vs _ms building count)plot
```{r}
# Scatter plot with site_status
osm_b_hh<-ggplot(camps, aes(y = osm_b_c, x = N_INDVI, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(osm_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Open Street map data building count and IOM survey household",
       y = "OSM building count",
       x = "Iom surveyed household count") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(osm_b_hh)
```

#3.Site status (InFormal) only osm_building count vs population

```{r}
# 1. Subset the informal camps
informal_camps <- camps %>% filter(Sit_Stt == "Informal")

# 2. Extract relevant columns
data_plot_o<- informal_camps %>%
  select(osm_b_c, N_INDVI,Sit_Stt)

# Scatter plot with site_status
osm_b_inf<-ggplot(data_plot_o, aes(y = osm_b_c, x = N_INDVI,colour=Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(osm_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Open street map building count and IOM survey populations for informal site status",
       y = "Open street map building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(osm_b_inf)
corr_vida_b_pop_inf<-cor((as.numeric(camps$osm_b_c)),(as.numeric(camps$N_INDVI)))
print(corr_vida_b_pop_inf)
# correlation is 
#[1] 0.448753
```



#4.Site status (InFormal) only osm_building count vs number of households
```{r}
# 1. Subset the informal camps
informal_camps <- camps %>% filter(Sit_Stt == "Informal")

# 2. Extract relevant columns
data_plot_osm <- informal_camps %>%
  select(osm_b_c, N_HH,Sit_Stt)

# Scatter plot with site_status
osm_b_inf_h<-ggplot(data_plot_osm, aes(y = osm_b_c, x = N_HH,colour=Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(osm_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Open street map building count and IOM survey household count for informal site status",
       y = "Open street map building count",
       x = "Iom surveyed household count") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(osm_b_inf_h)
corr_osm_b_hh_inf<-cor((as.numeric(informal_camps$osm_b_c)),(as.numeric(informal_camps$N_INDVI)))
print(corr_osm_b_hh_inf)
# correlation is 
# [1] 0.3703314
```



#5.Site status (Formal) only osm_building count vs survey population
```{r}
# 1. Subset the formal camps
formal_camps <- camps %>% filter(Sit_Stt == "Formal")

# 2. Extract relevant columns
data_plot_osm_f <- formal_camps %>%
  select(osm_b_c, N_INDVI,Sit_Stt)

# Scatter plot with site_status
osm_b_for<-ggplot(data_plot_osm_f, aes(y = osm_b_c, x = N_INDVI,colour=Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(osm_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Open street map  building count and IOM survey populations for formal site status",
       y = "Open street map building count",
       x = "Iom surveyed population(formal sites") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
print(osm_b_for)
corr_osm_b_pop_f<-cor((as.numeric(formal_camps$osm_b_c)),(as.numeric(formal_camps$N_INDVI)))
print(corr_osm_b_pop_f)
# correlation is 
# [1] 0.3909571
```


#6.Site status (Formal) only osm_building count vs number of households
```{r}
# 1. Subset the formal camps
formal_camps <- camps %>% filter(Sit_Stt == "Formal")

# 2. Extract relevant columns
data_plot_osm_f <- formal_camps %>%
  select(osm_b_c, N_INDVI,Sit_Stt)

# Scatter plot with site_status
osm_b_for_hh<-ggplot(data_plot_osm_f, aes(y = osm_b_c, x = N_HH,colour=Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(osm_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Open street map building count and IOM survey household count for formal site status",
       y = "Open street map building count",
       x = "Iom surveyed household count(formal sites") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
print(osm_b_for)
corr_osm_b_hh_f<-cor((as.numeric(formal_camps$osm_b_c)),(as.numeric(formal_camps$N_HH)))
print(corr_osm_b_hh_f)
# correlation is 
#[1] 0.2408845

```

#7. Site_type plot for osm_building and population
```{r}
# Scatter plot with site_status
osm_b_st_typ<-ggplot(camps, aes(y = osm_b_c, x = N_INDVI, color = Sit_Typ)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(osm_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Open street map and survey iom populations with Site Type ",
       y = "Open street map building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(osm_b_st_typ)
```

#8. Site type plot for osm_building and survey household
```{r}
# Scatter plot with site_status
osm_hh_st_typ<-ggplot(camps, aes(y = osm_b_c, x = N_HH, color = Sit_Typ)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(osm_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Open street map building count and survey household number with Site Type ",
       y = "Open street map building count",
       x = "Iom surveyed household number") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(osm_hh_st_typ)
```
#9. Site class(spontaneous/planned) plot for osm_building and survey population
```{r}
# Scatter plot with site_status
osm_b_st_typ<-ggplot(camps, aes(y = osm_b_c, x = N_INDVI, color = St_clss)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(osm_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Open street map building count and survey iom populations with Site Class ",
       y = "Open street map building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
  print(osm_b_st_typ)
```

#10.Shelter type plot for survey population vs ms building counts
```{r}
# Scatter plot with site_status
osm_b_sl_typ<-ggplot(camps, aes(y = osm_b_c, x = N_INDVI, color = Shlt_ty)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(osm_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Open street map building count and survey iom populations with Shelter type ",
       y = "Open street map building count",
       x = "Iom surveyed population") +
  theme_minimal()  # Adjust axis scale to start from zero
print(osm_b_sl_typ)
```

#11.Shelter type plot for survey household count vs osm building counts
```{r}
# Scatter plot with site_status
osm_hh_sl_typ_hh<-ggplot(camps, aes(y = osm_b_c, x = N_HH,colour=Shlt_ty)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(osm_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = "Comparison between Open street map building count and IOM survey household count for different shelter type",
       y = "open street map building count",
       x = "Iom surveyed household count") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))  # Adjust axis scale to start from zero
print(osm_hh_sl_typ_hh)
```
#OSM building stats(Mean of building area/density and count)

```{r}


camps$osm_b_a <- as.numeric(camps$osm_b_a)
camps$osm_b_c <- as.numeric(camps$osm_b_c)
camps$N_HH<-as.numeric(camps$N_HH)
camps$cl_Shp_a<-as.numeric(camps$cl_Shp_a)

print("osm_b_c")
summary(camps$osm_b_c)
print("osm_b_a")
summary(camps$osm_b_a)
print("N_HH")
summary(camps$N_HH)
print("cl_Shp_a")
summary(camps$cl_Shp_a)
sum(camps$osm_b_c)
```


#________________________________
#combining the plots 
#BUILDING+POPULATION
##**%%%Combining the scatterplots for all the Building datsets+ Population in one plot%%%%%

```{r}
library(gridExtra)
# Scatter plot with site_status
ms_b_surv<-ggplot(camps, aes(y = ms_b_c, x = N_INDVI, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(ms_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  
  labs(title = "Comparison between MS building count and survey iom populations",
       y = "Microsoft building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))+
   theme_minimal()+theme(plot.title = (element_text(size = 9,colour = "Red")),axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))# Adjust axis scale to start from zero
 



# Scatter plot with site_status
g_b_surv<-ggplot(camps, aes(y = g_b_c, x = N_INDVI, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(g_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  
  labs(title = NULL,
       y = "Google building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))+
   theme_minimal()+theme(axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))# Adjust axis scale to start from zero
 
  
 # Scatter plot with site_status
vida_b_surv<-ggplot(camps, aes(y = vida_b_c, x = N_INDVI, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(vida_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  
  labs(title = NULL,
       y = "Vida building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))+ theme_minimal()+theme(axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))  # Adjust axis scale to start from zero
  
  
  
  # Scatter plot with site_status
osm_b_surv<-ggplot(camps, aes(y = osm_b_c, x = N_INDVI, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(osm_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  
  labs(title = NULL,
       y = "OSM building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))+
   theme_minimal()+theme(axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))# Adjust 

# Combine all scatter plots into one
combined_plot_b <- grid.arrange(ms_b_surv,g_b_surv, vida_b_surv, osm_b_surv, nrow = 2, ncol = 2)

# Print the combined plot
print(combined_plot_b)
  
  
  
```


#COMBINED PLOT SAVE
```{r}
# Save the plot to a file
ggsave("Plots/building_survey_pop_comb.png", plot =combined_plot_b , width = 8, height = 6, dpi = 400)
```


#BUILDING +HOUSEHOLD(COMBINED)


##**%%%Combining the scatterplots for all the Building datsets+ Household in one plot%%%%%

```{r}
library(gridExtra)
# Scatter plot with site_status
# Scatter plot with site_status
ms_b_surv_hh<-ggplot(camps, aes(y = ms_b_c, x = N_HH, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(ms_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  
  labs(title = "Comparison between MS building count and survey household number",
       y = "Microsoft building count",
       x = "Iom surveyed Household count") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))+
  theme(plot.title = (element_text(size = 9,colour = "Red")),axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))# Adjust axis scale to start from zero


 


# Scatter plot with site_status
g_b_hh<-ggplot(camps, aes(y = g_b_c, x = N_HH, color = Sit_Stt)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(g_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  
  labs(title = NULL,
       y = "Google building count",
       x = "Iom surveyed household count") +scale_x_continuous(expand = c(0,0))+
   theme_minimal()+theme(axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))# Adjust axis scale to start from zero
 
  
# Scatter plot with site_status
vida_b_hh<-ggplot(camps, aes(y = vida_b_c, x = N_HH, color = Sit_Stt)) +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_HH) , y = as.numeric(vida_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = NULL,
       y = "Vida building count",
       x = "Iom surveyed household count") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))+
  theme_minimal()+theme(axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))  # Adjust axis scale to start from zero
  
  
  
  # Scatter plot with site_status
# Scatter plot with site_status
osm_b_hh<-ggplot(camps, aes(y = osm_b_c, x = N_INDVI, color = Sit_Stt)) +geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(osm_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+
  
  labs(title = NULL,
       y = "OSM building count",
       x = "Iom surveyed household count") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))+
   theme(axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))# Adjust 

# Combine all scatter plots into one
combined_plot_b_hh <- grid.arrange(ms_b_surv_hh,g_b_hh,vida_b_hh, osm_b_hh, nrow = 2, ncol = 2)

# Print the combined plot
print(combined_plot_b_hh)
  
  
  
```


#COMBINED PLOT SAVE
```{r}
# Save the plot to a file
ggsave("Plots/building_survey_hh_comb.png", plot =combined_plot_b_hh , width = 8, height = 6, dpi = 400)
```




#_________________________________________________
#BUIDING SUMMARY STATISTIC PLOTS
#1.BAR PLOT(BUILDING COUNT)
```{r}

# Aggregate the counts
summarized_data <- camps %>%
  summarise(Google = sum(g_b_c, na.rm = TRUE),
            OSM = sum(osm_b_c, na.rm = TRUE),
            Microsoft = sum(ms_b_c, na.rm = TRUE),
            VIDA = sum(vida_b_c, na.rm = TRUE))


summarized_data <- data.frame(
  source = c("Google", "OSM", "Microsoft", "VIDA"),
  building_count = c(170437, 26323, 67317, 185608)
)

# Plotting
bar_plot <- ggplot(summarized_data, aes(x = source, y = building_count, fill = source)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = building_count), vjust = -0.5) +  # Add text labels above the bars
  labs(x = "Data Source", y = "Building Count", title = "Total Building Counts by Data Source") +
  scale_fill_manual(values = c("Google" = "skyblue", "OSM" = "orange", "Microsoft" = "green", "VIDA" = "red")) +
  theme_minimal() +
  theme(legend.position = "none")


# Show the plot
print(bar_plot)
```

#(BAR PLOT SAVE)
```{r}
# Save the plot to a file
ggsave("Plots/building_count_bar.png", plot =bar_plot , width = 8, height = 6, dpi = 400)
```
#_________________________________________

#Coorelation matrix for the building stats
```{r}

camps$N_INDVI <- as.numeric(camps$N_INDVI)
camps$N_HH <- as.numeric(camps$N_HH)
camps$ms_b_c <- as.numeric(camps$ms_b_c)
camps$g_b_c<- as.numeric(camps$g_b_c)
camps$vida_b_c<- as.numeric(camps$vida_b_c)
camps$osm_b_c<-as.numeric(camps$osm_b_c)

# Calculate correlation coefficients
corr_ms_b_c <- cor(camps$N_INDVI,camps$ms_b_c)
corr_g_b_c<-cor(camps$N_INDVI,camps$g_b_c)
corr_vida_b_c<-cor(camps$N_INDVI,camps$vida_b_c)
corr_osm_b_c<-cor(camps$N_INDVI,camps$osm_b_c)
corr_ms_b_c_hh <- cor(camps$N_HH,camps$ms_b_c)
corr_g_b_c_hh<-cor(camps$N_HH,camps$g_b_c)
corr_vida_b_c_hh<-cor(camps$N_HH,camps$vida_b_c)
corr_osm_b_c_hh<-cor(camps$N_HH,camps$osm_b_c)
# View correlation coefficients
print(corr_ms_b_c)
print(corr_g_b_c)
print(corr_vida_b_c)
print(corr_osm_b_c)
print(corr_ms_b_c_hh)
print(corr_g_b_c_hh)
print(corr_vida_b_c_hh)
print(corr_osm_b_c_hh)
# Convert spatial object to data frame without geometry
camps_data_nogeom <- st_drop_geometry(camps)

# Define numeric columns
numeric_cols_b <- c("N_INDVI","N_HH","g_b_c","ms_b_c","vida_b_c","osm_b_c")

# Convert selected columns to numeric, handling non-numeric values
for (col in numeric_cols_b) {
  camps_data_nogeom[[col]] <- as.numeric(as.character(camps_data_nogeom[[col]]))
}

# Calculate correlation coefficients
correlation_matrix_building <- cor(camps_data_nogeom[, numeric_cols_b])
print(correlation_matrix_building)
```
#Coorelation heat map and graph

#Heat map of correlation matrix

```{r}
# Convert the correlation matrix to a dataframe
corr_matrix_b <- correlation_matrix_building
# Assign row and column names
rownames(corr_matrix_b) <- colnames(corr_matrix_b) <- c("N_INDVI","N_HH","g_b_c","ms_b_c","vida_b_c","osm_b_c")
# Convert the correlation matrix to long format
corr_matrix_long_b <- melt(corr_matrix_b)

# Plot the heatmap with lighter color and correlation values
heat_map_corr_b <- ggplot(data = corr_matrix_long_b, aes(x = Var1, y = Var2, fill = value, label = round(value, 2))) +
  geom_tile(color = "white") +
  geom_text(color = "black", size = 2) +
  scale_fill_gradient(low = "lightblue", high = "lightcoral") +
  labs(title = "Correlation Matrix Heatmap ",
       x = "Variables",
       y = "Variables") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

print(heat_map_corr_b)

```
#save correlation matrix
```{r}
# Save the plot to a file
ggsave("Plots/heat_map_corr_building.png", plot =heat_map_corr_b, width = 8, height = 6, dpi = 400)
```

#informal camp household buildstat correlation
```{r}

informal_camps$N_HH <- as.numeric(informal_camps$N_HH)
informal_camps$g_b_c <- as.numeric(informal_camps$g_b_c)
informal_camps$ms_b_c <- as.numeric(informal_camps$ms_b_c)
informal_camps$vida_b_c<- as.numeric(informal_camps$vida_b_c)
informal_camps$osm_b_c <- as.numeric(informal_camps$osm_b_c)
informal_camps$gpw_UN<-as.numeric(informal_camps$gpw_UN)


# Calculate correlation coefficients
corr_g_b_HH_if <- cor(informal_camps$N_HH,informal_camps$g_b_c)
corr_ms_b_HH_if<-cor(informal_camps$N_HH,informal_camps$ms_b_c)
corr_vida_HH_if<-cor(informal_camps$N_HH,informal_camps$vida_b_c)
corr_osm_HH_if<-cor(informal_camps$N_HH,informal_camps$osm_b_c)

# View correlation coefficients

print(paste("Google:",corr_g_b_HH_if))
print(paste("Microsoft:",corr_ms_b_HH_if))
print(paste("Vida",corr_vida_HH_if))
print(paste("osm:",corr_osm_HH_if))



```

```{r}
# Create a matrix of correlation coefficients
cor_matrix_hh_if_b <- matrix(c(corr_g_b_HH_if, corr_ms_b_HH_if, corr_vida_HH_if, corr_osm_HH_if),
                     nrow = 1, byrow = TRUE,
                     dimnames = list(c("N_HH"), c("google", "ms", "vida", "osm")))

# Plot the correlation matrix
corrplot(cor_matrix_hh_if_b, method = "color", type = "upper", 
         addCoef.col = "black", tl.col = "black", tl.srt = 45)
```
#formal camp household buildstat correlation
```{r}

formal_camps$N_HH <- as.numeric(formal_camps$N_HH)
formal_camps$g_b_c <- as.numeric(formal_camps$g_b_c)
formal_camps$ms_b_c <- as.numeric(formal_camps$ms_b_c)
formal_camps$vida_b_c<- as.numeric(formal_camps$vida_b_c)
formal_camps$osm_b_c <- as.numeric(formal_camps$osm_b_c)



# Calculate correlation coefficients
corr_g_b_HH_f <- cor(formal_camps$N_HH,formal_camps$g_b_c)
corr_ms_b_HH_f<-cor(formal_camps$N_HH,formal_camps$ms_b_c)
corr_vida_HH_f<-cor(formal_camps$N_HH,formal_camps$vida_b_c)
corr_osm_HH_f<-cor(formal_camps$N_HH,formal_camps$osm_b_c)

# View correlation coefficients

print(paste("Google:",corr_g_b_HH_f))
print(paste("Microsoft:",corr_ms_b_HH_f))
print(paste("Vida",corr_vida_HH_f))
print(paste("osm:",corr_osm_HH_f))



```
```{r}
# Create a matrix of correlation coefficients
cor_matrix_hh_f_b <- matrix(c(corr_g_b_HH_f, corr_ms_b_HH_f, corr_vida_HH_f, corr_osm_HH_f),
                     nrow = 1, byrow = TRUE,
                     dimnames = list(c("N_HH"), c("google", "ms", "vida", "osm")))

# Plot the correlation matrix
corrplot(cor_matrix_hh_f_b, method = "color", type = "upper", 
         addCoef.col = "black", tl.col = "black", tl.srt = 45)
```
#A<10000 Correlation(calculation correlation for N_HH and building footprint for area less than 10,000)
```{r}
#correlation for the area>10000msq and area<10000msq

subset_data_2$N_HH<- as.numeric(subset_data_2$N_HH)
subset_data_2$g_b_c <- as.numeric(subset_data_2$g_b_c)
subset_data_2$ms_b_c <- as.numeric(subset_data_2$ms_b_c)
subset_data_2$vida_b_c<- as.numeric(subset_data_2$vida_b_c)
subset_data_2$osm_b_c <- as.numeric(subset_data_2$osm_b_c)


# Calculate correlation coefficients
corr_gbc_areal_hh <- cor(subset_data_2$N_HH,subset_data_2$g_b_c)
corr_msbc_areal_hh <-cor(subset_data_2$N_HH,subset_data_2$ms_b_c)
corr_vidabc_areal_hh <-cor(subset_data_2$N_HH,subset_data_2$vida_b_c)
corr_osm_areal_hh <-cor(subset_data_2$N_HH,subset_data_2$osm_b_c)

#View correlation coefficients

print(paste("google:",corr_gbc_areal_hh))
print(paste("ms:",corr_msbc_areal_hh))
print(paste("vida",corr_vidabc_areal_hh))
print(paste("osm:",corr_osm_areal_hh))



```
# one line corr_mtrix doing the correlation matrix n_hh and building stats for area<10000

```{r}
# Create a matrix of correlation coefficients
cor_matrix_areal_hh_b<- matrix(c(corr_gbc_areal_hh, corr_msbc_areal_hh, corr_vidabc_areal_hh, corr_osm_areal_hh),
                     nrow = 1, byrow = TRUE,
                     dimnames = list(c("N_HH"), c("google", "microsoft", "vida", "osm")))

# Plot the correlation matrix
corrplot(cor_matrix_areal_hh_b , method = "color", type = "upper", 
         addCoef.col = "black", tl.col = "black", tl.srt = 45)
```

#A>10000 Correlation(calculation correlation for N_HH and building count for area greater than 10,000)
```{r}
#correlation for the area>10000msq and area<10000msq

subset_data$N_HH<- as.numeric(subset_data$N_HH)
subset_data$g_b_c <- as.numeric(subset_data$g_b_c)
subset_data$ms_b_c <- as.numeric(subset_data$ms_b_c)
subset_data$vida_b_c<- as.numeric(subset_data$vida_b_c)
subset_data$osm_b_c <- as.numeric(subset_data$osm_b_c)


# Calculate correlation coefficients
corr_g_b_c_areag_hh_b <- cor(subset_data$N_HH,subset_data$g_b_c)
corr_ms_b_c_areag_hh_b <-cor(subset_data$N_HH,subset_data$ms_b_c)
corr_vida_b_c_areag_hh_b <-cor(subset_data$N_HH,subset_data$vida_b_c)
corr_osm_b_c_areag_hh_b <-cor(subset_data$N_HH,subset_data$osm_b_c)

# View correlation coefficients

print(paste("Google:",corr_g_b_c_areag_hh_b))
print(paste("Microsoft:",corr_ms_b_c_areag_hh_b))
print(paste("Vida:",corr_vida_b_c_areag_hh_b))
print(paste("Osm:",corr_osm_b_c_areag_hh_b))

# [1] "Google: 0.712686937465869"
# [1] "Microsoft: 0.802959860658037"
# [1] "Vida: 0.750913351069896"
# [1] "Osm: 0.323667228656864"


```


# one line corr_mtrix doing the correlation matrix n_indvi and estimated populations for area>10000

```{r}
# Create a matrix of correlation coefficients
cor_matrix_areag_hh_b <- matrix(c(corr_g_b_c_areag_hh_b , corr_ms_b_c_areag_hh_b,corr_vida_b_c_areag_hh_b, corr_osm_b_c_areag_hh_b),
                     nrow = 1, byrow = TRUE,
                     dimnames = list(c("N_HH"), c("google", "microsoft", "vida", "osm")))

# Plot the correlation matrix
corrplot(cor_matrix_areag_hh_b , method = "color", type = "upper", 
         addCoef.col = "black", tl.col = "black", tl.srt =45)
```


           
           
# BUILDING STATS-HOUSEHOLD DIFFERENCE 
#BUILDING difference e summary
```{r}
# Subtract N_INDVID from ras_name
camps$g_bc_df <- camps$N_HH - camps$g_b_c
camps$ms_bc_df <- camps$N_HH - camps$ms_b_c
camps$vida_bc_df <- camps$N_HH - camps$vida_b_c
camps$osm_bc_df <- camps$N_HH - camps$osm_b_c

print('g_c_bdifference')
summary(camps$g_bc_df)
print('ms_bc_dfdifference')
summary(as.numeric(camps$ms_bc_df))
print('vida_bc_df_difference')
summary(as.numeric(camps$vida_bc_df))
print('osm_bc_df_difference')
summary(as.numeric(camps$osm_bc_df))




```
#Boxplot of the difference of building fooft print n pdt and N_HH



#box plot with mean value displayed
```{r}
library(ggplot2)

# Combine all population difference columns into one data frame
difference_data_building <- data.frame(
  Dataset_build = rep(c("GOOGLE",  "OSM","MICROSOFT", "VIDA"), each = nrow(camps)),
  Building_Difference = c(as.numeric(camps$g_bc_df), as.numeric(camps$osm_bc_df), as.numeric(camps$ms_bc_df),as.numeric(camps$vida_bc_df)))


# Calculate mean values
mean_values <- aggregate(Building_Difference ~ Dataset_build, data = difference_data_building, mean)

# Create a box plot
boxplot_build_diff <- ggplot(difference_data_building, aes(x = Dataset_build, y = Building_Difference)) +
  geom_boxplot(fill = "skyblue", color = "black") +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 1, color = "red") + # Adding mean points
  geom_text(data = mean_values, aes(label = round(Building_Difference, digits = 2)), vjust = -0.5,size=2) + # Adding text labels
  labs(title = "Difference between Surveyed Household and Building count(Survey-Estimate) for different Building footprint data products",
       x = "Dataset", y = "Building count Difference") +
  theme_minimal() +
 theme(axis.text.x = element_text(angle = 45, hjust = 1), 
        plot.title = element_text(size = 10)) # Rotate x-axis labels

# Print the box plot
print(boxplot_build_diff)


```

```{r}

# Save the plot to a file
ggsave("D:/EAGLE/Master_Thesis_Hannes/1/R/Lallu_thesis/Plots/error_building_hh .png", plot =boxplot_build_diff , width = 8, height = 6, dpi = 400)
```


#__RATIOS OF ERROR____
#ratio of error for EO datasets 
```{r}
# Calculate the ratio of the difference to the surveyed population
difference_data_building$ratio <- difference_data_building$Building_Difference / camps$N_HH

# Aggregate mean ratio values
mean_ratio_values_build <- aggregate(ratio ~ Dataset_build, data = difference_data_building, mean)

# Create a box plot for the ratios
boxplot_ratio_build <- ggplot(difference_data_building, aes(x = Dataset_build, y = ratio)) +
  geom_boxplot(fill = "skyblue", color = "black") +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 1, color = "red") +
  geom_text(data = mean_ratio_values_build, aes(label = round(ratio, digits = 2)), vjust = -0.5, size = 2,color='Red') +
  labs(title = "Ratio of Difference to Survey Household for Different Buildingin footprint Data Products",
       x = "Dataset", y = "Ratio of Difference to Survey Household number") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        plot.title = element_text(size = 10))

# Print the box plot
print(boxplot_ratio_build)




```

```{r}

# Save the plot to a file
ggsave("D:/EAGLE/Master_Thesis_Hannes/1/R/Lallu_thesis/Plots/ratio_error_building_hh .png", plot =boxplot_ratio_build , width = 8, height = 6, dpi = 400)
```

#BUILDING AND SHELTER TYPE

```{r}
# Reshape the data to long format for easier plotting
buildings_long <- camps %>%
  select(Shlt_ty, g_b_c, ms_b_c, vida_b_c, osm_b_c) %>%
  pivot_longer(cols = c(g_b_c, ms_b_c, vida_b_c, osm_b_c), names_to = "Building_Source", values_to = "Total_Buildings")

# Plotting a grouped bar plot
build_shlt_typ<-ggplot(buildings_long, aes(x = Shlt_ty, y = Total_Buildings, fill = Building_Source)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Shelter Type", y = "Count", title = "Number of Buildings by Shelter Type and Source") +
  theme_minimal() +
  theme(legend.position = "top", axis.text.x = element_text(angle = 45, hjust = 1))

print(build_shlt_typ)
```


```{r}
# Load the dplyr package
library(dplyr)

# Convert the sf object to a data frame
camps_df <- as.data.frame(camps)

# Reshape the data to long format for easier plotting
data_long <- camps_df %>%
  dplyr::select(Shlt_ty, g_b_c, ms_b_c, vida_b_c, osm_b_c, N_HH) %>%
  pivot_longer(cols = c(g_b_c, ms_b_c, vida_b_c, osm_b_c, N_HH), 
               names_to = "Variable", 
               values_to = "Value")

# Plotting a grouped bar plot
plot <- ggplot(data_long, aes(x = Shlt_ty, y = Value, fill = Variable)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Shelter Type", y = "Count", title = "Number of Buildings and Survey Households by Shelter Type and Source") +
  theme_minimal() +
  theme(legend.position = "top", axis.text.x = element_text(angle = 45, hjust = 1))

print(plot)

```



#(BAR PLOT SAVE)
```{r}
# Save the plot to a file
ggsave("Plots/building_count_shelter_type.png", plot =plot , width = 8, height = 6, dpi = 400)
```

# BUILDING AND SITE TYPE
```{r}
library(ggplot2)
library(dplyr)

# Reshape the data to long format for easier plotting
buildings_long <- camps %>%
  select(Sit_Typ, g_b_c, ms_b_c, vida_b_c, osm_b_c) %>%
  pivot_longer(cols = c(g_b_c, ms_b_c, vida_b_c, osm_b_c), names_to = "Building_Source", values_to = "Total_Buildings")

# Calculate the maximum value for each source separately for each site type
max_values <- buildings_long %>%
  group_by(Sit_Typ, Building_Source) %>%
  summarise(max_buildings = max(Total_Buildings, na.rm = TRUE))

# Plotting a grouped bar plot
buildings_plot <- ggplot(buildings_long, aes(x = Sit_Typ, y = Total_Buildings, fill = Building_Source)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(data = max_values, aes(label = max_buildings, y = max_buildings), vjust = -0.5, size = 2, position = position_dodge(width = 0.9)) +
  labs(x = "Site Type", y = "Number of Buildings", title = "Number of Buildings by Site Type and Source") +
  theme_minimal() +
  theme(legend.position = "top", axis.text.x = element_text(angle = 45, hjust = 1))

print(buildings_plot)


```







```{r}
library(ggplot2)
library(dplyr)
library(sf)

# Convert the 'camps' sf object to a data frame
camps_df <- st_drop_geometry(camps)

# Reshape the data to long format for easier plotting
buildings_long <- camps_df %>%
  select(Name, Sit_Typ, g_b_c, ms_b_c, vida_b_c, osm_b_c) %>%
  pivot_longer(cols = c(g_b_c, ms_b_c, vida_b_c, osm_b_c), names_to = "Building_Source", values_to = "Total_Buildings")

# Calculate the maximum value for each source separately for each site type
max_values <- buildings_long %>%
  group_by(Sit_Typ, Building_Source) %>%
  summarise(max_buildings = max(Total_Buildings, na.rm = TRUE))

# Plotting a grouped bar plot
buildings_plot <- ggplot(buildings_long, aes(x = Sit_Typ, y = Total_Buildings, fill = Building_Source)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(data = max_values, aes(label = max_buildings, y = max_buildings), vjust = -0.5, size = 3, position = position_dodge(width = 0.9)) +
  labs(x = "Site Type", y = "Number of Buildings", title = "Number of Buildings by Site Type and Source") +
  theme_minimal() +
  theme(legend.position = "top", axis.text.x = element_text(angle = 45, hjust = 1))

print(buildings_plot)

```



#___________________________________
#URBAN_RURAL 
#Load the data which also has the urban rural classification for the camp sites 
```{r}
camp_fin_path<-("D:/EAGLE/Master_Thesis_Hannes/1/R/Lallu_thesis/all_pop_output/all_ur_build_eo_camp/camp_fin.shp")
camp_final<-st_read(camp_fin_path)
head(camp_final)
```


#deleting the BO_S294

```{r}
# Delete row with Name "BO_S294"
camp_final <- subset(camp_final, Name != "BO_S294")

```

#Plots using the Urban- rural classification from GRD3 .

#1.Checking the formal and informal distribution of the camp and their presence in the urban -rural set up
#A. a bar plot or count plot to visualize the distribution of Sit_Stt within each category of dou_level1.

```{r}

# Convert factors to character to avoid issues in ggplot2
camp_final$dou_level1 <- as.character(camp_final$dou_level1)
camp_final$Sit_Stt <- as.character(camp_final$Sit_Stt)

# Create a count plot
dou_1_sit_stt<-ggplot(camp_final, aes(x = dou_level1, fill = Sit_Stt)) +
  geom_bar(position = "dodge", color = "black") +
  geom_text(stat = 'count', aes(label = ..count..), position = position_dodge(width = 0.9), vjust = -0.5) +
  labs(x = "Degree of Urbanisation Level 1", y = "Count", fill = "Site Status") +
  theme_minimal()
print(dou_1_sit_stt)

```
#Analysis
#Rural region has the least number of camps overall and the presence of formal camps can also be seen very less.
#Whilt most of the refugee sites are distributed and remain the urban center of the both fomal and informal
#And several informal camps are the main refugee accomodations in the region.
#save dou-1 and site status
```{r}
# Save the plot to a file
ggsave("Plots/dou_1_st_sta_bar.png", plot =dou_1_sit_stt, width = 8, height = 6, dpi = 400)
```

#Percentage calcutation for the above
```{r}

# Assuming your data frame is named 'camp_final'

# Convert 'camp_final' to an sf object
camp_final_sf <- st_as_sf(camp_final)

# Calculate counts for each combination of dou_level1 and Sit_Stt
counts <- camp_final_sf %>%
  st_drop_geometry() %>%
  group_by(dou_level1, Sit_Stt) %>%
  summarise(count = n()) %>%
  ungroup()

# Calculate total counts for each level of dou_level1
total_counts <- counts %>%
  group_by(dou_level1) %>%
  summarise(total_count = sum(count))

# Join counts with total_counts to calculate percentages
counts <- counts %>%
  left_join(total_counts, by = "dou_level1") %>%
  mutate(percentage = (count / total_count) * 100)

# Print out the percentages
print(counts)

```



#Analysis

#The result provides information on the distribution of camps based on their formal or informal status (Sit_Stt) within different levels of development (dou_level1). Here's a breakdown of the information:

<!-- Rural: -->

<!-- Formal: There are 3 camps classified as formal out of a total of 12 rural camps, making up 25% of the total rural camps. -->
<!-- Informal: There are 9 camps classified as informal out of a total of 12 rural camps, making up 75% of the total rural camps. -->
<!-- Urban Centre: -->

<!-- Formal: There are 26 camps classified as formal out of a total of 137 urban centre camps, making up approximately 19% of the total urban centre camps. -->
<!-- Informal: There are 111 camps classified as informal out of a total of 137 urban centre camps, making up approximately 81% of the total urban centre camps. -->
<!-- Urban Cluster: -->

<!-- Formal: There are 9 camps classified as formal out of a total of 74 urban cluster camps, making up approximately 12% of the total urban cluster camps. -->
<!-- Informal: There are 65 camps classified as informal out of a total of 74 urban cluster camps, making up approximately 88% of the total urban cluster camps. -->
<!-- Overall, the result provides insights into the proportion of formal and informal camps within different levels of development, highlighting the dominance of informal camps in urban areas compared to formal ones. -->

# POPULATION AND DOU_LEVEL1

```{r}

# Convert factors to character to avoid issues in ggplot2
camp_final$dou_level1 <- as.character(camp_final$dou_level1)

# Create a boxplot to visualize the distribution of population (N_INDVI) within each dou_level1 category
box_dou_indv<-ggplot(camp_final, aes(x = dou_level1, y = N_INDVI)) +
  geom_boxplot() +
  stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "red", show.legend = FALSE) +  # Add median point
  stat_summary(fun = mean, geom = "text", aes(label = round(..y.., 2)), vjust = -0.5, show.legend = FALSE) +  # Add mean text
  labs(x = "Dou Level 1", y = "Population (N_INDVI)", title = "Distribution of Population by GRD3 Degree of urbanisation Level 1") +
  theme_minimal()

print(box_dou_indv)
```


```{r}
# Save the plot to a file
ggsave("Plots/box_dou_indv.png", plot =box_dou_indv, width = 8, height = 6, dpi = 400)
```

#3. Dou_level 1 and  building count
```{r}
# Convert factors to character to avoid issues in ggplot2
camp_final$dou_level1 <- as.character(camp_final$dou_level1)



# Calculate the sum of building count for each dou_level1 and source
camp_final_sum <- camp_final %>%
  group_by(dou_level1) %>%
  summarise(g_b_c_sum = sum(as.numeric(g_b_c)),
            ms_b_c_sum = sum(as.numeric(ms_b_c)),
            osm_b_c_sum = sum(as.numeric(osm_b_c)),
            vida_b_c_sum = sum(as.numeric(vida_b_c))) %>%
  pivot_longer(cols = c(ms_b_c_sum, g_b_c_sum, osm_b_c_sum, vida_b_c_sum),
               names_to = "Source", values_to = "Building_Count")

# Create a stacked horizontal bar plot for building footprint counts by dou_level1
p <- ggplot(camp_final_sum, aes(x = Source, y = Building_Count, fill = dou_level1)) +
  geom_bar(stat = "identity", position = "stack") +
  labs(x = "Source", y = "Total Building Footprint Count", title = "Total Building Footprint Counts by Source") +
  scale_fill_manual(values = c( "coral","lightgreen",  "lightblue"),
                    name = "Degree of urbanisation(Level 1)") +
  scale_x_discrete(labels = c( "Google","Microsoft" , "OSM", "Vida" )) +
  theme_minimal() +
  theme(legend.position = "top")

# Add text labels for the counts on top of each stack
k <- p + geom_text(aes(label = Building_Count), position = position_stack(vjust = 0.5), size = 2, color = "black")

# Print the plot
print(k)

```

```{r}
# Save the plot to a file
ggsave("Plots/dou_1_building_bar.png", plot =k, width = 8, height = 6, dpi = 400)
```

#4. Dou_level and building area
```{r}
library(scales)  # for formatting axis labels

# Assuming your data frame is named 'camp_final'

# Convert factors to character to avoid issues in ggplot2
camp_final$dou_level1 <- as.character(camp_final$dou_level1)

# Calculate the sum of building area for each dou_level1 and source
camp_final_sum <- camp_final %>%
  group_by(dou_level1) %>%
  summarise(ms_b_a_sum = sum(as.numeric(ms_b_a)),
            g_b_a_sum = sum(as.numeric(g_b_a)),
            osm_b_a_sum = sum(as.numeric(osm_b_a)),
            vida_b_a_sum = sum(as.numeric(vida_b_a))) %>%
  pivot_longer(cols = c(ms_b_a_sum, g_b_a_sum, osm_b_a_sum, vida_b_a_sum),
               names_to = "Source", values_to = "Building_Area")

# Convert building area to kilo (1k = 1000)
camp_final_sum$Building_Area <- camp_final_sum$Building_Area / 1000

# Create a stacked horizontal bar plot for building area by dou_level1
p <- ggplot(camp_final_sum, aes(x = Source, y = Building_Area, fill = dou_level1)) +
  geom_bar(stat = "identity", position = "stack") +
  labs(x = "Source", y = "Total Building Area (k m^2)", title = "Total Building Area by Source") +
  scale_fill_manual(values = c("blue", "green", "red", "orange"),
                    name = "Dou Level 1") +
  scale_x_discrete(labels = c("Microsoft", "Google", "OSM", "Vida")) +
  scale_y_continuous(labels = comma_format(scale = 0.001)) +  # Set y-axis labels in "k mode"
  theme_minimal() +
  theme(legend.position = "top")

# Add text labels for the areas on top of each stack
p + geom_text(aes(label = format(Building_Area, big.mark = ",", scientific = FALSE)), position = position_stack(vjust = 0.5), size = 2.5, color = "black")
```

#5. dou_level1 and median footprint stratified by urban, rural classifications
```{r}
# Check if there's any data available in camp_final
if (nrow(camp_final) > 0) {
  # Check if dou_level1 variable is present in camp_final
  if ("dou_level1" %in% colnames(camp_final)) {
    # Filter out non-numeric values in building count columns
    camp_final <- camp_final %>%
      filter(
        is.numeric(ms_b_c),
        is.numeric(g_b_c),
        is.numeric(osm_b_c),
        is.numeric(vida_b_c)
      )
    
    # Check if there's any data available in camp_final after filtering
    if (nrow(camp_final) > 0) {
      # Calculate the median count of building footprints for each camp
      median_counts <- camp_final %>%
        group_by(dou_level1) %>%
        summarise(median_ms = median(ms_b_c),
                  median_google = median(g_b_c),
                  median_osm = median(osm_b_c),
                  median_vida = median(vida_b_c))
      
      # Ensure median_counts has at least one row
      if (nrow(median_counts) > 0) {
        # Add a column for camp index
        median_counts$Camp <- 1:nrow(median_counts)
        
        # Reshape the data into long format for plotting
        median_counts_long <- median_counts %>%
          pivot_longer(cols = c(median_ms, median_google, median_osm, median_vida),
                       names_to = "Source", values_to = "Median_Count")
        
        # Create the lollipop plot
        ggplot(median_counts_long, aes(x = Median_Count, y = Camp, color = Source)) +
          geom_segment(aes(xend = 0, yend = Camp), size = 1) +  # Lollipop stems
          geom_point(size = 3, shape = 18) +  # Lollipop points
          facet_grid(dou_level1 ~ ., scales = "free_y", space = "free_y") +  # Facet by dou_level1
          labs(x = "Median Count of Building Footprints", y = "Camp", title = "Lollipop Plot of Median Count of Building Footprints") +
          scale_color_manual(values = c("blue", "green", "red", "orange"), name = "Source") +
          theme_minimal() +
          theme(legend.position = "top") +
          coord_flip()  # Rotate the plot for better readability
      } else {
        print("No data available for plotting after summarization.")
      }
    } else {
      print("No data available in camp_final after filtering non-numeric values.")
    }
  } else {
    print("The variable 'dou_level1' is missing in camp_final.")
  }
} else {
  print("No data available in camp_final.")
}

```
#site status and dou1 level

```{r}
# Load necessary libraries
library(dplyr)
library(ggplot2)

# Create a new data frame to summarize counts of formal and informal camps by dou_level1
plot_data <- camp_final %>%
  group_by(dou_level1, Sit_Stt) %>%
  summarise(count = n()) %>%
  pivot_wider(names_from = Sit_Stt, values_from = count, values_fill = 0) %>%
  mutate(total = Formal + Informal) %>%
  mutate(formal_prop = Formal / total,
         informal_prop = Informal / total)

# Plot stacked bar plot
ggplot(plot_data, aes(x = dou_level1)) +
  geom_bar(aes(y = formal_prop, fill = "Formal"), stat = "identity") +
  geom_bar(aes(y = informal_prop, fill = "Informal"), stat = "identity") +
  scale_fill_manual(values = c("Formal" = "lightblue", "Informal" = "coral")) +
  labs(x = "Dou Level 1", y = "Proportion", title = "Proportion of Formal and Informal Camps by Dou Level 1") +
  theme_minimal()

```
# Heat map for the site_status and dou_level
```{r}
# Load necessary libraries
library(ggplot2)

# Create a data frame with counts of formal and informal camps by dou_level1 and Sit_Stt
plot_data <- with(camp_final, table(dou_level1, Sit_Stt))

# Convert the table to a data frame
plot_data <- as.data.frame.table(plot_data)

# Create a heatmap
heat_map<-ggplot(plot_data, aes(x = dou_level1, y = Sit_Stt, fill = Freq)) +
  geom_tile() +
   geom_text(aes(label = Freq), color = "black") +  # Add text annotations
  scale_fill_gradient(low = "white", high = "steelblue") +
  labs(title = "Heatmap of Formal and Informal Camps by degree of urbanisation and Site_Status",
       x = "dou_level1", y = "Sit_Stt", fill = "Count")
print(heat_map)
```
#heat map save

```{r}
# Save the plot as an image file
ggsave("D:/EAGLE/Master_Thesis_Hannes/1/R/Lallu_thesis/Plots/heatmap.png", plot = heat_map, width = 8, height = 6, dpi = 300)
```

#Error ratio based on the site status level
```{r}

library(ggplot2)

# Combine all population difference columns into one data frame
difference_data_dou <- data.frame(
  Dataset = rep(c("WP_CON", "WP_UNCON", "GPW", "GHSL", "GPW_UN"), each = nrow(camp_final)),
  Population_Difference_dou = c(as.numeric(camp_final$wp_c_df), as.numeric(camp_final$wp_uc_df),as.numeric(camp_final$gpw_dff), as.numeric(camp_final$ghsl_df),as.numeric(camp_final$gpwU_df)),
  dou_level1 = camp_final$dou_level1  # Adding dou_level1 column
)

# Calculate the ratio of the difference to the surveyed population
difference_data_dou$ratio <- difference_data_dou$Population_Difference_dou / camp_final$N_INDVI

# Aggregate mean ratio values
mean_ratio_values <- aggregate(ratio ~ Dataset + dou_level1, data = difference_data_dou, mean)

# Create a box plot for the ratios grouped by dou_level
boxplot_ratio <- ggplot(difference_data_dou, aes(x = Dataset, y = ratio, fill = dou_level1)) +
  geom_boxplot(width = 1) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 0.5, color = "green") +
  geom_text(data = mean_ratio_values, aes(label = round(ratio, digits = 2)), vjust = -0.5, size = 3, color = "red") +
  labs(title = "Ratio of Difference to Survey Population by EO Population Data Products and dou_level",
       x = "Dataset", y = "Ratio of Difference to Survey Population", fill = "dou_level") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        plot.title = element_text(size = 10))

# Print the box plot
print(boxplot_ratio)

```

```{r}
## Create a box plot for the ratios grouped by dou_level
boxplot_ratio <- ggplot(difference_data_dou, aes(x = Dataset, y = ratio, fill = dou_level1)) +
  geom_boxplot(width = 0.6) +  # Adjust the width here
  stat_summary(fun = mean, geom = "point", shape = 23, size = 0.5, color = "green") +
  stat_summary(fun.data = mean_cl_normal, geom = "text", 
               aes(label = round(..y.., digits = 2), group = dou_level1), 
               position = position_dodge(width = 0.75),  # Use position_dodge with appropriate width
               vjust = -0.5, size = 2, color = "red") +  # Add mean values
  labs(title = "Ratio of Difference to Survey Population by EO Population Data Products and dou_level",
       x = "Dataset", y = "Ratio of Difference to Survey Population", fill = "dou_level") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        plot.title = element_text(size = 10))

# Print the box plot
print(boxplot_ratio)


```
#save error plot ratio for different dou level

```{r}
# Save the plot as an image file
ggsave("D:/EAGLE/Master_Thesis_Hannes/1/R/Lallu_thesis/Plots/boxplot_ratio_error.png", plot = boxplot_ratio, width = 8, height = 6, dpi = 300)
```


#__________________________________________
#ANALYSIS TO FIND STORY
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
#_______________________________________________
#line of best fit
```{r}
library(gridExtra)

# Scatter plot with site_status for gpw
scatter_gpw <- ggplot(camps, aes(x= gpw, y= N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_INDVI), x = as.numeric(gpw)), size = 0.6, alpha = 0.8, show.legend = TRUE) +
  geom_smooth(method = "lm", se = FALSE, color = "red") + # Add line of best fit
  labs(title = "Comparison between estimated and survey iom populations",
       x = "Estimated population (GPW)",
       y = "Survey_population") +
  theme_minimal() +
  theme(plot.title = (element_text(size = 9, colour = "Red")),
        axis.text.x = element_text(size = 5),
        axis.text.y = element_text(size = 5),
        axis.title.x = element_text(size = 5),
        axis.title.y = element_text(size = 5))

# Scatter plot with site_status for wp_con
scatter_wp_con <- ggplot(camps, aes(x = wp_c, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_INDVI), x = as.numeric(wp_c)), size = 0.6, alpha = 0.8, show.legend = TRUE) +
  geom_smooth(method = "lm", se = FALSE, color = "red") + # Add line of best fit
  labs(title = NULL,  # No title
       x = "Estimated population (WP_CON)",
       y = "Survey_population") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 5),
        axis.text.y = element_text(size = 5),
        axis.title.x = element_text(size = 5),
        axis.title.y = element_text(size = 5))

# Scatter plot with site_status for wp_uncon
scatter_wp_uncon <- ggplot(camps, aes(x= wp_uc, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_INDVI), x = as.numeric(wp_uc)), size = 0.6, alpha = 0.8, show.legend = TRUE) +
  geom_smooth(method = "lm", se = FALSE, color = "red") + # Add line of best fit
  labs(title = NULL,  # No title
       x = "Estimated population (WP_UNCON)",
       y = "Survey_population") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 5),
        axis.text.y = element_text(size = 5),
        axis.title.x = element_text(size = 5),
        axis.title.y = element_text(size = 5))

# Scatter plot with site_status for ghsl
scatter_ghsl <- ggplot(camps, aes(x = ghsl, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_INDVI), x = as.numeric(ghsl)), size = 0.6, alpha = 0.8, show.legend = TRUE) +
  geom_smooth(method = "lm", se = FALSE, color = "red") + # Add line of best fit
  labs(title = NULL,  # No title
       x = "Estimated population (GHSL)",
       y = "Survey_population") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 5),
        axis.text.y = element_text(size = 5),
        axis.title.x = element_text(size = 5),
        axis.title.y = element_text(size = 5))


# Scatter plot with site_status for gpw_UN
scatter_gpw_UN<- ggplot(camps, aes(x = gpw_UN, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(y= as.numeric(N_INDVI), x = as.numeric(gpw_UN)), size = 0.6, alpha = 0.8, show.legend = TRUE) +
  geom_smooth(method = "lm", se = FALSE, color = "red") + # Add line of best fit
  labs(title = NULL,  # No title
       x = "Estimated population (GPW_UN)",
       y = "Survey_population") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 5),
        axis.text.y = element_text(size = 5),
        axis.title.x = element_text(size = 5),
        axis.title.y = element_text(size = 5))

# Combine all scatter plots into one
combined_plot_fit_line_eo <- grid.arrange(scatter_gpw,scatter_gpw_UN, scatter_wp_con, scatter_wp_uncon, scatter_ghsl, nrow = 3, ncol = 2)

# Print the combined plot
print(combined_plot_fit_line_eo)

```


#save the line of fit plot

```{r}

# Save the plot to a file
ggsave("Plots/combined_plot_fit_line_eo.png", plot =combined_plot_fit_line_eo, width = 8, height = 6, dpi = 400)
```

# fitted lines for different Sit_stt 

```{r}
library(gridExtra)

# Scatter plot with site_status for gpw
scatter_gpw <- ggplot(camps, aes(x = gpw, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_INDVI), x = as.numeric(gpw)), size = 0.6, alpha = 0.8, show.legend = TRUE) +
  geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +  # Add trend lines by site status
  labs(title = "Comparison between estimated and survey iom populations",
       x = "Estimated population (GPW)",
       y = "Survey_population") +
  theme_minimal() +
  theme(plot.title = (element_text(size = 9, colour = "Red")),
        axis.text.x = element_text(size = 5),
        axis.text.y = element_text(size = 5),
        axis.title.x = element_text(size = 5),
        axis.title.y = element_text(size = 5))

# Scatter plot with site_status for wp_con
scatter_wp_con <- ggplot(camps, aes(x = wp_c, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_INDVI), x = as.numeric(wp_c)), size = 0.6, alpha = 0.8, show.legend = TRUE) +
  geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +  # Add trend lines by site status
  labs(title = NULL,
       x = "Estimated population (WP_CON)",
       y = "Survey_population") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 5),
        axis.text.y = element_text(size = 5),
        axis.title.x = element_text(size = 5),
        axis.title.y = element_text(size = 5))

# Scatter plot with site_status for wp_uncon
scatter_wp_uncon <- ggplot(camps, aes(x = wp_uc, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_INDVI), x = as.numeric(wp_uc)), size = 0.6, alpha = 0.8, show.legend = TRUE) +
  geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +  # Add trend lines by site status
  labs(title = NULL,
       x = "Estimated population (WP_UNCON)",
       y = "Survey_population") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 5),
        axis.text.y = element_text(size = 5),
        axis.title.x = element_text(size = 5),
        axis.title.y = element_text(size = 5))

# Scatter plot with site_status for ghsl
scatter_ghsl <- ggplot(camps, aes(x = ghsl, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_INDVI), x = as.numeric(ghsl)), size = 0.6, alpha = 0.8, show.legend = TRUE) +
  geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +  # Add trend lines by site status
  labs(title = NULL,
       x = "Estimated population (GHSL)",
       y = "Survey_population") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 5),
        axis.text.y = element_text(size = 5),
        axis.title.x = element_text(size = 5),
        axis.title.y = element_text(size = 5))

# Scatter plot with site_status for gpw_UN
scatter_gpw_UN <- ggplot(camps, aes(x = gpw_UN, y = N_INDVI, color = Sit_Stt)) +
  geom_jitter(aes(y = as.numeric(N_INDVI), x = as.numeric(gpw_UN)), size = 0.6, alpha = 0.8, show.legend = TRUE) +
  geom_smooth(method = "lm", aes(group = Sit_Stt), se = FALSE) +  # Add trend lines by site status
  labs(title = NULL,
       x = "Estimated population (GPW_UN)",
       y = "Survey_population") +
  theme_minimal() +
  theme(axis.text.x = element_text(size = 5),
        axis.text.y = element_text(size = 5),
        axis.title.x = element_text(size = 5),
        axis.title.y = element_text(size = 5))

# Combine all scatter plots into one
combined_plot_2_line <- grid.arrange(scatter_gpw,scatter_gpw_UN, scatter_wp_con, scatter_wp_uncon, scatter_ghsl, 
                              nrow = 3, ncol = 2)

# Print the combined plot
print(combined_plot_2_line)

```

#save the line of fit plot

```{r}

# Save the plot to a file
ggsave("Plots/combined_plot_2_line.png", plot =combined_plot_2_line, width = 8, height = 6, dpi = 400)
```


#combine camp and camp_final
```{r}
# Perform spatial intersection
merged_data <- st_intersection(camps, camp_final)

# Check the structure of the merged dataset
str(merged_data)

```

#plot with camps final and based on urban _peri urban

```{r}
str(camp_final)

# Convert non-numeric columns to numeric
camp_final$ms_b_c <- as.numeric(camp_final$ms_b_c)
camp_final$g_b_c <- as.numeric(camp_final$g_b_c)
camp_final$vida_b_c <- as.numeric(camp_final$vida_b_c)
camp_final$osm_b_c <- as.numeric(camp_final$osm_b_c)
library(gridExtra)
# Scatter plot with site_status
ms_b_surv<-ggplot(camp_final, aes(y = ms_b_c, x = N_INDVI, color = dou_level1)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(ms_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+geom_smooth(method = "lm", aes(group = dou_level1), se = FALSE) +
  
  labs(title = "Comparison between MS building count and survey iom populations",
       y = "Microsoft building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))+
   theme_minimal()+theme(plot.title = (element_text(size = 9,colour = "Red")),axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))# Adjust axis scale to start from zero
 



# Scatter plot with site_status
g_b_surv<-ggplot(camp_final, aes(y = g_b_c, x = N_INDVI, color = dou_level1)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(g_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+geom_smooth(method = "lm", aes(group = dou_level1), se = FALSE) +
  
  labs(title = NULL,
       y = "Google building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))+
   theme_minimal()+theme(axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))# Adjust axis scale to start from zero
 
  
 # Scatter plot with site_status
vida_b_surv<-ggplot(camp_final, aes(y = vida_b_c, x = N_INDVI, color = dou_level1)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(vida_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+geom_smooth(method = "lm", aes(group = dou_level1), se = FALSE) +
  
  labs(title = NULL,
       y = "Vida building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))+ theme_minimal()+theme(axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))  # Adjust axis scale to start from zero
  
  
  
  # Scatter plot with site_status
osm_b_surv<-ggplot(camp_final, aes(y = osm_b_c, x = N_INDVI, color = dou_level1)) +
  #geom_point(alpha=0.2) +
  geom_jitter(aes(x =as.numeric(N_INDVI) , y = as.numeric(osm_b_c)),shape=7,size = 0.5, alpha = 2,show.legend = TRUE)+geom_smooth(method = "lm", aes(group = dou_level1), se = FALSE) +
  
  labs(title = NULL,
       y = "OSM building count",
       x = "Iom surveyed population") +
  theme_minimal()+scale_x_continuous(expand = c(0,0))+
   theme_minimal()+theme(axis.text.x = element_text(size=5),
        axis.text.y = element_text(size = 5),axis.title.x = element_text(size = 5),
        axis.title.y=element_text(size=5))# Adjust 

# Combine all scatter plots into one
combined_plot_ru <- grid.arrange(ms_b_surv,g_b_surv, vida_b_surv, osm_b_surv, nrow = 2, ncol = 2)

# Print the combined plot
print(combined_plot_ru)

```
```{r}

# Save the plot to a file
ggsave("Plots/combined_plot_ru.png", plot =combined_plot_ru, width = 8, height = 6, dpi = 400)
```

#lollipop

```{r}

# Create separate lollipop plots for each dou_level1 group
lollipop_plots <- camp_median %>%
  group_split(dou_level1) %>%
  map(~ ggplot(., aes(x = Name)) +
        geom_segment(aes(xend = Name, y = 0, yend = median_g_b_c, color = "Google", size = median_g_b_c), size = 2) +
        geom_segment(aes(xend = Name, y = 0, yend = median_ms_b_c, color = "Microsoft", size = median_ms_b_c), size = 2) +
        geom_segment(aes(xend = Name, y = 0, yend = median_osm_b_c, color = "OSM", size = median_osm_b_c), size = 2) +
        geom_segment(aes(xend = Name, y = 0, yend = median_vida_b_c, color = "Vida", size = median_vida_b_c), size = 2) +
        scale_color_manual(values = c("Google" = "blue", "Microsoft" = "green", "OSM" = "red", "Vida" = "orange")) +
        labs(title = paste("Lollipop Plot: Median Building Count by Camp (", first(.$dou_level1), ")", sep = ""),
             x = "Camp Name",
             y = "Median Building Count",
             color = "Building Source",
             size = "Median Building Count") +
        theme_minimal() +
        theme(legend.position = "top",
              axis.text.y = element_text(size = 5)) + # Adjust size of camp names
        coord_flip())

# Print the lollipop plots
print(lollipop_plots[[1]]) # Urban
print(lollipop_plots[[2]]) # Rural
print(lollipop_plots[[3]]) # Urban Cluster

```

```{r}

# Save the plot to a file
ggsave("Plots/lollipop_plot.png", plot =lollipop_plot, width = 8, height = 6, dpi = 400)
```


```{r}
library(purrr)
# Create separate lollipop plots for each dou_level1 group
lollipop_plots <- camp_median %>%
  group_split(dou_level1) %>%
  map(~ ggplot(., aes(x = Name)) +
        geom_segment(aes(xend = Name, y = median_g_b_c, yend = 0, color = "Google"), size = 2) +
        geom_segment(aes(xend = Name, y = median_ms_b_c, yend = 0, color = "Microsoft"), size = 2) +
        geom_segment(aes(xend = Name, y = median_osm_b_c, yend = 0, color = "OSM"), size = 2) +
        geom_segment(aes(xend = Name, y = median_vida_b_c, yend = 0, color = "Vida"), size = 2) +
        geom_point(aes(y = median_g_b_c, color = dou_level1, size = median_g_b_c)) +
        #scale_color_manual(values = c("urban" = "blue", "rural" = "green", "urban cluster" = "red")) +
        scale_size_continuous(range = c(5, 15)) +
        labs(title = paste("Lollipop Plot: Median Building Count by Camp (", first(.$dou_level1), ")", sep = ""),
             x = "Camp Name",
             y = "Median Building Count",
             color = "Dou Level 1",
             size = " Building Count") +
        theme_minimal() +
        theme(legend.position = "top") +
        coord_flip())

# Print the lollipop plots
print(lollipop_plots[[1]]) # Urban
print(lollipop_plots[[2]]) # Rural
print(lollipop_plots[[3]]) # Urban Cluster



```
#big caps 
```{r}
library(dplyr)

# Filter the camp_final dataset for the specified camp names
filtered_camps <- camp_final %>%
  filter(Name %in% c("BO_S010", "BO_S097"))

# View the filtered dataset
print(filtered_camps)
```


```{r}
library(dplyr)
library(ggplot2)

library(dplyr)
library(ggplot2)

# Filter the camp_final dataset for the specified camp names
filtered_camps <- camp_final %>%
  filter(Name %in% c("BO_S010", "BO_S097"))

# Remove the geometry column
filtered_camps <- filtered_camps[, !names(filtered_camps) %in% c("geometry")]

# Summary statistics
summary_stats <- filtered_camps %>%
  summarise_all(list(mean = mean, median = median, sd = sd))

print(summary_stats)

# Visualize relationships
ggplot(filtered_camps, aes(x = N_HH, y = gpw, color = Name)) +
  geom_point() +
  labs(title = "Relationship between N_HH and GPW",
       x = "N_HH",
       y = "GPW") +
  theme_minimal()


```

```{r}
library(ggplot2)



# Plotting
ggplot(camp_final, aes(x = Shlt_ty, fill = factor(dou_level1))) +
  geom_bar(position = "dodge") +
  facet_wrap(~ Name, scales = "free") +  # Separate plots for each camp
  labs(title = "Building Counts by Shelter Type and Camp",
       x = "Shelter Type",
       y = "Building Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for better readability


```

